webpackJsonp([5],{300:function(e,t,r){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var o=r(20),s=r(433),c=r(1),d=r.n(c),l=r(434),h=r(416),u=r(410),f=r.n(u),p=r(415),_=r(500),g=(r.n(_),r(100)),m=r(436),y=function(e){function t(){return i(this,t),n(this,e.apply(this,arguments))}return a(t,e),t.prototype.formatCategoryTreeForJSTree=function(e){var t=this,r={text:e.data,id:e.metadata.id,state:{selected:e.selected}};return e.state&&(r.state.opened="open"===e.state,r.children=!0),e.children&&(r.children=[],e.children.forEach(function(e){r.children.push(t.formatCategoryTreeForJSTree(e))})),r},t.prototype.showProducts=function(){var e=h.a.replaceParams(location.href,{section:"product"});d()("[data-content-results-toggle]").parent(".navBar-item").removeClass("is-active"),d()("[data-product-results-toggle]").parent(".navBar-item").addClass("is-active"),this.$productListingContainer.removeClass("u-hiddenVisually"),this.$facetedSearchContainer.removeClass("u-hiddenVisually"),this.$contentResultsContainer.addClass("u-hiddenVisually"),h.a.goToUrl(e)},t.prototype.showContent=function(){var e=h.a.replaceParams(location.href,{section:"content"});d()("[data-product-results-toggle]").parent(".navBar-item").removeClass("is-active"),d()("[data-content-results-toggle]").parent(".navBar-item").addClass("is-active"),this.$contentResultsContainer.removeClass("u-hiddenVisually"),this.$productListingContainer.addClass("u-hiddenVisually"),this.$facetedSearchContainer.addClass("u-hiddenVisually"),h.a.goToUrl(e)},t.prototype.loaded=function(){var e=this,t=d()("[data-advanced-search-form]"),i=t.find("[data-search-category-tree]"),n=f.a.parse(location.href,!0),a=[];this.$productListingContainer=d()("#product-listing-container"),this.$facetedSearchContainer=d()("#faceted-search-container"),this.$contentResultsContainer=d()("#search-results-content"),d()("#facetedSearch").length>0?this.initFacetedSearch():(this.onSortBySubmit=this.onSortBySubmit.bind(this),o.b.on("sortBy-submitted",this.onSortBySubmit)),r.i(m.a)(),r.i(p.a)(),d()("[data-product-results-toggle]").click(function(t){t.preventDefault(),e.showProducts()}),d()("[data-content-results-toggle]").click(function(t){t.preventDefault(),e.showContent()}),0===this.$productListingContainer.find(".prod-item").length||"content"===n.query.section?this.showContent():this.showProducts();var s=this.initValidation(t).bindValidation(t.find("#search_query_adv"));this.context.categoryTree.forEach(function(t){a.push(e.formatCategoryTreeForJSTree(t))}),this.categoryTreeData=a,this.createCategoryTree(i),t.submit(function(e){var r=i.jstree().get_selected();if(!s.check())return e.preventDefault();t.find('input[name="category[]"]').remove();for(var n=r,a=Array.isArray(n),o=0,n=a?n:n[Symbol.iterator]();;){var c;if(a){if(o>=n.length)break;c=n[o++]}else{if(o=n.next(),o.done)break;c=o.value}var l=c,h=d()("<input>",{type:"hidden",name:"category[]",value:l});t.append(h)}})},t.prototype.loadTreeNodes=function(e,t){var r=this;d.a.ajax({url:"/remote/v1/category-tree",data:{selectedCategoryId:e.id,prefix:"category"},success:function(e){var i=[];e.forEach(function(e){i.push(r.formatCategoryTreeForJSTree(e))}),t(i)}})},t.prototype.createCategoryTree=function(e){var t=this,r={core:{data:function(e,r){"#"===e.id?r(t.categoryTreeData):t.loadTreeNodes(e,r)},themes:{icons:!0}},checkbox:{three_state:!1},plugins:["checkbox"]};e.jstree(r)},t.prototype.initFacetedSearch=function(){var e=d()("#product-listing-container"),t=d()("#faceted-search-container"),i=d()("#search-results-heading"),n=d()("#search-results-product-count"),a=this.context.searchProductsPerPage,o={template:{productListing:"search/product-listing",sidebar:"search/sidebar",heading:"search/heading",productCount:"search/product-count"},config:{product_results:{limit:a}},showMore:"search/show-more"};this.facetedSearch=new l.a(o,function(a){e.html(a.productListing),t.html(a.sidebar),i.html(a.heading),n.html(a.productCount),r.i(m.a)(),d()("html, body").animate({scrollTop:0},100)})},t.prototype.initValidation=function(e){return this.$form=e,this.validator=r.i(g.a)({submit:e}),this},t.prototype.bindValidation=function(e){return this.validator&&this.validator.add({selector:e,validate:"presence",errorMessage:e.data("error-message")}),this},t.prototype.check=function(){return!!this.validator&&(this.validator.performCheck(),this.validator.areAll("valid"))},t}(s.a);t.default=y},406:function(e,t,r){"use strict";e.exports=TypeError},407:function(e,t){function r(e,t){if("function"!=typeof e)throw new TypeError(i);return t=n(void 0===t?e.length-1:+t||0,0),function(){for(var r=arguments,i=-1,a=n(r.length-t,0),o=Array(a);++i<a;)o[i]=r[t+i];switch(t){case 0:return e.call(this,o);case 1:return e.call(this,r[0],o);case 2:return e.call(this,r[0],r[1],o)}var s=Array(t+1);for(i=-1;++i<t;)s[i]=r[i];return s[t]=o,e.apply(this,s)}}var i="Expected a function",n=Math.max;e.exports=r},408:function(e,t,r){"use strict";var i=r(447);e.exports=Function.prototype.bind||i},409:function(e,t,r){(function(t){function i(e,t){if(e===1/0||e===-1/0||e!==e||e&&e>-1e3&&e<1e3||ie.call(/e/,t))return t;var r=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if("number"==typeof e){var i=e<0?-se(-e):se(e);if(i!==e){var n=String(i),a=Z.call(t,n.length+1);return ee.call(n,r,"$&_")+"."+ee.call(ee.call(a,/([0-9]{3})/g,"$&_"),/_$/,"")}}return ee.call(t,r,"$&_")}function n(e,t,r){var i=r.quoteStyle||t,n=ye[i];return n+e+n}function a(e){return ee.call(String(e),/"/g,"&quot;")}function o(e){return!ue||!("object"==typeof e&&(ue in e||void 0!==e[ue]))}function s(e){return"[object Array]"===m(e)&&o(e)}function c(e){return"[object Date]"===m(e)&&o(e)}function d(e){return"[object RegExp]"===m(e)&&o(e)}function l(e){return"[object Error]"===m(e)&&o(e)}function h(e){return"[object String]"===m(e)&&o(e)}function u(e){return"[object Number]"===m(e)&&o(e)}function f(e){return"[object Boolean]"===m(e)&&o(e)}function p(e){if(he)return e&&"object"==typeof e&&e instanceof Symbol;if("symbol"==typeof e)return!0;if(!e||"object"!=typeof e||!le)return!1;try{return le.call(e),!0}catch(e){}return!1}function _(e){if(!e||"object"!=typeof e||!ce)return!1;try{return ce.call(e),!0}catch(e){}return!1}function g(e,t){return be.call(e,t)}function m(e){return Y.call(e)}function y(e){if(e.name)return e.name;var t=G.call(X.call(e),/^function\s*([\w$]+)/);return t?t[1]:null}function v(e,t){if(e.indexOf)return e.indexOf(t);for(var r=0,i=e.length;r<i;r++)if(e[r]===t)return r;return-1}function b(e){if(!D||!e||"object"!=typeof e)return!1;try{D.call(e);try{K.call(e)}catch(e){return!0}return e instanceof Map}catch(e){}return!1}function j(e){if(!W||!e||"object"!=typeof e)return!1;try{W.call(e,W);try{z.call(e,z)}catch(e){return!0}return e instanceof WeakMap}catch(e){}return!1}function k(e){if(!J||!e||"object"!=typeof e)return!1;try{return J.call(e),!0}catch(e){}return!1}function w(e){if(!K||!e||"object"!=typeof e)return!1;try{K.call(e);try{D.call(e)}catch(e){return!0}return e instanceof Set}catch(e){}return!1}function x(e){if(!z||!e||"object"!=typeof e)return!1;try{z.call(e,z);try{W.call(e,W)}catch(e){return!0}return e instanceof WeakSet}catch(e){}return!1}function S(e){return!(!e||"object"!=typeof e)&&("undefined"!=typeof HTMLElement&&e instanceof HTMLElement||"string"==typeof e.nodeName&&"function"==typeof e.getAttribute)}function C(e,t){if(e.length>t.maxStringLength){var r=e.length-t.maxStringLength,i="... "+r+" more character"+(r>1?"s":"");return C(Z.call(e,0,t.maxStringLength),t)+i}var a=ve[t.quoteStyle||"single"];return a.lastIndex=0,n(ee.call(ee.call(e,a,"\\$1"),/[\x00-\x1f]/g,O),"single",t)}function O(e){var t=e.charCodeAt(0),r={8:"b",9:"t",10:"n",12:"f",13:"r"}[t];return r?"\\"+r:"\\x"+(t<16?"0":"")+te.call(t.toString(16))}function A(e){return"Object("+e+")"}function T(e){return e+" { ? }"}function E(e,t,r,i){return e+" ("+t+") {"+(i?F(r,i):ae.call(r,", "))+"}"}function P(e){for(var t=0;t<e.length;t++)if(v(e[t],"\n")>=0)return!1;return!0}function N(e,t){var r;if("\t"===e.indent)r="\t";else{if(!("number"==typeof e.indent&&e.indent>0))return null;r=ae.call(Array(e.indent+1)," ")}return{base:r,prev:ae.call(Array(t+1),r)}}function F(e,t){if(0===e.length)return"";var r="\n"+t.prev+t.base;return r+ae.call(e,","+r)+"\n"+t.prev}function I(e,t){var r=s(e),i=[];if(r){i.length=e.length;for(var n=0;n<e.length;n++)i[n]=g(e,n)?t(e[n],e):""}var a,o="function"==typeof de?de(e):[];if(he){a={};for(var c=0;c<o.length;c++)a["$"+o[c]]=o[c]}for(var d in e)g(e,d)&&(r&&String(Number(d))===d&&d<e.length||he&&a["$"+d]instanceof Symbol||(ie.call(/[^\w$]/,d)?i.push(t(d,e)+": "+t(e[d],e)):i.push(d+": "+t(e[d],e))));if("function"==typeof de)for(var l=0;l<o.length;l++)fe.call(e,o[l])&&i.push("["+t(o[l])+"]: "+t(e[o[l]],e));return i}var L="function"==typeof Map&&Map.prototype,M=Object.getOwnPropertyDescriptor&&L?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,D=L&&M&&"function"==typeof M.get?M.get:null,R=L&&Map.prototype.forEach,q="function"==typeof Set&&Set.prototype,$=Object.getOwnPropertyDescriptor&&q?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,K=q&&$&&"function"==typeof $.get?$.get:null,U=q&&Set.prototype.forEach,B="function"==typeof WeakMap&&WeakMap.prototype,W=B?WeakMap.prototype.has:null,H="function"==typeof WeakSet&&WeakSet.prototype,z=H?WeakSet.prototype.has:null,V="function"==typeof WeakRef&&WeakRef.prototype,J=V?WeakRef.prototype.deref:null,Q=Boolean.prototype.valueOf,Y=Object.prototype.toString,X=Function.prototype.toString,G=String.prototype.match,Z=String.prototype.slice,ee=String.prototype.replace,te=String.prototype.toUpperCase,re=String.prototype.toLowerCase,ie=RegExp.prototype.test,ne=Array.prototype.concat,ae=Array.prototype.join,oe=Array.prototype.slice,se=Math.floor,ce="function"==typeof BigInt?BigInt.prototype.valueOf:null,de=Object.getOwnPropertySymbols,le="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?Symbol.prototype.toString:null,he="function"==typeof Symbol&&"object"==typeof Symbol.iterator,ue="function"==typeof Symbol&&Symbol.toStringTag&&(typeof Symbol.toStringTag===he?"object":"symbol")?Symbol.toStringTag:null,fe=Object.prototype.propertyIsEnumerable,pe=("function"==typeof Reflect?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(e){return e.__proto__}:null),_e=r(480),ge=_e.custom,me=p(ge)?ge:null,ye={__proto__:null,double:'"',single:"'"},ve={__proto__:null,double:/(["\\])/g,single:/(['\\])/g};e.exports=function e(r,o,O,L){function M(t,r,i){if(r&&(L=oe.call(L),L.push(r)),i){var n={depth:q.depth};return g(q,"quoteStyle")&&(n.quoteStyle=q.quoteStyle),e(t,n,O+1,L)}return e(t,q,O+1,L)}var q=o||{};if(g(q,"quoteStyle")&&!g(ye,q.quoteStyle))throw new TypeError('option "quoteStyle" must be "single" or "double"');if(g(q,"maxStringLength")&&("number"==typeof q.maxStringLength?q.maxStringLength<0&&q.maxStringLength!==1/0:null!==q.maxStringLength))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var $=!g(q,"customInspect")||q.customInspect;if("boolean"!=typeof $&&"symbol"!==$)throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(g(q,"indent")&&null!==q.indent&&"\t"!==q.indent&&!(parseInt(q.indent,10)===q.indent&&q.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(g(q,"numericSeparator")&&"boolean"!=typeof q.numericSeparator)throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var B=q.numericSeparator;if(void 0===r)return"undefined";if(null===r)return"null";if("boolean"==typeof r)return r?"true":"false";if("string"==typeof r)return C(r,q);if("number"==typeof r){if(0===r)return 1/0/r>0?"0":"-0";var W=String(r);return B?i(r,W):W}if("bigint"==typeof r){var H=String(r)+"n";return B?i(r,H):H}var z=void 0===q.depth?5:q.depth;if(void 0===O&&(O=0),O>=z&&z>0&&"object"==typeof r)return s(r)?"[Array]":"[Object]";var V=N(q,O);if(void 0===L)L=[];else if(v(L,r)>=0)return"[Circular]";if("function"==typeof r&&!d(r)){var J=y(r),Y=I(r,M);return"[Function"+(J?": "+J:" (anonymous)")+"]"+(Y.length>0?" { "+ae.call(Y,", ")+" }":"")}if(p(r)){var X=he?ee.call(String(r),/^(Symbol\(.*\))_[^)]*$/,"$1"):le.call(r);return"object"!=typeof r||he?X:A(X)}if(S(r)){for(var G="<"+re.call(String(r.nodeName)),te=r.attributes||[],ie=0;ie<te.length;ie++)G+=" "+te[ie].name+"="+n(a(te[ie].value),"double",q);return G+=">",r.childNodes&&r.childNodes.length&&(G+="..."),G+="</"+re.call(String(r.nodeName))+">"}if(s(r)){if(0===r.length)return"[]";var se=I(r,M);return V&&!P(se)?"["+F(se,V)+"]":"[ "+ae.call(se,", ")+" ]"}if(l(r)){var de=I(r,M);return"cause"in Error.prototype||!("cause"in r)||fe.call(r,"cause")?0===de.length?"["+String(r)+"]":"{ ["+String(r)+"] "+ae.call(de,", ")+" }":"{ ["+String(r)+"] "+ae.call(ne.call("[cause]: "+M(r.cause),de),", ")+" }"}if("object"==typeof r&&$){if(me&&"function"==typeof r[me]&&_e)return _e(r,{depth:z-O});if("symbol"!==$&&"function"==typeof r.inspect)return r.inspect()}if(b(r)){var ge=[];return R&&R.call(r,function(e,t){ge.push(M(t,r,!0)+" => "+M(e,r))}),E("Map",D.call(r),ge,V)}if(w(r)){var ve=[];return U&&U.call(r,function(e){ve.push(M(e,r))}),E("Set",K.call(r),ve,V)}if(j(r))return T("WeakMap");if(x(r))return T("WeakSet");if(k(r))return T("WeakRef");if(u(r))return A(M(Number(r)));if(_(r))return A(M(ce.call(r)));if(f(r))return A(Q.call(r));if(h(r))return A(M(String(r)));if("undefined"!=typeof window&&r===window)return"{ [object Window] }";if("undefined"!=typeof globalThis&&r===globalThis||void 0!==t&&r===t)return"{ [object globalThis] }";if(!c(r)&&!d(r)){var be=I(r,M),je=pe?pe(r)===Object.prototype:r instanceof Object||r.constructor===Object,ke=r instanceof Object?"":"null prototype",we=!je&&ue&&Object(r)===r&&ue in r?Z.call(m(r),8,-1):ke?"Object":"",xe=je||"function"!=typeof r.constructor?"":r.constructor.name?r.constructor.name+" ":"",Se=xe+(we||ke?"["+ae.call(ne.call([],we||[],ke||[]),": ")+"] ":"");return 0===be.length?Se+"{}":V?Se+"{"+F(be,V)+"}":Se+"{ "+ae.call(be,", ")+" }"}return String(r)};var be=Object.prototype.hasOwnProperty||function(e){return e in this}}).call(t,r(47))},410:function(e,t,r){"use strict";function i(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}function n(e,t,r){if(e&&"object"==typeof e&&e instanceof i)return e;var n=new i;return n.parse(e,t,r),n}function a(e){return"string"==typeof e&&(e=n(e)),e instanceof i?e.format():i.prototype.format.call(e)}function o(e,t){return n(e,!1,!0).resolve(t)}function s(e,t){return e?n(e,!1,!0).resolveObject(t):t}var c=r(473),d=/^([a-z0-9.+-]+:)/i,l=/:[0-9]*$/,h=/^(\/\/?(?!\/)[^?\s]*)(\?[^\s]*)?$/,u=["<",">",'"',"`"," ","\r","\n","\t"],f=["{","}","|","\\","^","`"].concat(u),p=["'"].concat(f),_=["%","/","?",";","#"].concat(p),g=["/","?","#"],m=/^[+a-z0-9A-Z_-]{0,63}$/,y=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,v={javascript:!0,"javascript:":!0},b={javascript:!0,"javascript:":!0},j={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},k=r(474);i.prototype.parse=function(e,t,r){if("string"!=typeof e)throw new TypeError("Parameter 'url' must be a string, not "+typeof e);var i=e.indexOf("?"),n=-1!==i&&i<e.indexOf("#")?"?":"#",a=e.split(n),o=/\\/g;a[0]=a[0].replace(o,"/"),e=a.join(n);var s=e;if(s=s.trim(),!r&&1===e.split("#").length){var l=h.exec(s);if(l)return this.path=s,this.href=s,this.pathname=l[1],l[2]?(this.search=l[2],this.query=t?k.parse(this.search.substr(1)):this.search.substr(1)):t&&(this.search="",this.query={}),this}var u=d.exec(s);if(u){u=u[0];var f=u.toLowerCase();this.protocol=f,s=s.substr(u.length)}if(r||u||s.match(/^\/\/[^@/]+@[^@/]+/)){var w="//"===s.substr(0,2);!w||u&&b[u]||(s=s.substr(2),this.slashes=!0)}if(!b[u]&&(w||u&&!j[u])){for(var x=-1,S=0;S<g.length;S++){var C=s.indexOf(g[S]);-1!==C&&(-1===x||C<x)&&(x=C)}var O,A;A=-1===x?s.lastIndexOf("@"):s.lastIndexOf("@",x),-1!==A&&(O=s.slice(0,A),s=s.slice(A+1),this.auth=decodeURIComponent(O)),x=-1;for(var S=0;S<_.length;S++){var C=s.indexOf(_[S]);-1!==C&&(-1===x||C<x)&&(x=C)}-1===x&&(x=s.length),this.host=s.slice(0,x),s=s.slice(x),this.parseHost(),this.hostname=this.hostname||"";var T="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!T)for(var E=this.hostname.split(/\./),S=0,P=E.length;S<P;S++){var N=E[S];if(N&&!N.match(m)){for(var F="",I=0,L=N.length;I<L;I++)N.charCodeAt(I)>127?F+="x":F+=N[I];if(!F.match(m)){var M=E.slice(0,S),D=E.slice(S+1),R=N.match(y);R&&(M.push(R[1]),D.unshift(R[2])),D.length&&(s="/"+D.join(".")+s),this.hostname=M.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),T||(this.hostname=c.toASCII(this.hostname));var q=this.port?":"+this.port:"",$=this.hostname||"";this.host=$+q,this.href+=this.host,T&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==s[0]&&(s="/"+s))}if(!v[f])for(var S=0,P=p.length;S<P;S++){var K=p[S];if(-1!==s.indexOf(K)){var U=encodeURIComponent(K);U===K&&(U=escape(K)),s=s.split(K).join(U)}}var B=s.indexOf("#");-1!==B&&(this.hash=s.substr(B),s=s.slice(0,B));var W=s.indexOf("?");if(-1!==W?(this.search=s.substr(W),this.query=s.substr(W+1),t&&(this.query=k.parse(this.query)),s=s.slice(0,W)):t&&(this.search="",this.query={}),s&&(this.pathname=s),j[f]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var q=this.pathname||"",H=this.search||"";this.path=q+H}return this.href=this.format(),this},i.prototype.format=function(){var e=this.auth||"";e&&(e=encodeURIComponent(e),e=e.replace(/%3A/i,":"),e+="@");var t=this.protocol||"",r=this.pathname||"",i=this.hash||"",n=!1,a="";this.host?n=e+this.host:this.hostname&&(n=e+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(n+=":"+this.port)),this.query&&"object"==typeof this.query&&Object.keys(this.query).length&&(a=k.stringify(this.query,{arrayFormat:"repeat",addQueryPrefix:!1}));var o=this.search||a&&"?"+a||"";return t&&":"!==t.substr(-1)&&(t+=":"),this.slashes||(!t||j[t])&&!1!==n?(n="//"+(n||""),r&&"/"!==r.charAt(0)&&(r="/"+r)):n||(n=""),i&&"#"!==i.charAt(0)&&(i="#"+i),o&&"?"!==o.charAt(0)&&(o="?"+o),r=r.replace(/[?#]/g,function(e){return encodeURIComponent(e)}),o=o.replace("#","%23"),t+n+r+o+i},i.prototype.resolve=function(e){return this.resolveObject(n(e,!1,!0)).format()},i.prototype.resolveObject=function(e){if("string"==typeof e){var t=new i;t.parse(e,!1,!0),e=t}for(var r=new i,n=Object.keys(this),a=0;a<n.length;a++){var o=n[a];r[o]=this[o]}if(r.hash=e.hash,""===e.href)return r.href=r.format(),r;if(e.slashes&&!e.protocol){for(var s=Object.keys(e),c=0;c<s.length;c++){var d=s[c];"protocol"!==d&&(r[d]=e[d])}return j[r.protocol]&&r.hostname&&!r.pathname&&(r.pathname="/",r.path=r.pathname),r.href=r.format(),r}if(e.protocol&&e.protocol!==r.protocol){if(!j[e.protocol]){for(var l=Object.keys(e),h=0;h<l.length;h++){var u=l[h];r[u]=e[u]}return r.href=r.format(),r}if(r.protocol=e.protocol,e.host||b[e.protocol])r.pathname=e.pathname;else{for(var f=(e.pathname||"").split("/");f.length&&!(e.host=f.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),""!==f[0]&&f.unshift(""),f.length<2&&f.unshift(""),r.pathname=f.join("/")}if(r.search=e.search,r.query=e.query,r.host=e.host||"",r.auth=e.auth,r.hostname=e.hostname||e.host,r.port=e.port,r.pathname||r.search){var p=r.pathname||"",_=r.search||"";r.path=p+_}return r.slashes=r.slashes||e.slashes,r.href=r.format(),r}var g=r.pathname&&"/"===r.pathname.charAt(0),m=e.host||e.pathname&&"/"===e.pathname.charAt(0),y=m||g||r.host&&e.pathname,v=y,k=r.pathname&&r.pathname.split("/")||[],f=e.pathname&&e.pathname.split("/")||[],w=r.protocol&&!j[r.protocol];if(w&&(r.hostname="",r.port=null,r.host&&(""===k[0]?k[0]=r.host:k.unshift(r.host)),r.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(""===f[0]?f[0]=e.host:f.unshift(e.host)),e.host=null),y=y&&(""===f[0]||""===k[0])),m)r.host=e.host||""===e.host?e.host:r.host,r.hostname=e.hostname||""===e.hostname?e.hostname:r.hostname,r.search=e.search,r.query=e.query,k=f;else if(f.length)k||(k=[]),k.pop(),k=k.concat(f),r.search=e.search,r.query=e.query;else if(null!=e.search){if(w){r.host=k.shift(),r.hostname=r.host;var x=!!(r.host&&r.host.indexOf("@")>0)&&r.host.split("@");x&&(r.auth=x.shift(),r.hostname=x.shift(),r.host=r.hostname)}return r.search=e.search,r.query=e.query,null===r.pathname&&null===r.search||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.href=r.format(),r}if(!k.length)return r.pathname=null,r.search?r.path="/"+r.search:r.path=null,r.href=r.format(),r;for(var S=k.slice(-1)[0],C=(r.host||e.host||k.length>1)&&("."===S||".."===S)||""===S,O=0,A=k.length;A>=0;A--)S=k[A],"."===S?k.splice(A,1):".."===S?(k.splice(A,1),O++):O&&(k.splice(A,1),O--);if(!y&&!v)for(;O--;O)k.unshift("..");!y||""===k[0]||k[0]&&"/"===k[0].charAt(0)||k.unshift(""),C&&"/"!==k.join("/").substr(-1)&&k.push("");var T=""===k[0]||k[0]&&"/"===k[0].charAt(0);if(w){r.hostname=T?"":k.length?k.shift():"",r.host=r.hostname;var x=!!(r.host&&r.host.indexOf("@")>0)&&r.host.split("@");x&&(r.auth=x.shift(),r.hostname=x.shift(),r.host=r.hostname)}return y=y||r.host&&k.length,y&&!T&&k.unshift(""),k.length>0?r.pathname=k.join("/"):(r.pathname=null,r.path=null),null===r.pathname&&null===r.search||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.auth=e.auth||r.auth,r.slashes=r.slashes||e.slashes,r.href=r.format(),r},i.prototype.parseHost=function(){var e=this.host,t=l.exec(e);t&&(t=t[0],":"!==t&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)},t.parse=n,t.resolve=o,t.resolveObject=s,t.format=a,t.Url=i},411:function(e,t,r){"use strict";e.exports=Function.prototype.call},412:function(e,t,r){"use strict";var i=r(420),n=r(442),a=r(441),o=r(443),s=r(444),c=r(445),d=r(406),l=r(446),h=r(465),u=r(466),f=r(468),p=r(469),_=r(470),g=r(471),m=r(472),y=Function,v=function(e){try{return y('"use strict"; return ('+e+").constructor;")()}catch(e){}},b=r(423),j=r(440),k=function(){throw new d},w=b?function(){try{return arguments.callee,k}catch(e){try{return b(arguments,"callee").get}catch(e){return k}}}():k,x=r(450)(),S=r(448),C=r(421),O=r(422),A=r(417),T=r(411),E={},P="undefined"!=typeof Uint8Array&&S?S(Uint8Array):void 0,N={__proto__:null,"%AggregateError%":"undefined"==typeof AggregateError?void 0:AggregateError,"%Array%":Array,"%ArrayBuffer%":"undefined"==typeof ArrayBuffer?void 0:ArrayBuffer,"%ArrayIteratorPrototype%":x&&S?S([][Symbol.iterator]()):void 0,"%AsyncFromSyncIteratorPrototype%":void 0,"%AsyncFunction%":E,"%AsyncGenerator%":E,"%AsyncGeneratorFunction%":E,"%AsyncIteratorPrototype%":E,"%Atomics%":"undefined"==typeof Atomics?void 0:Atomics,"%BigInt%":"undefined"==typeof BigInt?void 0:BigInt,"%BigInt64Array%":"undefined"==typeof BigInt64Array?void 0:BigInt64Array,"%BigUint64Array%":"undefined"==typeof BigUint64Array?void 0:BigUint64Array,"%Boolean%":Boolean,"%DataView%":"undefined"==typeof DataView?void 0:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":n,"%eval%":eval,"%EvalError%":a,"%Float16Array%":"undefined"==typeof Float16Array?void 0:Float16Array,"%Float32Array%":"undefined"==typeof Float32Array?void 0:Float32Array,"%Float64Array%":"undefined"==typeof Float64Array?void 0:Float64Array,"%FinalizationRegistry%":"undefined"==typeof FinalizationRegistry?void 0:FinalizationRegistry,"%Function%":y,"%GeneratorFunction%":E,"%Int8Array%":"undefined"==typeof Int8Array?void 0:Int8Array,"%Int16Array%":"undefined"==typeof Int16Array?void 0:Int16Array,"%Int32Array%":"undefined"==typeof Int32Array?void 0:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":x&&S?S(S([][Symbol.iterator]())):void 0,"%JSON%":"object"==typeof JSON?JSON:void 0,"%Map%":"undefined"==typeof Map?void 0:Map,"%MapIteratorPrototype%":"undefined"!=typeof Map&&x&&S?S((new Map)[Symbol.iterator]()):void 0,"%Math%":Math,"%Number%":Number,"%Object%":i,"%Object.getOwnPropertyDescriptor%":b,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":"undefined"==typeof Promise?void 0:Promise,"%Proxy%":"undefined"==typeof Proxy?void 0:Proxy,"%RangeError%":o,"%ReferenceError%":s,"%Reflect%":"undefined"==typeof Reflect?void 0:Reflect,"%RegExp%":RegExp,"%Set%":"undefined"==typeof Set?void 0:Set,"%SetIteratorPrototype%":"undefined"!=typeof Set&&x&&S?S((new Set)[Symbol.iterator]()):void 0,"%SharedArrayBuffer%":"undefined"==typeof SharedArrayBuffer?void 0:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":x&&S?S(""[Symbol.iterator]()):void 0,"%Symbol%":x?Symbol:void 0,"%SyntaxError%":c,"%ThrowTypeError%":w,"%TypedArray%":P,"%TypeError%":d,"%Uint8Array%":"undefined"==typeof Uint8Array?void 0:Uint8Array,"%Uint8ClampedArray%":"undefined"==typeof Uint8ClampedArray?void 0:Uint8ClampedArray,"%Uint16Array%":"undefined"==typeof Uint16Array?void 0:Uint16Array,"%Uint32Array%":"undefined"==typeof Uint32Array?void 0:Uint32Array,"%URIError%":l,"%WeakMap%":"undefined"==typeof WeakMap?void 0:WeakMap,"%WeakRef%":"undefined"==typeof WeakRef?void 0:WeakRef,"%WeakSet%":"undefined"==typeof WeakSet?void 0:WeakSet,"%Function.prototype.call%":T,"%Function.prototype.apply%":A,"%Object.defineProperty%":j,"%Object.getPrototypeOf%":C,"%Math.abs%":h,"%Math.floor%":u,"%Math.max%":f,"%Math.min%":p,"%Math.pow%":_,"%Math.round%":g,"%Math.sign%":m,"%Reflect.getPrototypeOf%":O};if(S)try{null.error}catch(e){var F=S(S(e));N["%Error.prototype%"]=F}var I=function e(t){var r;if("%AsyncFunction%"===t)r=v("async function () {}");else if("%GeneratorFunction%"===t)r=v("function* () {}");else if("%AsyncGeneratorFunction%"===t)r=v("async function* () {}");else if("%AsyncGenerator%"===t){var i=e("%AsyncGeneratorFunction%");i&&(r=i.prototype)}else if("%AsyncIteratorPrototype%"===t){var n=e("%AsyncGenerator%");n&&S&&(r=S(n.prototype))}return N[t]=r,r},L={__proto__:null,"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},M=r(408),D=r(452),R=M.call(T,Array.prototype.concat),q=M.call(A,Array.prototype.splice),$=M.call(T,String.prototype.replace),K=M.call(T,String.prototype.slice),U=M.call(T,RegExp.prototype.exec),B=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,W=/\\(\\)?/g,H=function(e){var t=K(e,0,1),r=K(e,-1);if("%"===t&&"%"!==r)throw new c("invalid intrinsic syntax, expected closing `%`");if("%"===r&&"%"!==t)throw new c("invalid intrinsic syntax, expected opening `%`");var i=[];return $(e,B,function(e,t,r,n){i[i.length]=r?$(n,W,"$1"):t||e}),i},z=function(e,t){var r,i=e;if(D(L,i)&&(r=L[i],i="%"+r[0]+"%"),D(N,i)){var n=N[i];if(n===E&&(n=I(i)),void 0===n&&!t)throw new d("intrinsic "+e+" exists, but is not available. Please file an issue!");return{alias:r,name:i,value:n}}throw new c("intrinsic "+e+" does not exist!")};e.exports=function(e,t){if("string"!=typeof e||0===e.length)throw new d("intrinsic name must be a non-empty string");if(arguments.length>1&&"boolean"!=typeof t)throw new d('"allowMissing" argument must be a boolean');if(null===U(/^%?[^%]*%?$/,e))throw new c("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var r=H(e),i=r.length>0?r[0]:"",n=z("%"+i+"%",t),a=n.name,o=n.value,s=!1,l=n.alias;l&&(i=l[0],q(r,R([0,1],l)));for(var h=1,u=!0;h<r.length;h+=1){var f=r[h],p=K(f,0,1),_=K(f,-1);if(('"'===p||"'"===p||"`"===p||'"'===_||"'"===_||"`"===_)&&p!==_)throw new c("property names with quotes must have matching quotes");if("constructor"!==f&&u||(s=!0),i+="."+f,a="%"+i+"%",D(N,a))o=N[a];else if(null!=o){if(!(f in o)){if(!t)throw new d("base intrinsic for "+e+" exists, but the property is not available.");return}if(b&&h+1>=r.length){var g=b(o,f);u=!!g,o=u&&"get"in g&&!("originalValue"in g.get)?g.get:o[f]}else u=D(o,f),o=o[f];u&&!s&&(N[a]=o)}}return o}},413:function(e,t,r){"use strict";var i=String.prototype.replace,n=/%20/g,a={RFC1738:"RFC1738",RFC3986:"RFC3986"};e.exports={default:a.RFC3986,formatters:{RFC1738:function(e){return i.call(e,n,"+")},RFC3986:function(e){return String(e)}},RFC1738:a.RFC1738,RFC3986:a.RFC3986}},414:function(e,t,r){e.exports=r(432)},415:function(e,t,r){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e){return e&&0===e.indexOf("#")?e:"#"+e}function a(e){return{disabledBreakpoint:e.data(f+"-disabled-breakpoint"),disabledState:e.data(f+"-disabled-state"),enabledState:e.data(f+"-enabled-state"),openClassName:e.data(f+"-open-class-name")}}function o(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"[data-"+f+"]",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return l()(e,t.$context).map(function(e,r){var i=l()(r),o=f+"-instance",s=i.data(o);if(s instanceof g)return s;var d=n(i.data(f)||i.data(f+"-target")||i.attr("href")),h=c()(a(i),t),u=new g(i,l()(d),h);return i.data(o,u),u}).toArray()}r.d(t,"b",function(){return p}),t.a=o;var s=r(414),c=r.n(s),d=r(1),l=r.n(d),h=r(429),u=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}(),f="collapsible",p={open:"open.collapsible",close:"close.collapsible",toggle:"toggle.collapsible",click:"click.collapsible"},_={closed:"closed",open:"open"},g=function(){function e(t,n){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=a.disabledBreakpoint,s=a.disabledState,c=a.enabledState,d=a.openClassName,l=void 0===d?"is-open":d;i(this,e),this.$toggle=t,this.$target=n,this.targetId=n.attr("id"),this.openClassName=l,this.disabledState=s,this.enabledState=c,o&&(this.disabledMediaQueryList=r.i(h.a)(o)),this.disabledMediaQueryList?this.disabled=this.disabledMediaQueryList.matches:this.disabled=!1,this.onClicked=this.onClicked.bind(this),this.onDisabledMediaQueryListMatch=this.onDisabledMediaQueryListMatch.bind(this),this.$target.attr("aria-hidden",this.isCollapsed),this.$toggle.attr("aria-controls",n.attr("id")).attr("aria-expanded",this.isOpen),this.bindEvents()}return e.prototype.open=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.notify,r=void 0===t||t;this.$toggle.addClass(this.openClassName).attr("aria-expanded",!0),this.$target.addClass(this.openClassName).attr("aria-hidden",!1),r&&(this.$toggle.trigger(p.open,[this]),this.$toggle.trigger(p.toggle,[this]))},e.prototype.close=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.notify,r=void 0===t||t;this.$toggle.removeClass(this.openClassName).attr("aria-expanded",!1),this.$target.removeClass(this.openClassName).attr("aria-hidden",!0),r&&(this.$toggle.trigger(p.close,[this]),this.$toggle.trigger(p.toggle,[this]))},e.prototype.toggle=function(){this.isCollapsed?this.open():this.close()},e.prototype.toggleByState=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];switch(e){case _.open:return this.open.apply(this,r);case _.closed:return this.close.apply(this,r);default:return}},e.prototype.hasCollapsible=function(e){return l.a.contains(this.$target.get(0),e.$target.get(0))},e.prototype.bindEvents=function(){this.$toggle.on(p.click,this.onClicked),this.disabledMediaQueryList&&this.disabledMediaQueryList.addListener&&this.disabledMediaQueryList.addListener(this.onDisabledMediaQueryListMatch)},e.prototype.unbindEvents=function(){this.$toggle.off(p.click,this.onClicked),this.disabledMediaQueryList&&this.disabledMediaQueryList.removeListener&&this.disabledMediaQueryList.removeListener(this.onDisabledMediaQueryListMatch)},e.prototype.onClicked=function(e){this.disabled||(e.preventDefault(),this.toggle())},e.prototype.onDisabledMediaQueryListMatch=function(e){this.disabled=e.matches},u(e,[{key:"isCollapsed",get:function(){return!this.$target.hasClass(this.openClassName)||this.$target.is(":hidden")}},{key:"isOpen",get:function(){return!this.isCollapsed}},{key:"disabled",set:function(e){this._disabled=e,e?this.toggleByState(this.disabledState):this.toggleByState(this.enabledState)},get:function(){return this._disabled}}]),e}()},416:function(e,t,r){"use strict";var i=r(1),n=r.n(i),a=r(410),o=r.n(a),s={getUrl:function(){return""+window.location.pathname+window.location.search},goToUrl:function(e){window.history.pushState({},document.title,e),n()(window).trigger("statechange")},replaceParams:function(e,t){var r=o.a.parse(e,!0),i=void 0;r.search=null;for(i in t)t.hasOwnProperty(i)&&(r.query[i]=t[i]);return o.a.format(r)},buildQueryString:function(e){var t="",r=void 0;for(r in e)if(e.hasOwnProperty(r))if(Array.isArray(e[r])){var i=void 0;for(i in e[r])e[r].hasOwnProperty(i)&&(t+="&"+r+"="+e[r][i])}else t+="&"+r+"="+e[r];return t.substring(1)}};t.a=s},417:function(e,t,r){"use strict";e.exports=Function.prototype.apply},418:function(e,t,r){"use strict";var i=r(408),n=r(406),a=r(411),o=r(437);e.exports=function(e){if(e.length<1||"function"!=typeof e[0])throw new n("a function is required");return o(i,a,e)}},419:function(e,t,r){"use strict";var i=r(412),n=r(418),a=n([i("%String.prototype.indexOf%")]);e.exports=function(e,t){var r=i(e,!!t);return"function"==typeof r&&a(e,".prototype.")>-1?n([r]):r}},420:function(e,t,r){"use strict";e.exports=Object},421:function(e,t,r){"use strict";var i=r(420);e.exports=i.getPrototypeOf||null},422:function(e,t,r){"use strict";e.exports="undefined"!=typeof Reflect&&Reflect.getPrototypeOf||null},423:function(e,t,r){"use strict";var i=r(449);if(i)try{i([],"length")}catch(e){i=null}e.exports=i},425:function(e,t,r){function i(e,t){var r=e.data;return("string"==typeof t||n(t)?r.set.has(t):r.hash[t])?0:-1}var n=r(13);e.exports=i},426:function(e,t,r){(function(t){function i(e){return s&&o?new n(e):null}var n=r(457),a=r(73),o=a(t,"Set"),s=a(Object,"create");e.exports=i}).call(t,r(47))},427:function(e,t,r){"use strict";var i=r(413),n=Object.prototype.hasOwnProperty,a=Array.isArray,o=function(){for(var e=[],t=0;t<256;++t)e.push("%"+((t<16?"0":"")+t.toString(16)).toUpperCase());return e}(),s=function(e){for(;e.length>1;){var t=e.pop(),r=t.obj[t.prop];if(a(r)){for(var i=[],n=0;n<r.length;++n)void 0!==r[n]&&i.push(r[n]);t.obj[t.prop]=i}}},c=function(e,t){for(var r=t&&t.plainObjects?{__proto__:null}:{},i=0;i<e.length;++i)void 0!==e[i]&&(r[i]=e[i]);return r},d=function e(t,r,i){if(!r)return t;if("object"!=typeof r&&"function"!=typeof r){if(a(t))t.push(r);else{if(!t||"object"!=typeof t)return[t,r];(i&&(i.plainObjects||i.allowPrototypes)||!n.call(Object.prototype,r))&&(t[r]=!0)}return t}if(!t||"object"!=typeof t)return[t].concat(r);var o=t;return a(t)&&!a(r)&&(o=c(t,i)),a(t)&&a(r)?(r.forEach(function(r,a){if(n.call(t,a)){var o=t[a];o&&"object"==typeof o&&r&&"object"==typeof r?t[a]=e(o,r,i):t.push(r)}else t[a]=r}),t):Object.keys(r).reduce(function(t,a){var o=r[a];return n.call(t,a)?t[a]=e(t[a],o,i):t[a]=o,t},o)},l=function(e,t){return Object.keys(t).reduce(function(e,r){return e[r]=t[r],e},e)},h=function(e,t,r){var i=e.replace(/\+/g," ");if("iso-8859-1"===r)return i.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(i)}catch(e){return i}},u=function(e,t,r,n,a){if(0===e.length)return e;var s=e;if("symbol"==typeof e?s=Symbol.prototype.toString.call(e):"string"!=typeof e&&(s=String(e)),"iso-8859-1"===r)return escape(s).replace(/%u[0-9a-f]{4}/gi,function(e){return"%26%23"+parseInt(e.slice(2),16)+"%3B"});for(var c="",d=0;d<s.length;d+=1024){for(var l=s.length>=1024?s.slice(d,d+1024):s,h=[],u=0;u<l.length;++u){var f=l.charCodeAt(u);45===f||46===f||95===f||126===f||f>=48&&f<=57||f>=65&&f<=90||f>=97&&f<=122||a===i.RFC1738&&(40===f||41===f)?h[h.length]=l.charAt(u):f<128?h[h.length]=o[f]:f<2048?h[h.length]=o[192|f>>6]+o[128|63&f]:f<55296||f>=57344?h[h.length]=o[224|f>>12]+o[128|f>>6&63]+o[128|63&f]:(u+=1,f=65536+((1023&f)<<10|1023&l.charCodeAt(u)),h[h.length]=o[240|f>>18]+o[128|f>>12&63]+o[128|f>>6&63]+o[128|63&f])}c+=h.join("")}return c},f=function(e){for(var t=[{obj:{o:e},prop:"o"}],r=[],i=0;i<t.length;++i)for(var n=t[i],a=n.obj[n.prop],o=Object.keys(a),c=0;c<o.length;++c){var d=o[c],l=a[d];"object"==typeof l&&null!==l&&-1===r.indexOf(l)&&(t.push({obj:a,prop:d}),r.push(l))}return s(t),e},p=function(e){return"[object RegExp]"===Object.prototype.toString.call(e)},_=function(e){return!(!e||"object"!=typeof e)&&!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))},g=function(e,t){return[].concat(e,t)},m=function(e,t){if(a(e)){for(var r=[],i=0;i<e.length;i+=1)r.push(t(e[i]));return r}return t(e)};e.exports={arrayToObject:c,assign:l,combine:g,compact:f,decode:h,encode:u,isBuffer:_,isRegExp:p,maybeMap:m,merge:d}},428:function(e,t,r){"use strict";var i=r(412),n=r(419),a=r(409),o=r(406),s=i("%Map%",!0),c=n("Map.prototype.get",!0),d=n("Map.prototype.set",!0),l=n("Map.prototype.has",!0),h=n("Map.prototype.delete",!0),u=n("Map.prototype.size",!0);e.exports=!!s&&function(){var e,t={assert:function(e){if(!t.has(e))throw new o("Side channel does not contain "+a(e))},delete:function(t){if(e){var r=h(e,t);return 0===u(e)&&(e=void 0),r}return!1},get:function(t){if(e)return c(e,t)},has:function(t){return!!e&&l(e,t)},set:function(t,r){e||(e=new s),d(e,t,r)}};return t}},429:function(e,t,r){"use strict";function i(e){if(!e||!window.matchMedia)return null;var t=n[e],r="(min-width: "+t+"px)";return window.matchMedia(r)}t.a=i;var n={large:1261,medium:801,small:551}},430:function(e,t,r){function i(e,t,r){for(var i=-1,a=n(t),o=a.length;++i<o;){var s=a[i],c=e[s],d=r(c,t[s],s,e,t);(d===d?d===c:c!==c)&&(void 0!==c||s in e)||(e[s]=d)}return e}var n=r(36);e.exports=i},431:function(e,t,r){function i(e){return o(function(t,r){var i=-1,o=null==t?0:r.length,s=o>2?r[o-2]:void 0,c=o>2?r[2]:void 0,d=o>1?r[o-1]:void 0;for("function"==typeof s?(s=n(s,d,5),o-=2):(s="function"==typeof d?d:void 0,o-=s?1:0),c&&a(r[0],r[1],c)&&(s=o<3?void 0:s,o=1);++i<o;){var l=r[i];l&&e(t,l,s)}return t})}var n=r(101),a=r(74),o=r(407);e.exports=i},432:function(e,t,r){var i=r(430),n=r(251),a=r(431),o=a(function(e,t,r){return r?i(e,t,r):n(e,t)});e.exports=o},433:function(e,t,r){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var o=r(246),s=r(1),c=r.n(s),d=r(416),l=r(410),h=r.n(l),u=function(e){function t(){return i(this,t),n(this,e.apply(this,arguments))}return a(t,e),t.prototype.onSortBySubmit=function(e){var t=h.a.parse(location.href,!0),r=c()(e.currentTarget).serialize().split("=");t.query[r[0]]=r[1],delete t.query.page,e.preventDefault(),window.location=h.a.format({pathname:t.pathname,search:d.a.buildQueryString(t.query)})},t}(o.a);t.a=u},434:function(e,t,r){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var n=r(252),a=r.n(n),o=r(453),s=r.n(o),c=r(454),d=r.n(c),l=r(414),h=r.n(l),u=r(20),f=r(1),p=r.n(f),_=r(410),g=r.n(_),m=r(416),y=r(72),v=r(415),b=r(247),j=r(100),k=function(){function e(t,n,a){var o=this;i(this,e);var s={accordionToggleSelector:"#facetedSearch .accordion-navigation, #facetedSearch .facetedSearch-toggle",blockerSelector:"#facetedSearch .blocker",clearFacetSelector:"#facetedSearch .facetedSearch-clearLink",componentSelector:"#facetedSearch-navList",facetNavListSelector:"#facetedSearch .navList",priceRangeErrorSelector:"#facet-range-form .form-inlineMessage",priceRangeFieldsetSelector:"#facet-range-form .form-fieldset",priceRangeFormSelector:"#facet-range-form",priceRangeMaxPriceSelector:"#facet-range-form [name=max_price]",priceRangeMinPriceSelector:"#facet-range-form [name=min_price]",showMoreToggleSelector:"#facetedSearch .accordion-content .toggleLink",facetedSearchFilterItems:"#facetedSearch-filterItems .form-input",modal:r.i(y.b)("#modal")[0],modalOpen:!1};this.requestOptions=t,this.callback=n,this.options=h()({},s,a),this.collapsedFacets=[],this.collapsedFacetItems=[],r.i(v.a)(),this.initPriceValidator(),p()(this.options.facetNavListSelector).each(function(e,t){o.collapseFacetItems(p()(t))}),p()(this.options.accordionToggleSelector).each(function(e,t){var r=p()(t),i=r.data("collapsible-instance");i.isCollapsed&&o.collapsedFacets.push(i.targetId)}),setTimeout(function(){p()(o.options.componentSelector).is(":hidden")&&o.collapseAllFacets()}),this.onStateChange=this.onStateChange.bind(this),this.onToggleClick=this.onToggleClick.bind(this),this.onAccordionToggle=this.onAccordionToggle.bind(this),this.onClearFacet=this.onClearFacet.bind(this),this.onFacetClick=this.onFacetClick.bind(this),this.onRangeSubmit=this.onRangeSubmit.bind(this),this.onSortBySubmit=this.onSortBySubmit.bind(this),this.filterFacetItems=this.filterFacetItems.bind(this),this.bindEvents()}return e.prototype.refreshView=function(e){e&&this.callback(e),r.i(v.a)(),this.initPriceValidator(),this.restoreCollapsedFacets(),this.restoreCollapsedFacetItems(),this.bindEvents()},e.prototype.updateView=function(){var e=this;p()(this.options.blockerSelector).show(),u.a.getPage(m.a.getUrl(),this.requestOptions,function(t,r){if(p()(e.options.blockerSelector).hide(),t)throw new Error(t);e.refreshView(r)})},e.prototype.expandFacetItems=function(e){var t=e.attr("id");this.collapsedFacetItems=d()(this.collapsedFacetItems,t)},e.prototype.collapseFacetItems=function(e){var t=e.attr("id"),r=e.data("has-more-results");this.collapsedFacetItems=r?s()(this.collapsedFacetItems,[t]):d()(this.collapsedFacetItems,t)},e.prototype.toggleFacetItems=function(e){var t=e.attr("id");return a()(this.collapsedFacetItems,t)?(this.getMoreFacetResults(e),!0):(this.collapseFacetItems(e),!1)},e.prototype.getMoreFacetResults=function(e){var t=this,r=e.data("facet"),i=m.a.getUrl();return this.requestOptions.showMore&&u.a.getPage(i,{template:this.requestOptions.showMore,params:{list_all:r}},function(e,r){if(e)throw new Error(e);t.options.modal.open(),t.options.modalOpen=!0,t.options.modal.updateContent(r)}),this.collapseFacetItems(e),!1},e.prototype.filterFacetItems=function(e){var t=p()(".navList-item"),r=p()(e.currentTarget).val().toLowerCase();t.each(function(e,t){-1!==p()(t).text().toLowerCase().indexOf(r)?p()(t).show():p()(t).hide()})},e.prototype.expandFacet=function(e){e.data("collapsible-instance").open()},e.prototype.collapseFacet=function(e){e.data("collapsible-instance").close()},e.prototype.collapseAllFacets=function(){var e=this;p()(this.options.accordionToggleSelector).each(function(t,r){var i=p()(r);e.collapseFacet(i)})},e.prototype.expandAllFacets=function(){var e=this;p()(this.options.accordionToggleSelector).each(function(t,r){var i=p()(r);e.expandFacet(i)})},e.prototype.initPriceValidator=function(){if(0!==p()(this.options.priceRangeFormSelector).length){var e=r.i(j.a)(),t={errorSelector:this.options.priceRangeErrorSelector,fieldsetSelector:this.options.priceRangeFieldsetSelector,formSelector:this.options.priceRangeFormSelector,maxPriceSelector:this.options.priceRangeMaxPriceSelector,minPriceSelector:this.options.priceRangeMinPriceSelector};b.a.setMinMaxPriceValidation(e,t),this.priceRangeValidator=e}},e.prototype.restoreCollapsedFacetItems=function(){var e=this;p()(this.options.facetNavListSelector).each(function(t,r){var i=p()(r),n=i.attr("id");a()(e.collapsedFacetItems,n)?e.collapseFacetItems(i):e.expandFacetItems(i)})},e.prototype.restoreCollapsedFacets=function(){var e=this;p()(this.options.accordionToggleSelector).each(function(t,r){var i=p()(r),n=i.data("collapsible-instance"),o=n.targetId;a()(e.collapsedFacets,o)?e.collapseFacet(i):e.expandFacet(i)})},e.prototype.bindEvents=function(){this.unbindEvents(),p()(window).on("statechange",this.onStateChange),p()(document).on("click",this.options.showMoreToggleSelector,this.onToggleClick),p()(document).on("toggle.collapsible",this.options.accordionToggleSelector,this.onAccordionToggle),p()(document).on("keyup",this.options.facetedSearchFilterItems,this.filterFacetItems),p()(this.options.clearFacetSelector).on("click",this.onClearFacet),u.b.on("facetedSearch-facet-clicked",this.onFacetClick),u.b.on("facetedSearch-range-submitted",this.onRangeSubmit),u.b.on("sortBy-submitted",this.onSortBySubmit)},e.prototype.unbindEvents=function(){p()(window).off("statechange",this.onStateChange),p()(document).off("click",this.options.showMoreToggleSelector,this.onToggleClick),p()(document).off("toggle.collapsible",this.options.accordionToggleSelector,this.onAccordionToggle),p()(document).off("keyup",this.options.facetedSearchFilterItems,this.filterFacetItems),p()(this.options.clearFacetSelector).off("click",this.onClearFacet),u.b.off("facetedSearch-facet-clicked",this.onFacetClick),u.b.off("facetedSearch-range-submitted",this.onRangeSubmit),u.b.off("sortBy-submitted",this.onSortBySubmit)},e.prototype.onClearFacet=function(e){var t=p()(e.currentTarget),r=t.attr("href");e.preventDefault(),e.stopPropagation(),m.a.goToUrl(r)},e.prototype.onToggleClick=function(e){var t=p()(e.currentTarget),r=p()(t.attr("href"));e.preventDefault(),this.toggleFacetItems(r)},e.prototype.onFacetClick=function(e){var t=p()(e.currentTarget),r=t.attr("href");e.preventDefault(),t.toggleClass("is-selected"),m.a.goToUrl(r),this.options.modalOpen&&this.options.modal.close()},e.prototype.onSortBySubmit=function(e){var t=g.a.parse(location.href,!0),r=p()(e.currentTarget).serialize().split("=");t.query[r[0]]=r[1],delete t.query.page,e.preventDefault(),m.a.goToUrl(g.a.format({pathname:t.pathname,search:m.a.buildQueryString(t.query)}))},e.prototype.onRangeSubmit=function(e){if(e.preventDefault(),this.priceRangeValidator.areAll(j.a.constants.VALID)){var t=g.a.parse(location.href),r=decodeURI(p()(e.currentTarget).serialize());m.a.goToUrl(g.a.format({pathname:t.pathname,search:"?"+r}))}},e.prototype.onStateChange=function(){this.updateView()},e.prototype.onAccordionToggle=function(e){var t=p()(e.currentTarget),r=t.data("collapsible-instance"),i=r.targetId;r.isCollapsed?this.collapsedFacets=s()(this.collapsedFacets,[i]):this.collapsedFacets=d()(this.collapsedFacets,i)},e}();t.a=k},436:function(e,t,r){"use strict";var i=r(1),n=r.n(i);t.a=function(){n()("#list-view").click(function(){n()("#product-listing-container form > .module-wrapper").addClass("productList"),n()(this).attr("class","current-view"),n()("#grid-view").removeClass("current-view")}),n()("#grid-view").click(function(){n()("#product-listing-container form > .module-wrapper").removeClass("productList"),n()(this).attr("class","current-view"),n()("#list-view").removeClass("current-view")})}},437:function(e,t,r){"use strict";var i=r(408),n=r(417),a=r(411),o=r(438);e.exports=o||i.call(a,n)},438:function(e,t,r){"use strict";e.exports="undefined"!=typeof Reflect&&Reflect&&Reflect.apply},439:function(e,t,r){"use strict";var i,n=r(418),a=r(423);try{i=[].__proto__===Array.prototype}catch(e){if(!(e&&"object"==typeof e&&"code"in e&&"ERR_PROTO_ACCESS"===e.code))throw e}var o=!!i&&a&&a(Object.prototype,"__proto__"),s=Object,c=s.getPrototypeOf;e.exports=o&&"function"==typeof o.get?n([o.get]):"function"==typeof c&&function(e){return c(null==e?e:s(e))}},440:function(e,t,r){"use strict";var i=Object.defineProperty||!1;if(i)try{i({},"a",{value:1})}catch(e){i=!1}e.exports=i},441:function(e,t,r){"use strict";e.exports=EvalError},442:function(e,t,r){"use strict";e.exports=Error},443:function(e,t,r){"use strict";e.exports=RangeError},444:function(e,t,r){"use strict";e.exports=ReferenceError},445:function(e,t,r){"use strict";e.exports=SyntaxError},446:function(e,t,r){"use strict";e.exports=URIError},447:function(e,t,r){"use strict";var i=Object.prototype.toString,n=Math.max,a=function(e,t){for(var r=[],i=0;i<e.length;i+=1)r[i]=e[i];for(var n=0;n<t.length;n+=1)r[n+e.length]=t[n];return r},o=function(e,t){for(var r=[],i=t||0,n=0;i<e.length;i+=1,n+=1)r[n]=e[i];return r},s=function(e,t){for(var r="",i=0;i<e.length;i+=1)r+=e[i],i+1<e.length&&(r+=t);return r};e.exports=function(e){var t=this;if("function"!=typeof t||"[object Function]"!==i.apply(t))throw new TypeError("Function.prototype.bind called on incompatible "+t);for(var r,c=o(arguments,1),d=function(){if(this instanceof r){var i=t.apply(this,a(c,arguments));return Object(i)===i?i:this}return t.apply(e,a(c,arguments))},l=n(0,t.length-c.length),h=[],u=0;u<l;u++)h[u]="$"+u;if(r=Function("binder","return function ("+s(h,",")+"){ return binder.apply(this,arguments); }")(d),t.prototype){var f=function(){};f.prototype=t.prototype,r.prototype=new f,f.prototype=null}return r}},448:function(e,t,r){"use strict";var i=r(422),n=r(421),a=r(439);e.exports=i?function(e){return i(e)}:n?function(e){if(!e||"object"!=typeof e&&"function"!=typeof e)throw new TypeError("getProto: not an object");return n(e)}:a?function(e){return a(e)}:null},449:function(e,t,r){"use strict";e.exports=Object.getOwnPropertyDescriptor},450:function(e,t,r){"use strict";var i="undefined"!=typeof Symbol&&Symbol,n=r(451);e.exports=function(){return"function"==typeof i&&("function"==typeof Symbol&&("symbol"==typeof i("foo")&&("symbol"==typeof Symbol("bar")&&n())))}},451:function(e,t,r){"use strict";e.exports=function(){if("function"!=typeof Symbol||"function"!=typeof Object.getOwnPropertySymbols)return!1;if("symbol"==typeof Symbol.iterator)return!0;var e={},t=Symbol("test"),r=Object(t);if("string"==typeof t)return!1;if("[object Symbol]"!==Object.prototype.toString.call(t))return!1;if("[object Symbol]"!==Object.prototype.toString.call(r))return!1;e[t]=42;for(var i in e)return!1;if("function"==typeof Object.keys&&0!==Object.keys(e).length)return!1;if("function"==typeof Object.getOwnPropertyNames&&0!==Object.getOwnPropertyNames(e).length)return!1;var n=Object.getOwnPropertySymbols(e);if(1!==n.length||n[0]!==t)return!1;if(!Object.prototype.propertyIsEnumerable.call(e,t))return!1;if("function"==typeof Object.getOwnPropertyDescriptor){var a=Object.getOwnPropertyDescriptor(e,t);if(42!==a.value||!0!==a.enumerable)return!1}return!0}},452:function(e,t,r){"use strict";var i=Function.prototype.call,n=Object.prototype.hasOwnProperty,a=r(408);e.exports=a.call(i,n)},453:function(e,t,r){var i=r(460),n=r(461),a=r(407),o=a(function(e){return n(i(e,!1,!0))});e.exports=o},454:function(e,t,r){var i=r(459),n=r(55),a=r(407),o=a(function(e,t){return n(e)?i(e,t):[]});e.exports=o},457:function(e,t,r){(function(t){function i(e){var t=e?e.length:0;for(this.data={hash:s(null),set:new o};t--;)this.push(e[t])}var n=r(462),a=r(73),o=a(t,"Set"),s=a(Object,"create");i.prototype.push=n,e.exports=i}).call(t,r(47))},458:function(e,t){function r(e,t){for(var r=-1,i=t.length,n=e.length;++r<i;)e[n+r]=t[r];return e}e.exports=r},459:function(e,t,r){function i(e,t){var r=e?e.length:0,i=[];if(!r)return i;var c=-1,d=n,l=!0,h=l&&t.length>=s?o(t):null,u=t.length;h&&(d=a,l=!1,t=h);e:for(;++c<r;){var f=e[c];if(l&&f===f){for(var p=u;p--;)if(t[p]===f)continue e;i.push(f)}else d(t,f,0)<0&&i.push(f)}return i}var n=r(249),a=r(425),o=r(426),s=200;e.exports=i},460:function(e,t,r){function i(e,t,r,d){d||(d=[]);for(var l=-1,h=e.length;++l<h;){var u=e[l];c(u)&&s(u)&&(r||o(u)||a(u))?t?i(u,t,r,d):n(d,u):r||(d[d.length]=u)}return d}var n=r(458),a=r(56),o=r(14),s=r(55),c=r(35);e.exports=i},461:function(e,t,r){function i(e,t){var r=-1,i=n,c=e.length,d=!0,l=d&&c>=s,h=l?o():null,u=[];h?(i=a,d=!1):(l=!1,h=t?[]:u);e:for(;++r<c;){var f=e[r],p=t?t(f,r,e):f;if(d&&f===f){for(var _=h.length;_--;)if(h[_]===p)continue e;t&&h.push(p),u.push(f)}else i(h,p,0)<0&&((t||l)&&h.push(p),u.push(f))}return u}var n=r(249),a=r(425),o=r(426),s=200;e.exports=i},462:function(e,t,r){function i(e){var t=this.data;"string"==typeof e||n(e)?t.set.add(e):t.hash[e]=!0}var n=r(13);e.exports=i},465:function(e,t,r){"use strict";e.exports=Math.abs},466:function(e,t,r){"use strict";e.exports=Math.floor},467:function(e,t,r){"use strict";e.exports=Number.isNaN||function(e){return e!==e}},468:function(e,t,r){"use strict";e.exports=Math.max},469:function(e,t,r){"use strict";e.exports=Math.min},470:function(e,t,r){"use strict";e.exports=Math.pow},471:function(e,t,r){"use strict";e.exports=Math.round},472:function(e,t,r){"use strict";var i=r(467);e.exports=function(e){return i(e)||0===e?e:e<0?-1:1}},473:function(e,t,r){(function(e,i){var n;!function(a){function o(e){throw new RangeError(N[e])}function s(e,t){for(var r=e.length,i=[];r--;)i[r]=t(e[r]);return i}function c(e,t){var r=e.split("@"),i="";return r.length>1&&(i=r[0]+"@",e=r[1]),e=e.replace(P,"."),i+s(e.split("."),t).join(".")}function d(e){for(var t,r,i=[],n=0,a=e.length;n<a;)t=e.charCodeAt(n++),t>=55296&&t<=56319&&n<a?(r=e.charCodeAt(n++),56320==(64512&r)?i.push(((1023&t)<<10)+(1023&r)+65536):(i.push(t),n--)):i.push(t);return i}function l(e){return s(e,function(e){var t="";return e>65535&&(e-=65536,t+=L(e>>>10&1023|55296),e=56320|1023&e),t+=L(e)}).join("")}function h(e){return e-48<10?e-22:e-65<26?e-65:e-97<26?e-97:j}function u(e,t){return e+22+75*(e<26)-((0!=t)<<5)}function f(e,t,r){var i=0;for(e=r?I(e/S):e>>1,e+=I(e/t);e>F*w>>1;i+=j)e=I(e/F);return I(i+(F+1)*e/(e+x))}function p(e){var t,r,i,n,a,s,c,d,u,p,_=[],g=e.length,m=0,y=O,v=C;for(r=e.lastIndexOf(A),r<0&&(r=0),i=0;i<r;++i)e.charCodeAt(i)>=128&&o("not-basic"),_.push(e.charCodeAt(i));for(n=r>0?r+1:0;n<g;){for(a=m,s=1,c=j;n>=g&&o("invalid-input"),d=h(e.charCodeAt(n++)),(d>=j||d>I((b-m)/s))&&o("overflow"),m+=d*s,u=c<=v?k:c>=v+w?w:c-v,!(d<u);c+=j)p=j-u,s>I(b/p)&&o("overflow"),s*=p;t=_.length+1,v=f(m-a,t,0==a),I(m/t)>b-y&&o("overflow"),y+=I(m/t),m%=t,_.splice(m++,0,y)}return l(_)}function _(e){var t,r,i,n,a,s,c,l,h,p,_,g,m,y,v,x=[];for(e=d(e),g=e.length,t=O,r=0,a=C,s=0;s<g;++s)(_=e[s])<128&&x.push(L(_));for(i=n=x.length,n&&x.push(A);i<g;){for(c=b,s=0;s<g;++s)(_=e[s])>=t&&_<c&&(c=_);for(m=i+1,c-t>I((b-r)/m)&&o("overflow"),r+=(c-t)*m,t=c,s=0;s<g;++s)if(_=e[s],_<t&&++r>b&&o("overflow"),_==t){for(l=r,h=j;p=h<=a?k:h>=a+w?w:h-a,!(l<p);h+=j)v=l-p,y=j-p,x.push(L(u(p+v%y,0))),l=I(v/y);x.push(L(u(l,0))),a=f(r,m,i==n),r=0,++i}++r,++t}return x.join("")}function g(e){return c(e,function(e){return T.test(e)?p(e.slice(4).toLowerCase()):e})}function m(e){return c(e,function(e){return E.test(e)?"xn--"+_(e):e})}var y=("object"==typeof t&&t&&t.nodeType,"object"==typeof e&&e&&e.nodeType,"object"==typeof i&&i);var v,b=2147483647,j=36,k=1,w=26,x=38,S=700,C=72,O=128,A="-",T=/^xn--/,E=/[^\x20-\x7E]/,P=/[\x2E\u3002\uFF0E\uFF61]/g,N={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},F=j-k,I=Math.floor,L=String.fromCharCode;v={version:"1.4.1",ucs2:{decode:d,encode:l},decode:p,encode:_,toASCII:m,toUnicode:g},void 0!==(n=function(){return v}.call(t,r,t,e))&&(e.exports=n)}()}).call(t,r(258)(e),r(47))},474:function(e,t,r){"use strict";var i=r(476),n=r(475),a=r(413);e.exports={formats:a,parse:n,stringify:i}},475:function(e,t,r){"use strict";var i=r(427),n=Object.prototype.hasOwnProperty,a=Array.isArray,o={allowDots:!1,allowEmptyArrays:!1,allowPrototypes:!1,allowSparse:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decodeDotInKeys:!1,decoder:i.decode,delimiter:"&",depth:5,duplicates:"combine",ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictDepth:!1,strictNullHandling:!1,throwOnLimitExceeded:!1},s=function(e){return e.replace(/&#(\d+);/g,function(e,t){return String.fromCharCode(parseInt(t,10))})},c=function(e,t,r){if(e&&"string"==typeof e&&t.comma&&e.indexOf(",")>-1)return e.split(",");if(t.throwOnLimitExceeded&&r>=t.arrayLimit)throw new RangeError("Array limit exceeded. Only "+t.arrayLimit+" element"+(1===t.arrayLimit?"":"s")+" allowed in an array.");return e},d=function(e,t){var r={__proto__:null},d=t.ignoreQueryPrefix?e.replace(/^\?/,""):e;d=d.replace(/%5B/gi,"[").replace(/%5D/gi,"]");var l=t.parameterLimit===1/0?void 0:t.parameterLimit,h=d.split(t.delimiter,t.throwOnLimitExceeded?l+1:l);if(t.throwOnLimitExceeded&&h.length>l)throw new RangeError("Parameter limit exceeded. Only "+l+" parameter"+(1===l?"":"s")+" allowed.");var u,f=-1,p=t.charset;if(t.charsetSentinel)for(u=0;u<h.length;++u)0===h[u].indexOf("utf8=")&&("utf8=%E2%9C%93"===h[u]?p="utf-8":"utf8=%26%2310003%3B"===h[u]&&(p="iso-8859-1"),f=u,u=h.length);for(u=0;u<h.length;++u)if(u!==f){var _,g,m=h[u],y=m.indexOf("]="),v=-1===y?m.indexOf("="):y+1;-1===v?(_=t.decoder(m,o.decoder,p,"key"),g=t.strictNullHandling?null:""):(_=t.decoder(m.slice(0,v),o.decoder,p,"key"),g=i.maybeMap(c(m.slice(v+1),t,a(r[_])?r[_].length:0),function(e){return t.decoder(e,o.decoder,p,"value")})),g&&t.interpretNumericEntities&&"iso-8859-1"===p&&(g=s(String(g))),m.indexOf("[]=")>-1&&(g=a(g)?[g]:g);var b=n.call(r,_);b&&"combine"===t.duplicates?r[_]=i.combine(r[_],g):b&&"last"!==t.duplicates||(r[_]=g)}return r},l=function(e,t,r,n){var a=0;if(e.length>0&&"[]"===e[e.length-1]){var o=e.slice(0,-1).join("");a=Array.isArray(t)&&t[o]?t[o].length:0}for(var s=n?t:c(t,r,a),d=e.length-1;d>=0;--d){var l,h=e[d];if("[]"===h&&r.parseArrays)l=r.allowEmptyArrays&&(""===s||r.strictNullHandling&&null===s)?[]:i.combine([],s);else{l=r.plainObjects?{__proto__:null}:{};var u="["===h.charAt(0)&&"]"===h.charAt(h.length-1)?h.slice(1,-1):h,f=r.decodeDotInKeys?u.replace(/%2E/g,"."):u,p=parseInt(f,10);r.parseArrays||""!==f?!isNaN(p)&&h!==f&&String(p)===f&&p>=0&&r.parseArrays&&p<=r.arrayLimit?(l=[],l[p]=s):"__proto__"!==f&&(l[f]=s):l={0:s}}s=l}return s},h=function(e,t,r,i){if(e){var a=r.allowDots?e.replace(/\.([^.[]+)/g,"[$1]"):e,o=/(\[[^[\]]*])/,s=/(\[[^[\]]*])/g,c=r.depth>0&&o.exec(a),d=c?a.slice(0,c.index):a,h=[];if(d){if(!r.plainObjects&&n.call(Object.prototype,d)&&!r.allowPrototypes)return;h.push(d)}for(var u=0;r.depth>0&&null!==(c=s.exec(a))&&u<r.depth;){if(u+=1,!r.plainObjects&&n.call(Object.prototype,c[1].slice(1,-1))&&!r.allowPrototypes)return;h.push(c[1])}if(c){if(!0===r.strictDepth)throw new RangeError("Input depth exceeded depth option of "+r.depth+" and strictDepth is true");h.push("["+a.slice(c.index)+"]")}return l(h,t,r,i)}},u=function(e){if(!e)return o;if(void 0!==e.allowEmptyArrays&&"boolean"!=typeof e.allowEmptyArrays)throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(void 0!==e.decodeDotInKeys&&"boolean"!=typeof e.decodeDotInKeys)throw new TypeError("`decodeDotInKeys` option can only be `true` or `false`, when provided");if(null!==e.decoder&&void 0!==e.decoder&&"function"!=typeof e.decoder)throw new TypeError("Decoder has to be a function.");if(void 0!==e.charset&&"utf-8"!==e.charset&&"iso-8859-1"!==e.charset)throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");if(void 0!==e.throwOnLimitExceeded&&"boolean"!=typeof e.throwOnLimitExceeded)throw new TypeError("`throwOnLimitExceeded` option must be a boolean");var t=void 0===e.charset?o.charset:e.charset,r=void 0===e.duplicates?o.duplicates:e.duplicates;if("combine"!==r&&"first"!==r&&"last"!==r)throw new TypeError("The duplicates option must be either combine, first, or last");return{allowDots:void 0===e.allowDots?!0===e.decodeDotInKeys||o.allowDots:!!e.allowDots,allowEmptyArrays:"boolean"==typeof e.allowEmptyArrays?!!e.allowEmptyArrays:o.allowEmptyArrays,allowPrototypes:"boolean"==typeof e.allowPrototypes?e.allowPrototypes:o.allowPrototypes,allowSparse:"boolean"==typeof e.allowSparse?e.allowSparse:o.allowSparse,arrayLimit:"number"==typeof e.arrayLimit?e.arrayLimit:o.arrayLimit,charset:t,charsetSentinel:"boolean"==typeof e.charsetSentinel?e.charsetSentinel:o.charsetSentinel,comma:"boolean"==typeof e.comma?e.comma:o.comma,decodeDotInKeys:"boolean"==typeof e.decodeDotInKeys?e.decodeDotInKeys:o.decodeDotInKeys,decoder:"function"==typeof e.decoder?e.decoder:o.decoder,delimiter:"string"==typeof e.delimiter||i.isRegExp(e.delimiter)?e.delimiter:o.delimiter,depth:"number"==typeof e.depth||!1===e.depth?+e.depth:o.depth,duplicates:r,ignoreQueryPrefix:!0===e.ignoreQueryPrefix,interpretNumericEntities:"boolean"==typeof e.interpretNumericEntities?e.interpretNumericEntities:o.interpretNumericEntities,parameterLimit:"number"==typeof e.parameterLimit?e.parameterLimit:o.parameterLimit,parseArrays:!1!==e.parseArrays,plainObjects:"boolean"==typeof e.plainObjects?e.plainObjects:o.plainObjects,strictDepth:"boolean"==typeof e.strictDepth?!!e.strictDepth:o.strictDepth,strictNullHandling:"boolean"==typeof e.strictNullHandling?e.strictNullHandling:o.strictNullHandling,throwOnLimitExceeded:"boolean"==typeof e.throwOnLimitExceeded&&e.throwOnLimitExceeded}};e.exports=function(e,t){var r=u(t);if(""===e||null===e||void 0===e)return r.plainObjects?{__proto__:null}:{};for(var n="string"==typeof e?d(e,r):e,a=r.plainObjects?{__proto__:null}:{},o=Object.keys(n),s=0;s<o.length;++s){var c=o[s],l=h(c,n[c],r,"string"==typeof e);a=i.merge(a,l,r)}return!0===r.allowSparse?a:i.compact(a)}},476:function(e,t,r){"use strict";var i=r(479),n=r(427),a=r(413),o=Object.prototype.hasOwnProperty,s={brackets:function(e){return e+"[]"},comma:"comma",indices:function(e,t){return e+"["+t+"]"},repeat:function(e){return e}},c=Array.isArray,d=Array.prototype.push,l=function(e,t){d.apply(e,c(t)?t:[t])},h=Date.prototype.toISOString,u=a.default,f={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,commaRoundTrip:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:n.encode,encodeValuesOnly:!1,filter:void 0,format:u,formatter:a.formatters[u],indices:!1,serializeDate:function(e){return h.call(e)},skipNulls:!1,strictNullHandling:!1},p=function(e){return"string"==typeof e||"number"==typeof e||"boolean"==typeof e||"symbol"==typeof e||"bigint"==typeof e},_={},g=function e(t,r,a,o,s,d,h,u,g,m,y,v,b,j,k,w,x,S){for(var C=t,O=S,A=0,T=!1;void 0!==(O=O.get(_))&&!T;){var E=O.get(t);if(A+=1,void 0!==E){if(E===A)throw new RangeError("Cyclic object value");T=!0}void 0===O.get(_)&&(A=0)}if("function"==typeof m?C=m(r,C):C instanceof Date?C=b(C):"comma"===a&&c(C)&&(C=n.maybeMap(C,function(e){return e instanceof Date?b(e):e})),null===C){if(d)return g&&!w?g(r,f.encoder,x,"key",j):r;C=""}if(p(C)||n.isBuffer(C)){if(g){return[k(w?r:g(r,f.encoder,x,"key",j))+"="+k(g(C,f.encoder,x,"value",j))]}return[k(r)+"="+k(String(C))]}var P=[];if(void 0===C)return P;var N;if("comma"===a&&c(C))w&&g&&(C=n.maybeMap(C,g)),N=[{value:C.length>0?C.join(",")||null:void 0}];else if(c(m))N=m;else{var F=Object.keys(C);N=y?F.sort(y):F}var I=u?String(r).replace(/\./g,"%2E"):String(r),L=o&&c(C)&&1===C.length?I+"[]":I;if(s&&c(C)&&0===C.length)return L+"[]";for(var M=0;M<N.length;++M){var D=N[M],R="object"==typeof D&&D&&void 0!==D.value?D.value:C[D];if(!h||null!==R){var q=v&&u?String(D).replace(/\./g,"%2E"):String(D),$=c(C)?"function"==typeof a?a(L,q):L:L+(v?"."+q:"["+q+"]");S.set(t,A);var K=i();K.set(_,S),l(P,e(R,$,a,o,s,d,h,u,"comma"===a&&w&&c(C)?null:g,m,y,v,b,j,k,w,x,K))}}return P},m=function(e){if(!e)return f;if(void 0!==e.allowEmptyArrays&&"boolean"!=typeof e.allowEmptyArrays)throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(void 0!==e.encodeDotInKeys&&"boolean"!=typeof e.encodeDotInKeys)throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(null!==e.encoder&&void 0!==e.encoder&&"function"!=typeof e.encoder)throw new TypeError("Encoder has to be a function.");var t=e.charset||f.charset;if(void 0!==e.charset&&"utf-8"!==e.charset&&"iso-8859-1"!==e.charset)throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var r=a.default;if(void 0!==e.format){if(!o.call(a.formatters,e.format))throw new TypeError("Unknown format option provided.");r=e.format}var i=a.formatters[r],n=f.filter;("function"==typeof e.filter||c(e.filter))&&(n=e.filter);var d;if(d=e.arrayFormat in s?e.arrayFormat:"indices"in e?e.indices?"indices":"repeat":f.arrayFormat,"commaRoundTrip"in e&&"boolean"!=typeof e.commaRoundTrip)throw new TypeError("`commaRoundTrip` must be a boolean, or absent");var l=void 0===e.allowDots?!0===e.encodeDotInKeys||f.allowDots:!!e.allowDots;return{addQueryPrefix:"boolean"==typeof e.addQueryPrefix?e.addQueryPrefix:f.addQueryPrefix,allowDots:l,allowEmptyArrays:"boolean"==typeof e.allowEmptyArrays?!!e.allowEmptyArrays:f.allowEmptyArrays,arrayFormat:d,charset:t,charsetSentinel:"boolean"==typeof e.charsetSentinel?e.charsetSentinel:f.charsetSentinel,commaRoundTrip:!!e.commaRoundTrip,delimiter:void 0===e.delimiter?f.delimiter:e.delimiter,encode:"boolean"==typeof e.encode?e.encode:f.encode,encodeDotInKeys:"boolean"==typeof e.encodeDotInKeys?e.encodeDotInKeys:f.encodeDotInKeys,encoder:"function"==typeof e.encoder?e.encoder:f.encoder,encodeValuesOnly:"boolean"==typeof e.encodeValuesOnly?e.encodeValuesOnly:f.encodeValuesOnly,filter:n,format:r,formatter:i,serializeDate:"function"==typeof e.serializeDate?e.serializeDate:f.serializeDate,skipNulls:"boolean"==typeof e.skipNulls?e.skipNulls:f.skipNulls,sort:"function"==typeof e.sort?e.sort:null,strictNullHandling:"boolean"==typeof e.strictNullHandling?e.strictNullHandling:f.strictNullHandling}};e.exports=function(e,t){var r,n,a=e,o=m(t);"function"==typeof o.filter?(n=o.filter,a=n("",a)):c(o.filter)&&(n=o.filter,r=n);var d=[];if("object"!=typeof a||null===a)return"";var h=s[o.arrayFormat],u="comma"===h&&o.commaRoundTrip;r||(r=Object.keys(a)),o.sort&&r.sort(o.sort);for(var f=i(),p=0;p<r.length;++p){var _=r[p],y=a[_];o.skipNulls&&null===y||l(d,g(y,_,h,u,o.allowEmptyArrays,o.strictNullHandling,o.skipNulls,o.encodeDotInKeys,o.encode?o.encoder:null,o.filter,o.sort,o.allowDots,o.serializeDate,o.format,o.formatter,o.encodeValuesOnly,o.charset,f))}var v=d.join(o.delimiter),b=!0===o.addQueryPrefix?"?":"";return o.charsetSentinel&&("iso-8859-1"===o.charset?b+="utf8=%26%2310003%3B&":b+="utf8=%E2%9C%93&"),v.length>0?b+v:""}},477:function(e,t,r){"use strict";var i=r(409),n=r(406),a=function(e,t,r){for(var i,n=e;null!=(i=n.next);n=i)if(i.key===t)return n.next=i.next,r||(i.next=e.next,e.next=i),i},o=function(e,t){if(e){var r=a(e,t);return r&&r.value}},s=function(e,t,r){var i=a(e,t);i?i.value=r:e.next={key:t,next:e.next,value:r}},c=function(e,t){return!!e&&!!a(e,t)},d=function(e,t){if(e)return a(e,t,!0)};e.exports=function(){var e,t={assert:function(e){if(!t.has(e))throw new n("Side channel does not contain "+i(e))},delete:function(t){var r=e&&e.next,i=d(e,t);return i&&r&&r===i&&(e=void 0),!!i},get:function(t){return o(e,t)},has:function(t){return c(e,t)},set:function(t,r){e||(e={next:void 0}),s(e,t,r)}};return t}},478:function(e,t,r){"use strict";var i=r(412),n=r(419),a=r(409),o=r(428),s=r(406),c=i("%WeakMap%",!0),d=n("WeakMap.prototype.get",!0),l=n("WeakMap.prototype.set",!0),h=n("WeakMap.prototype.has",!0),u=n("WeakMap.prototype.delete",!0);e.exports=c?function(){var e,t,r={assert:function(e){if(!r.has(e))throw new s("Side channel does not contain "+a(e))},delete:function(r){if(c&&r&&("object"==typeof r||"function"==typeof r)){if(e)return u(e,r)}else if(o&&t)return t.delete(r);return!1},get:function(r){return c&&r&&("object"==typeof r||"function"==typeof r)&&e?d(e,r):t&&t.get(r)},has:function(r){return c&&r&&("object"==typeof r||"function"==typeof r)&&e?h(e,r):!!t&&t.has(r)},set:function(r,i){c&&r&&("object"==typeof r||"function"==typeof r)?(e||(e=new c),l(e,r,i)):o&&(t||(t=o()),t.set(r,i))}};return r}:o},479:function(e,t,r){"use strict";var i=r(406),n=r(409),a=r(477),o=r(428),s=r(478),c=s||o||a;e.exports=function(){var e,t={assert:function(e){if(!t.has(e))throw new i("Side channel does not contain "+n(e))},delete:function(t){return!!e&&e.delete(t)},get:function(t){return e&&e.get(t)},has:function(t){return!!e&&e.has(t)},set:function(t,r){e||(e=c()),e.set(t,r)}};return t}},480:function(e,t){},500:function(e,t,r){var i,n,a;!function(o){"use strict";n=[r(1)],i=o,void 0!==(a="function"==typeof i?i.apply(t,n):i)&&(e.exports=a)}(function(e,t){"use strict";if(!e.jstree){var r=0,i=!1,n=!1,a=!1,o=[],s=e("script:last").attr("src"),c=window.document,d=window.setImmediate,l=window.Promise;!d&&l&&(d=function(e,t){l.resolve(t).then(e)}),e.jstree={version:"3.3.17",defaults:{plugins:[]},plugins:{},path:s&&-1!==s.indexOf("/")?s.replace(/\/[^\/]+$/,""):"",idregex:/[\\:&!^|()\[\]<>@*'+~#";.,=\- \/${}%?`]/g,root:"#"},e.jstree.create=function(t,i){var n=new e.jstree.core(++r),a=i;return i=e.extend(!0,{},e.jstree.defaults,i),a&&a.plugins&&(i.plugins=a.plugins),e.each(i.plugins,function(e,t){"core"!==e&&(n=n.plugin(t,i[t]))}),e(t).data("jstree",n),n.init(t,i),n},e.jstree.destroy=function(){e(".jstree:jstree").jstree("destroy"),e(c).off(".jstree")},e.jstree.core=function(e){this._id=e,this._cnt=0,this._wrk=null,this._data={core:{themes:{name:!1,dots:!1,icons:!1,ellipsis:!1},selected:[],last_error:{},working:!1,worker_queue:[],focused:null}}},e.jstree.reference=function(t){var r=null,i=null;if(!t||!t.id||t.tagName&&t.nodeType||(t=t.id),!i||!i.length)try{i=e(t)}catch(i){}if(!i||!i.length)try{i=e("#"+t.replace(e.jstree.idregex,"\\$&"))}catch(i){}return i&&i.length&&(i=i.closest(".jstree")).length&&(i=i.data("jstree"))?r=i:e(".jstree").each(function(){var i=e(this).data("jstree");if(i&&i._model.data[t])return r=i,!1}),r},e.fn.jstree=function(r){var i="string"==typeof r,n=Array.prototype.slice.call(arguments,1),a=null;return!(!0===r&&!this.length)&&(this.each(function(){var o=e.jstree.reference(this),s=i&&o?o[r]:null;if(a=i&&s?s.apply(o,n):null,o||i||r!==t&&!e.isPlainObject(r)||e.jstree.create(this,r),null!==(a=o&&!i||!0===r?o||!1:a)&&a!==t)return!1}),null!==a&&a!==t?a:this)},e.expr.pseudos.jstree=e.expr.createPseudo(function(r){return function(r){return e(r).hasClass("jstree")&&e(r).data("jstree")!==t}}),e.jstree.defaults.core={data:!1,strings:!1,check_callback:!1,error:e.noop,animation:200,multiple:!0,themes:{name:!1,url:!1,dir:!1,dots:!0,icons:!0,ellipsis:!1,stripes:!1,variant:!1,responsive:!1},expand_selected_onload:!0,worker:!0,force_text:!1,dblclick_toggle:!0,loaded_state:!1,restore_focus:!0,compute_elements_positions:!1,keyboard:{"ctrl-space":function(t){t.type="click",e(t.currentTarget).trigger(t)},enter:function(t){t.type="click",e(t.currentTarget).trigger(t)},left:function(t){var t;t.preventDefault(),this.is_open(t.currentTarget)?this.close_node(t.currentTarget):(t=this.get_parent(t.currentTarget))&&t.id!==e.jstree.root&&this.get_node(t,!0).children(".jstree-anchor").trigger("focus")},up:function(e){e.preventDefault();var e=this.get_prev_dom(e.currentTarget);e&&e.length&&e.children(".jstree-anchor").trigger("focus")},right:function(t){var t;t.preventDefault(),this.is_closed(t.currentTarget)?this.open_node(t.currentTarget,function(e){this.get_node(e,!0).children(".jstree-anchor").trigger("focus")}):!this.is_open(t.currentTarget)||(t=this.get_node(t.currentTarget,!0).children(".jstree-children")[0])&&e(this._firstChild(t)).children(".jstree-anchor").trigger("focus")},down:function(e){e.preventDefault();var e=this.get_next_dom(e.currentTarget);e&&e.length&&e.children(".jstree-anchor").trigger("focus")},"*":function(e){this.open_all()},home:function(t){t.preventDefault();var t=this._firstChild(this.get_container_ul()[0]);t&&e(t).children(".jstree-anchor").filter(":visible").trigger("focus")},end:function(e){e.preventDefault(),this.element.find(".jstree-anchor").filter(":visible").last().trigger("focus")},f2:function(e){e.preventDefault(),this.edit(e.currentTarget)}},allow_reselect:!1},e.jstree.core.prototype={plugin:function(t,r){var i=e.jstree.plugins[t];return i?(this._data[t]={},i.prototype=this,new i(r,this)):this},init:function(t,r){this._model={data:{},changed:[],force_full_redraw:!1,redraw_timeout:!1,default_state:{loaded:!0,opened:!1,selected:!1,disabled:!1}},this._model.data[e.jstree.root]={id:e.jstree.root,parent:null,parents:[],children:[],children_d:[],state:{loaded:!1}},this.element=e(t).addClass("jstree jstree-"+this._id),this.settings=r,this._data.core.ready=!1,this._data.core.loaded=!1,this._data.core.rtl="rtl"===this.element.css("direction"),this.element[this._data.core.rtl?"addClass":"removeClass"]("jstree-rtl"),this.element.attr("role","tree"),this.settings.core.multiple&&this.element.attr("aria-multiselectable",!0),this.element.attr("tabindex")||this.element.attr("tabindex","0"),this.bind(),this.trigger("init"),this._data.core.original_container_html=this.element.find(" > ul > li").clone(!0),this._data.core.original_container_html.find("li").addBack().contents().filter(function(){return 3===this.nodeType&&(!this.nodeValue||/^\s+$/.test(this.nodeValue))}).remove(),this.element.html("<ul class='jstree-container-ul jstree-children' role='group'><li id='j"+this._id+"_loading' class='jstree-initial-node jstree-loading jstree-leaf jstree-last' role='none'><i class='jstree-icon jstree-ocl'></i><a class='jstree-anchor' role='treeitem' href='#'><i class='jstree-icon jstree-themeicon-hidden'></i>"+this.get_string("Loading ...")+"</a></li></ul>"),this.element.attr("aria-activedescendant","j"+this._id+"_loading"),this._data.core.li_height=this.get_container_ul().children("li").first().outerHeight()||24,this._data.core.node=this._create_prototype_node(),this.trigger("loading"),this.load_node(e.jstree.root)},destroy:function(e){if(this.trigger("destroy"),this._wrk)try{window.URL.revokeObjectURL(this._wrk),this._wrk=null}catch(e){}e||this.element.empty(),this.teardown()},_create_prototype_node:function(){var e,t,r=c.createElement("LI");return r.setAttribute("role","none"),(e=c.createElement("I")).className="jstree-icon jstree-ocl",e.setAttribute("role","presentation"),r.appendChild(e),(e=c.createElement("A")).className="jstree-anchor",e.setAttribute("href","#"),e.setAttribute("tabindex","-1"),e.setAttribute("role","treeitem"),(t=c.createElement("I")).className="jstree-icon jstree-themeicon",t.setAttribute("role","presentation"),e.appendChild(t),r.appendChild(e),e=t=null,r},_kbevent_to_func:function(e){var t={8:"Backspace",9:"Tab",13:"Enter",19:"Pause",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"Print",45:"Insert",46:"Delete",96:"Numpad0",97:"Numpad1",98:"Numpad2",99:"Numpad3",100:"Numpad4",101:"Numpad5",102:"Numpad6",103:"Numpad7",104:"Numpad8",105:"Numpad9","-13":"NumpadEnter",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"Numlock",145:"Scrolllock",16:"Shift",17:"Ctrl",18:"Alt",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",59:";",61:"=",65:"a",66:"b",67:"c",68:"d",69:"e",70:"f",71:"g",72:"h",73:"i",74:"j",75:"k",76:"l",77:"m",78:"n",79:"o",80:"p",81:"q",82:"r",83:"s",84:"t",85:"u",86:"v",87:"w",88:"x",89:"y",90:"z",107:"+",109:"-",110:".",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",111:"/",106:"*",173:"-"},r=[];if(e.ctrlKey&&r.push("ctrl"),e.altKey&&r.push("alt"),e.shiftKey&&r.push("shift"),r.push(t[e.which]?t[e.which].toLowerCase():e.which),"shift-shift"===(r=r.sort().join("-").toLowerCase())||"ctrl-ctrl"===r||"alt-alt"===r)return null;var i,n,a=this.settings.core.keyboard;for(i in a)if(a.hasOwnProperty(i)&&(n="-"!==(n=i)&&"+"!==n?(n=n.replace("--","-MINUS").replace("+-","-MINUS").replace("++","-PLUS").replace("-+","-PLUS")).split(/-|\+/).sort().join("-").replace("MINUS","-").replace("PLUS","+").toLowerCase():n)===r)return a[i];return null},teardown:function(){this.unbind(),this.element.removeClass("jstree").removeData("jstree").find("[class^='jstree']").addBack().attr("class",function(){return this.className.replace(/jstree[^ ]*|$/gi,"")}),this.element=null},bind:function(){var t="",r=null,i=0;this.element.on("dblclick.jstree",function(e){if(e.target.tagName&&"input"===e.target.tagName.toLowerCase())return!0;if(c.selection&&c.selection.empty)c.selection.empty();else if(window.getSelection){var e=window.getSelection();try{e.removeAllRanges(),e.collapse()}catch(e){}}}).on("mousedown.jstree",function(e){e.target===this.element[0]&&(e.preventDefault(),i=+new Date)}.bind(this)).on("mousedown.jstree",".jstree-ocl",function(e){e.preventDefault()}).on("click.jstree",".jstree-ocl",function(e){this.toggle_node(e.target)}.bind(this)).on("dblclick.jstree",".jstree-anchor",function(e){if(e.target.tagName&&"input"===e.target.tagName.toLowerCase())return!0;this.settings.core.dblclick_toggle&&this.toggle_node(e.target)}.bind(this)).on("click.jstree",".jstree-anchor",function(t){t.preventDefault(),t.currentTarget!==c.activeElement&&e(t.currentTarget).trigger("focus"),this.activate_node(t.currentTarget,t)}.bind(this)).on("keydown.jstree",".jstree-anchor",function(e){if(e.target.tagName&&"input"===e.target.tagName.toLowerCase())return!0;this._data.core.rtl&&(37===e.which?e.which=39:39===e.which&&(e.which=37));var t=this._kbevent_to_func(e);if(t){var e=t.call(this,e);if(!1===e||!0===e)return e}}.bind(this)).on("load_node.jstree",function(t,r){r.status&&(r.node.id!==e.jstree.root||this._data.core.loaded||(this._data.core.loaded=!0,this._firstChild(this.get_container_ul()[0])&&this.element.attr("aria-activedescendant",this._firstChild(this.get_container_ul()[0]).id),this.trigger("loaded")),this._data.core.ready||setTimeout(function(){if(this.element&&!this.get_container_ul().find(".jstree-loading").length){if(this._data.core.ready=!0,this._data.core.selected.length){if(this.settings.core.expand_selected_onload){for(var t,r,i=[],t=0,r=this._data.core.selected.length;t<r;t++)i=i.concat(this._model.data[this._data.core.selected[t]].parents);for(t=0,r=(i=e.vakata.array_unique(i)).length;t<r;t++)this.open_node(i[t],!1,0)}this.trigger("changed",{action:"ready",selected:this._data.core.selected})}this.trigger("ready")}}.bind(this),0))}.bind(this)).on("keypress.jstree",function(i){if(i.target.tagName&&"input"===i.target.tagName.toLowerCase())return!0;r&&clearTimeout(r),r=setTimeout(function(){t=""},500);var n=String.fromCharCode(i.which).toLowerCase(),a=this.element.find(".jstree-anchor").filter(":visible"),i=a.index(c.activeElement)||0,o=!1;if(1<(t+=n).length){if(a.slice(i).each(function(r,i){if(0===e(i).text().toLowerCase().indexOf(t))return e(i).trigger("focus"),!(o=!0)}.bind(this)),o)return;if(a.slice(0,i).each(function(r,i){if(0===e(i).text().toLowerCase().indexOf(t))return e(i).trigger("focus"),!(o=!0)}.bind(this)),o)return}new RegExp("^"+n.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")+"+$").test(t)&&(a.slice(i+1).each(function(t,r){if(e(r).text().toLowerCase().charAt(0)===n)return e(r).trigger("focus"),!(o=!0)}.bind(this)),o||a.slice(0,i+1).each(function(t,r){if(e(r).text().toLowerCase().charAt(0)===n)return e(r).trigger("focus"),!(o=!0)}.bind(this)))}.bind(this)).on("init.jstree",function(){var e=this.settings.core.themes;this._data.core.themes.dots=e.dots,this._data.core.themes.stripes=e.stripes,this._data.core.themes.icons=e.icons,this._data.core.themes.ellipsis=e.ellipsis,this.set_theme(e.name||"default",e.url),this.set_theme_variant(e.variant)}.bind(this)).on("loading.jstree",function(){this[this._data.core.themes.dots?"show_dots":"hide_dots"](),this[this._data.core.themes.icons?"show_icons":"hide_icons"](),this[this._data.core.themes.stripes?"show_stripes":"hide_stripes"](),this[this._data.core.themes.ellipsis?"show_ellipsis":"hide_ellipsis"]()}.bind(this)).on("blur.jstree",".jstree-anchor",function(t){this._data.core.focused=null,e(t.currentTarget).filter(".jstree-hovered").trigger("mouseleave"),this.element.attr("tabindex","0"),e(t.currentTarget).attr("tabindex","-1")}.bind(this)).on("focus.jstree",".jstree-anchor",function(t){var r=this.get_node(t.currentTarget);r&&(r.id||0===r.id)&&(this._data.core.focused=r.id),this.element.find(".jstree-hovered").not(t.currentTarget).trigger("mouseleave"),e(t.currentTarget).trigger("mouseenter"),this.element.attr("tabindex","-1"),e(t.currentTarget).attr("tabindex","0")}.bind(this)).on("focus.jstree",function(){var e;500<+new Date-i&&!this._data.core.focused&&this.settings.core.restore_focus&&(i=0,(e=this.get_node(this.element.attr("aria-activedescendant"),!0))&&e.find("> .jstree-anchor").trigger("focus"))}.bind(this)).on("mouseenter.jstree",".jstree-anchor",function(e){this.hover_node(e.currentTarget)}.bind(this)).on("mouseleave.jstree",".jstree-anchor",function(e){this.dehover_node(e.currentTarget)}.bind(this))},unbind:function(){this.element.off(".jstree"),e(c).off(".jstree-"+this._id)},trigger:function(e,t){((t=t||{}).instance=this).element.triggerHandler(e.replace(".jstree","")+".jstree",t)},get_container:function(){return this.element},get_container_ul:function(){return this.element.children(".jstree-children").first()},get_string:function(t){var r=this.settings.core.strings;return e.vakata.is_function(r)?r.call(this,t):r&&r[t]?r[t]:t},_firstChild:function(e){for(e=e?e.firstChild:null;null!==e&&1!==e.nodeType;)e=e.nextSibling;return e},_nextSibling:function(e){for(e=e?e.nextSibling:null;null!==e&&1!==e.nodeType;)e=e.nextSibling;return e},_previousSibling:function(e){for(e=e?e.previousSibling:null;null!==e&&1!==e.nodeType;)e=e.previousSibling;return e},get_node:function(t,r){var i;(t=t&&(t.id||0===t.id)?t.id:t)instanceof e&&t.length&&t[0].id&&(t=t[0].id);try{if(this._model.data[t])t=this._model.data[t];else if("string"==typeof t&&this._model.data[t.replace(/^#/,"")])t=this._model.data[t.replace(/^#/,"")];else if("string"==typeof t&&(i=e("#"+t.replace(e.jstree.idregex,"\\$&"),this.element)).length&&this._model.data[i.closest(".jstree-node").attr("id")])t=this._model.data[i.closest(".jstree-node").attr("id")];else if((i=this.element.find(t)).length&&this._model.data[i.closest(".jstree-node").attr("id")])t=this._model.data[i.closest(".jstree-node").attr("id")];else{if(!(i=this.element.find(t)).length||!i.hasClass("jstree"))return!1;t=this._model.data[e.jstree.root]}return t=r?t.id===e.jstree.root?this.element:e("#"+t.id.replace(e.jstree.idregex,"\\$&"),this.element):t}catch(t){return!1}},get_path:function(t,r,i){if(!(t=t.parents?t:this.get_node(t))||t.id===e.jstree.root||!t.parents)return!1;var n,a,o=[];for(o.push(i?t.id:t.text),n=0,a=t.parents.length;n<a;n++)o.push(i?t.parents[n]:this.get_text(t.parents[n]));return o=o.reverse().slice(1),r?o.join(r):o},get_next_dom:function(t,r){var i;if((t=this.get_node(t,!0))[0]===this.element[0]){for(i=this._firstChild(this.get_container_ul()[0]);i&&0===i.offsetHeight;)i=this._nextSibling(i);return!!i&&e(i)}if(!t||!t.length)return!1;if(r){i=t[0];do{i=this._nextSibling(i)}while(i&&0===i.offsetHeight);return!!i&&e(i)}if(t.hasClass("jstree-open")){for(i=this._firstChild(t.children(".jstree-children")[0]);i&&0===i.offsetHeight;)i=this._nextSibling(i);if(null!==i)return e(i)}i=t[0];do{i=this._nextSibling(i)}while(i&&0===i.offsetHeight);return null!==i?e(i):t.parentsUntil(".jstree",".jstree-node").nextAll(".jstree-node:visible").first()},get_prev_dom:function(t,r){var i;if((t=this.get_node(t,!0))[0]===this.element[0]){for(i=this.get_container_ul()[0].lastChild;i&&0===i.offsetHeight;)i=this._previousSibling(i);return!!i&&e(i)}if(!t||!t.length)return!1;if(r){i=t[0];do{i=this._previousSibling(i)}while(i&&0===i.offsetHeight);return!!i&&e(i)}i=t[0];do{i=this._previousSibling(i)}while(i&&0===i.offsetHeight);if(null===i)return!(!(i=t[0].parentNode.parentNode)||!i.className||-1===i.className.indexOf("jstree-node"))&&e(i);for(t=e(i);t.hasClass("jstree-open");)t=t.children(".jstree-children").first().children(".jstree-node:visible:last");return t},get_parent:function(t){return!(!(t=this.get_node(t))||t.id===e.jstree.root)&&t.parent},get_children_dom:function(e){return(e=this.get_node(e,!0))[0]===this.element[0]?this.get_container_ul().children(".jstree-node"):!(!e||!e.length)&&e.children(".jstree-children").children(".jstree-node")},is_parent:function(e){return(e=this.get_node(e))&&(!1===e.state.loaded||0<e.children.length)},is_loaded:function(e){return(e=this.get_node(e))&&e.state.loaded},is_loading:function(e){return(e=this.get_node(e))&&e.state&&e.state.loading},is_open:function(e){return(e=this.get_node(e))&&e.state.opened},is_closed:function(e){return(e=this.get_node(e))&&this.is_parent(e)&&!e.state.opened},is_leaf:function(e){return!this.is_parent(e)},load_node:function(t,r){var i,n,a,o,s,c=this.get_node(t,!0);if(e.vakata.is_array(t))return this._load_nodes(t.slice(),r),!0;if(!(t=this.get_node(t)))return r&&r.call(this,t,!1),!1;if(t.state.loaded){for(t.state.loaded=!1,a=0,o=t.parents.length;a<o;a++)this._model.data[t.parents[a]].children_d=e.vakata.array_filter(this._model.data[t.parents[a]].children_d,function(r){return-1===e.inArray(r,t.children_d)});for(i=0,n=t.children_d.length;i<n;i++)this._model.data[t.children_d[i]].state.selected&&(s=!0),delete this._model.data[t.children_d[i]];s&&(this._data.core.selected=e.vakata.array_filter(this._data.core.selected,function(r){return-1===e.inArray(r,t.children_d)})),t.children=[],t.children_d=[],s&&this.trigger("changed",{action:"load_node",node:t,selected:this._data.core.selected})}return t.state.failed=!1,t.state.loading=!0,(t.id!==e.jstree.root?c.children(".jstree-anchor"):c).attr("aria-busy",!0),c.addClass("jstree-loading"),this._load_node(t,function(i){(t=this._model.data[t.id]).state.loading=!1,t.state.loaded=i,t.state.failed=!t.state.loaded;for(var n=this.get_node(t,!0),a=0,o=0,s=this._model.data,c=!1,a=0,o=t.children.length;a<o;a++)if(s[t.children[a]]&&!s[t.children[a]].state.hidden){c=!0;break}t.state.loaded&&n&&n.length&&(n.removeClass("jstree-closed jstree-open jstree-leaf"),c?"#"!==t.id&&n.addClass(t.state.opened?"jstree-open":"jstree-closed"):n.addClass("jstree-leaf")),(t.id!==e.jstree.root?n.children(".jstree-anchor"):n).attr("aria-busy",!1),n.removeClass("jstree-loading"),this.trigger("load_node",{node:t,status:i}),r&&r.call(this,t,i)}.bind(this)),!0},_load_nodes:function(e,t,r,i){for(var n,a,o=!0,s=function(){this._load_nodes(e,t,!0)},c=this._model.data,d=[],n=0,a=e.length;n<a;n++)c[e[n]]&&(!c[e[n]].state.loaded&&!c[e[n]].state.failed||!r&&i)&&(this.is_loading(e[n])||this.load_node(e[n],s),o=!1);if(o){for(n=0,a=e.length;n<a;n++)c[e[n]]&&c[e[n]].state.loaded&&d.push(e[n]);t&&!t.done&&(t.call(this,d),t.done=!0)}},load_all:function(t,r){if(t=t||e.jstree.root,!(t=this.get_node(t)))return!1;var i,n,a=[],o=this._model.data,s=o[t.id].children_d;for(t.state&&!t.state.loaded&&a.push(t.id),i=0,n=s.length;i<n;i++)o[s[i]]&&o[s[i]].state&&!o[s[i]].state.loaded&&a.push(s[i]);a.length?this._load_nodes(a,function(){this.load_all(t,r)}):(r&&r.call(this,t),this.trigger("load_all",{node:t}))},_load_node:function(t,r){var i,n=this.settings.core.data,a=function(){return 3!==this.nodeType&&8!==this.nodeType};return n?e.vakata.is_function(n)?n.call(this,t,function(i){!1===i?r.call(this,!1):this["string"==typeof i?"_append_html_data":"_append_json_data"](t,"string"==typeof i?e(e.parseHTML(i)).filter(a):i,function(e){r.call(this,e)})}.bind(this)):"object"==typeof n?n.url?(n=e.extend(!0,{},n),e.vakata.is_function(n.url)&&(n.url=n.url.call(this,t)),e.vakata.is_function(n.data)&&(n.data=n.data.call(this,t)),e.ajax(n).done(function(i,n,o){var s=o.getResponseHeader("Content-Type");return s&&-1!==s.indexOf("json")||"object"==typeof i?this._append_json_data(t,i,function(e){r.call(this,e)}):s&&-1!==s.indexOf("html")||"string"==typeof i?this._append_html_data(t,e(e.parseHTML(i)).filter(a),function(e){r.call(this,e)}):(this._data.core.last_error={error:"ajax",plugin:"core",id:"core_04",reason:"Could not load node",data:JSON.stringify({id:t.id,xhr:o})},this.settings.core.error.call(this,this._data.core.last_error),r.call(this,!1))}.bind(this)).fail(function(e){this._data.core.last_error={error:"ajax",plugin:"core",id:"core_04",reason:"Could not load node",data:JSON.stringify({id:t.id,xhr:e})},r.call(this,!1),this.settings.core.error.call(this,this._data.core.last_error)}.bind(this))):(i=e.vakata.is_array(n)?e.extend(!0,[],n):e.isPlainObject(n)?e.extend(!0,{},n):n,t.id===e.jstree.root?this._append_json_data(t,i,function(e){r.call(this,e)}):(this._data.core.last_error={error:"nodata",plugin:"core",id:"core_05",reason:"Could not load node",data:JSON.stringify({id:t.id})},this.settings.core.error.call(this,this._data.core.last_error),r.call(this,!1))):"string"==typeof n?t.id===e.jstree.root?this._append_html_data(t,e(e.parseHTML(n)).filter(a),function(e){r.call(this,e)}):(this._data.core.last_error={error:"nodata",plugin:"core",id:"core_06",reason:"Could not load node",data:JSON.stringify({id:t.id})},this.settings.core.error.call(this,this._data.core.last_error),r.call(this,!1)):r.call(this,!1):t.id===e.jstree.root?this._append_html_data(t,this._data.core.original_container_html.clone(!0),function(e){r.call(this,e)}):r.call(this,!1)},_node_changed:function(t){(t=this.get_node(t))&&-1===e.inArray(t.id,this._model.changed)&&this._model.changed.push(t.id)},_append_html_data:function(t,r,i){(t=this.get_node(t)).children=[],t.children_d=[];var n,a,o,r=r.is("ul")?r.children():r,s=t.id,c=[],d=[],l=this._model.data,h=l[s],t=this._data.core.selected.length;for(r.each(function(t,r){(n=this._parse_model_from_html(e(r),s,h.parents.concat()))&&(c.push(n),d.push(n),l[n].children_d.length&&(d=d.concat(l[n].children_d)))}.bind(this)),h.children=c,h.children_d=d,a=0,o=h.parents.length;a<o;a++)l[h.parents[a]].children_d=l[h.parents[a]].children_d.concat(d);this.trigger("model",{nodes:d,parent:s}),s!==e.jstree.root?(this._node_changed(s),this.redraw()):(this.get_container_ul().children(".jstree-initial-node").remove(),this.redraw(!0)),this._data.core.selected.length!==t&&this.trigger("changed",{action:"model",selected:this._data.core.selected}),i.call(this,!0)},_append_json_data:function(t,r,i,n){if(null!==this.element){(t=this.get_node(t)).children=[],t.children_d=[],r.d&&"string"==typeof(r=r.d)&&(r=JSON.parse(r)),e.vakata.is_array(r)||(r=[r]);var a=null,o={df:this._model.default_state,dat:r,par:t.id,m:this._model.data,t_id:this._id,t_cnt:this._cnt,sel:this._data.core.selected},s=this,c=function(e,t){var r,i,n,a,o=(e=e.data?e.data:e).dat,c=e.par,d=[],l=[],h=[],u=e.df,f=e.t_id,p=e.t_cnt,_=e.m,g=_[c],e=e.sel,m=function(e,r,i){i=i?i.concat():[],r&&i.unshift(r);var n,a,o,s,c=e.id.toString(),d={id:c,text:e.text||"",icon:e.icon===t||e.icon,parent:r,parents:i,children:e.children||[],children_d:e.children_d||[],data:e.data,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1};for(n in u)u.hasOwnProperty(n)&&(d.state[n]=u[n]);if(e&&e.data&&e.data.jstree&&e.data.jstree.icon&&(d.icon=e.data.jstree.icon),d.icon!==t&&null!==d.icon&&""!==d.icon||(d.icon=!0),e&&e.data&&(d.data=e.data,e.data.jstree))for(n in e.data.jstree)e.data.jstree.hasOwnProperty(n)&&(d.state[n]=e.data.jstree[n]);if(e&&"object"==typeof e.state)for(n in e.state)e.state.hasOwnProperty(n)&&(d.state[n]=e.state[n]);if(e&&"object"==typeof e.li_attr)for(n in e.li_attr)e.li_attr.hasOwnProperty(n)&&(d.li_attr[n]=e.li_attr[n]);if(d.li_attr.id||(d.li_attr.id=c),e&&"object"==typeof e.a_attr)for(n in e.a_attr)e.a_attr.hasOwnProperty(n)&&(d.a_attr[n]=e.a_attr[n]);for(e&&e.children&&!0===e.children&&(d.state.loaded=!1,d.children=[],d.children_d=[]),n=0,a=(_[d.id]=d).children.length;n<a;n++)o=m(_[d.children[n]],d.id,i),s=_[o],d.children_d.push(o),s.children_d.length&&(d.children_d=d.children_d.concat(s.children_d));return delete e.data,delete e.children,_[d.id].original=e,d.state.selected&&h.push(d.id),d.id},y=function(e,r,i){i=i?i.concat():[],r&&i.unshift(r);var n,a,o,s,c,d=!1;do{d="j"+f+"_"+ ++p}while(_[d]);for(n in c={id:!1,text:"string"==typeof e?e:"",icon:"object"!=typeof e||e.icon===t||e.icon,parent:r,parents:i,children:[],children_d:[],data:null,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1},u)u.hasOwnProperty(n)&&(c.state[n]=u[n]);if(e&&(e.id||0===e.id)&&(c.id=e.id.toString()),e&&e.text&&(c.text=e.text),e&&e.data&&e.data.jstree&&e.data.jstree.icon&&(c.icon=e.data.jstree.icon),c.icon!==t&&null!==c.icon&&""!==c.icon||(c.icon=!0),e&&e.data&&(c.data=e.data,e.data.jstree))for(n in e.data.jstree)e.data.jstree.hasOwnProperty(n)&&(c.state[n]=e.data.jstree[n]);if(e&&"object"==typeof e.state)for(n in e.state)e.state.hasOwnProperty(n)&&(c.state[n]=e.state[n]);if(e&&"object"==typeof e.li_attr)for(n in e.li_attr)e.li_attr.hasOwnProperty(n)&&(c.li_attr[n]=e.li_attr[n]);if(c.li_attr.id&&!c.id&&0!==c.id&&(c.id=c.li_attr.id.toString()),c.id||0===c.id||(c.id=d),c.li_attr.id||(c.li_attr.id=c.id),e&&"object"==typeof e.a_attr)for(n in e.a_attr)e.a_attr.hasOwnProperty(n)&&(c.a_attr[n]=e.a_attr[n]);if(e&&e.children&&e.children.length){for(n=0,a=e.children.length;n<a;n++)o=y(e.children[n],c.id,i),s=_[o],c.children.push(o),s.children_d.length&&(c.children_d=c.children_d.concat(s.children_d));c.children_d=c.children_d.concat(c.children)}return e&&e.children&&!0===e.children&&(c.state.loaded=!1,c.children=[],c.children_d=[]),delete e.data,delete e.children,c.original=e,(_[c.id]=c).state.selected&&h.push(c.id),c.id};if(o.length&&o[0].id!==t&&o[0].parent!==t){for(i=0,n=o.length;i<n;i++)o[i].children||(o[i].children=[]),o[i].state||(o[i].state={}),_[o[i].id.toString()]=o[i];for(i=0,n=o.length;i<n;i++)_[o[i].parent.toString()]?(_[o[i].parent.toString()].children.push(o[i].id.toString()),g.children_d.push(o[i].id.toString())):void 0!==s&&(s._data.core.last_error={error:"parse",plugin:"core",id:"core_07",reason:"Node with invalid parent",data:JSON.stringify({id:o[i].id.toString(),parent:o[i].parent.toString()})},s.settings.core.error.call(s,s._data.core.last_error));for(i=0,n=g.children.length;i<n;i++)r=m(_[g.children[i]],c,g.parents.concat()),l.push(r),_[r].children_d.length&&(l=l.concat(_[r].children_d));for(i=0,n=g.parents.length;i<n;i++)_[g.parents[i]].children_d=_[g.parents[i]].children_d.concat(l);a={cnt:p,mod:_,sel:e,par:c,dpc:l,add:h}}else{for(i=0,n=o.length;i<n;i++)(r=y(o[i],c,g.parents.concat()))&&(d.push(r),l.push(r),_[r].children_d.length&&(l=l.concat(_[r].children_d)));for(g.children=d,g.children_d=l,i=0,n=g.parents.length;i<n;i++)_[g.parents[i]].children_d=_[g.parents[i]].children_d.concat(l);a={cnt:p,mod:_,sel:e,par:c,dpc:l,add:h}}if("undefined"!=typeof window&&void 0!==window.document)return a;postMessage(a)},l=function(t,r){if(null!==this.element){var n,a;for(n in this._cnt=t.cnt,a=this._model.data)a.hasOwnProperty(n)&&a[n].state&&a[n].state.loading&&t.mod[n]&&(t.mod[n].state.loading=!0);if(this._model.data=t.mod,r){var o,c=t.add,l=t.sel,h=this._data.core.selected.slice(),a=this._model.data;if(l.length!==h.length||e.vakata.array_unique(l.concat(h)).length!==l.length){for(n=0,o=l.length;n<o;n++)-1===e.inArray(l[n],c)&&-1===e.inArray(l[n],h)&&(a[l[n]].state.selected=!1);for(n=0,o=h.length;n<o;n++)-1===e.inArray(h[n],l)&&(a[h[n]].state.selected=!0)}}t.add.length&&(this._data.core.selected=this._data.core.selected.concat(t.add)),this.trigger("model",{nodes:t.dpc,parent:t.par}),t.par!==e.jstree.root?(this._node_changed(t.par),this.redraw()):this.redraw(!0),t.add.length&&this.trigger("changed",{action:"model",selected:this._data.core.selected}),!r&&d?d(function(){i.call(s,!0)}):i.call(s,!0)}};if(this.settings.core.worker&&window.Blob&&window.URL&&window.Worker)try{null===this._wrk&&(this._wrk=window.URL.createObjectURL(new window.Blob(["self.onmessage = "+c.toString()],{type:"text/javascript"}))),!this._data.core.working||n?(this._data.core.working=!0,(a=new window.Worker(this._wrk)).onmessage=function(e){l.call(this,e.data,!0);try{a.terminate(),a=null}catch(e){}this._data.core.worker_queue.length?this._append_json_data.apply(this,this._data.core.worker_queue.shift()):this._data.core.working=!1}.bind(this),a.onerror=function(e){l.call(this,c(o),!1),this._data.core.worker_queue.length?this._append_json_data.apply(this,this._data.core.worker_queue.shift()):this._data.core.working=!1}.bind(this),o.par?a.postMessage(o):this._data.core.worker_queue.length?this._append_json_data.apply(this,this._data.core.worker_queue.shift()):this._data.core.working=!1):this._data.core.worker_queue.push([t,r,i,!0])}catch(t){l.call(this,c(o),!1),this._data.core.worker_queue.length?this._append_json_data.apply(this,this._data.core.worker_queue.shift()):this._data.core.working=!1}else l.call(this,c(o),!1)}},_parse_model_from_html:function(r,i,n){n=n?[].concat(n):[],i&&n.unshift(i);var a,o,s,i,c,d=this._model.data,l={id:!1,text:!1,icon:!0,parent:i,parents:n,children:[],children_d:[],data:null,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1};for(s in this._model.default_state)this._model.default_state.hasOwnProperty(s)&&(l.state[s]=this._model.default_state[s]);if(i=e.vakata.attributes(r,!0),e.each(i,function(t,r){return!(r=e.vakata.trim(r)).length||(l.li_attr[t]=r,void("id"===t&&(l.id=r.toString())))}),(i=r.children("a").first()).length&&(i=e.vakata.attributes(i,!0),e.each(i,function(t,r){(r=e.vakata.trim(r)).length&&(l.a_attr[t]=r)})),(i=(r.children("a").first().length?r.children("a").first():r).clone()).children("ins, i, ul").remove(),i=i.html(),i=e("<div></div>").html(i),l.text=this.settings.core.force_text?i.text():i.html(),i=r.data(),l.data=i?e.extend(!0,{},i):null,l.state.opened=r.hasClass("jstree-open"),l.state.selected=r.children("a").hasClass("jstree-clicked"),l.state.disabled=r.children("a").hasClass("jstree-disabled"),l.data&&l.data.jstree)for(s in l.data.jstree)l.data.jstree.hasOwnProperty(s)&&(l.state[s]=l.data.jstree[s]);(i=r.children("a").children(".jstree-themeicon")).length&&(l.icon=!i.hasClass("jstree-themeicon-hidden")&&i.attr("rel")),l.state.icon!==t&&(l.icon=l.state.icon),l.icon!==t&&null!==l.icon&&""!==l.icon||(l.icon=!0),i=r.children("ul").children("li");do{c="j"+this._id+"_"+ ++this._cnt}while(d[c]);return l.id=l.li_attr.id?l.li_attr.id.toString():c,i.length?(i.each(function(t,r){a=this._parse_model_from_html(e(r),l.id,n),o=this._model.data[a],l.children.push(a),o.children_d.length&&(l.children_d=l.children_d.concat(o.children_d))}.bind(this)),l.children_d=l.children_d.concat(l.children)):r.hasClass("jstree-closed")&&(l.state.loaded=!1),l.li_attr.class&&(l.li_attr.class=l.li_attr.class.replace("jstree-closed","").replace("jstree-open","")),l.a_attr.class&&(l.a_attr.class=l.a_attr.class.replace("jstree-clicked","").replace("jstree-disabled","")),(d[l.id]=l).state.selected&&this._data.core.selected.push(l.id),l.id},_parse_model_from_flat_json:function(e,r,i){i=i?i.concat():[],r&&i.unshift(r);var n,a,o,s,c=e.id.toString(),d=this._model.data,l=this._model.default_state,h={id:c,text:e.text||"",icon:e.icon===t||e.icon,parent:r,parents:i,children:e.children||[],children_d:e.children_d||[],data:e.data,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1};for(n in l)l.hasOwnProperty(n)&&(h.state[n]=l[n]);if(e&&e.data&&e.data.jstree&&e.data.jstree.icon&&(h.icon=e.data.jstree.icon),h.icon!==t&&null!==h.icon&&""!==h.icon||(h.icon=!0),e&&e.data&&(h.data=e.data,e.data.jstree))for(n in e.data.jstree)e.data.jstree.hasOwnProperty(n)&&(h.state[n]=e.data.jstree[n]);if(e&&"object"==typeof e.state)for(n in e.state)e.state.hasOwnProperty(n)&&(h.state[n]=e.state[n]);if(e&&"object"==typeof e.li_attr)for(n in e.li_attr)e.li_attr.hasOwnProperty(n)&&(h.li_attr[n]=e.li_attr[n]);if(h.li_attr.id||(h.li_attr.id=c),e&&"object"==typeof e.a_attr)for(n in e.a_attr)e.a_attr.hasOwnProperty(n)&&(h.a_attr[n]=e.a_attr[n]);for(e&&e.children&&!0===e.children&&(h.state.loaded=!1,h.children=[],h.children_d=[]),n=0,a=(d[h.id]=h).children.length;n<a;n++)s=d[o=this._parse_model_from_flat_json(d[h.children[n]],h.id,i)],h.children_d.push(o),s.children_d.length&&(h.children_d=h.children_d.concat(s.children_d));return delete e.data,delete e.children,d[h.id].original=e,h.state.selected&&this._data.core.selected.push(h.id),h.id},_parse_model_from_json:function(e,r,i){i=i?i.concat():[],r&&i.unshift(r);var n,a,o,s,c,d=!1,l=this._model.data,h=this._model.default_state;do{d="j"+this._id+"_"+ ++this._cnt}while(l[d]);for(n in c={id:!1,text:"string"==typeof e?e:"",icon:"object"!=typeof e||e.icon===t||e.icon,parent:r,parents:i,children:[],children_d:[],data:null,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1},h)h.hasOwnProperty(n)&&(c.state[n]=h[n]);if(e&&(e.id||0===e.id)&&(c.id=e.id.toString()),e&&e.text&&(c.text=e.text),e&&e.data&&e.data.jstree&&e.data.jstree.icon&&(c.icon=e.data.jstree.icon),c.icon!==t&&null!==c.icon&&""!==c.icon||(c.icon=!0),e&&e.data&&(c.data=e.data,e.data.jstree))for(n in e.data.jstree)e.data.jstree.hasOwnProperty(n)&&(c.state[n]=e.data.jstree[n]);if(e&&"object"==typeof e.state)for(n in e.state)e.state.hasOwnProperty(n)&&(c.state[n]=e.state[n]);if(e&&"object"==typeof e.li_attr)for(n in e.li_attr)e.li_attr.hasOwnProperty(n)&&(c.li_attr[n]=e.li_attr[n]);if(c.li_attr.id&&!c.id&&0!==c.id&&(c.id=c.li_attr.id.toString()),c.id||0===c.id||(c.id=d),c.li_attr.id||(c.li_attr.id=c.id),e&&"object"==typeof e.a_attr)for(n in e.a_attr)e.a_attr.hasOwnProperty(n)&&(c.a_attr[n]=e.a_attr[n]);if(e&&e.children&&e.children.length){for(n=0,a=e.children.length;n<a;n++)s=l[o=this._parse_model_from_json(e.children[n],c.id,i)],c.children.push(o),s.children_d.length&&(c.children_d=c.children_d.concat(s.children_d));c.children_d=c.children.concat(c.children_d)}return e&&e.children&&!0===e.children&&(c.state.loaded=!1,c.children=[],c.children_d=[]),delete e.data,delete e.children,c.original=e,(l[c.id]=c).state.selected&&this._data.core.selected.push(c.id),c.id},_redraw:function(){for(var t,r,i,n=(this._model.force_full_redraw?this._model.data[e.jstree.root].children:this._model.changed).concat([]),a=c.createElement("UL"),o=this._data.core.focused,r=0,i=n.length;r<i;r++)(t=this.redraw_node(n[r],!0,this._model.force_full_redraw))&&this._model.force_full_redraw&&a.appendChild(t);this._model.force_full_redraw&&(a.className=this.get_container_ul()[0].className,a.setAttribute("role","presentation"),this.element.empty().append(a)),null!==o&&this.settings.core.restore_focus&&((t=this.get_node(o,!0))&&t.length&&t.children(".jstree-anchor")[0]!==c.activeElement?t.children(".jstree-anchor").trigger("focus"):this._data.core.focused=null),this._model.force_full_redraw=!1,this._model.changed=[],this.trigger("redraw",{nodes:n})},redraw:function(e){e&&(this._model.force_full_redraw=!0),this._redraw()},draw_children:function(t){var r=this.get_node(t),i=!1,n=!1,a=!1,o=c;if(!r)return!1;if(r.id===e.jstree.root)return this.redraw(!0);if(!(t=this.get_node(t,!0))||!t.length)return!1;if(t.children(".jstree-children").remove(),t=t[0],r.children.length&&r.state.loaded){for((a=o.createElement("UL")).setAttribute("role","group"),a.className="jstree-children",i=0,n=r.children.length;i<n;i++)a.appendChild(this.redraw_node(r.children[i],!0,!0));t.appendChild(a)}},redraw_node:function(t,r,i,n){var a=this.get_node(t),o=!1,s=!1,d=!1,l=!1,h=!1,u=!1,f="",p=c,_=this._model.data,g=!1,m=null,y=0,v=0,b=!1,j=!1;if(!a)return!1;if(a.id===e.jstree.root)return this.redraw(!0);if(r=r||0===a.children.length,t=c.querySelector?this.element[0].querySelector("#"+(-1!=="0123456789".indexOf(a.id[0])?"\\3"+a.id[0]+" "+a.id.substr(1).replace(e.jstree.idregex,"\\$&"):a.id.replace(e.jstree.idregex,"\\$&"))):c.getElementById(a.id))t=e(t),i||((o=t.parent().parent()[0])===this.element[0]&&(o=null),s=t.index()),(r=!(r||!a.children.length||t.children(".jstree-children").length)||r)||(d=t.children(".jstree-children")[0]),g=t.children(".jstree-anchor")[0]===c.activeElement,t.remove();else if(r=!0,!i){if(!(null===(o=a.parent!==e.jstree.root?e("#"+a.parent.replace(e.jstree.idregex,"\\$&"),this.element)[0]:null)||o&&_[a.parent].state.opened))return!1;s=e.inArray(a.id,(null===o?_[e.jstree.root]:_[a.parent]).children)}for(l in t=this._data.core.node.cloneNode(!0),f="jstree-node ",a.li_attr)a.li_attr.hasOwnProperty(l)&&"id"!==l&&("class"!==l?t.setAttribute(l,a.li_attr[l]):f+=a.li_attr[l]);for(a.a_attr.id||(a.a_attr.id=a.id+"_anchor"),t.childNodes[1].setAttribute("aria-selected",!!a.state.selected),t.childNodes[1].setAttribute("aria-level",a.parents.length),this.settings.core.compute_elements_positions&&(t.childNodes[1].setAttribute("aria-setsize",_[a.parent].children.length),t.childNodes[1].setAttribute("aria-posinset",_[a.parent].children.indexOf(a.id)+1)),a.state.disabled&&t.childNodes[1].setAttribute("aria-disabled",!0),l=0,h=a.children.length;l<h;l++)if(!_[a.children[l]].state.hidden){b=!0;break}if(null!==a.parent&&_[a.parent]&&!a.state.hidden&&(l=e.inArray(a.id,_[a.parent].children),j=a.id,-1!==l))for(l++,h=_[a.parent].children.length;l<h&&(j=_[_[a.parent].children[l]].state.hidden?j:_[a.parent].children[l])===a.id;l++);for(h in a.state.hidden&&(f+=" jstree-hidden"),a.state.loading&&(f+=" jstree-loading"),a.state.loaded&&!b?f+=" jstree-leaf":(f+=a.state.opened&&a.state.loaded?" jstree-open":" jstree-closed",t.childNodes[1].setAttribute("aria-expanded",a.state.opened&&a.state.loaded)),j===a.id&&(f+=" jstree-last"),t.id=a.id,t.className=f,f=(a.state.selected?" jstree-clicked":"")+(a.state.disabled?" jstree-disabled":""),a.a_attr)a.a_attr.hasOwnProperty(h)&&("href"===h&&"#"===a.a_attr[h]||("class"!==h?t.childNodes[1].setAttribute(h,a.a_attr[h]):f+=" "+a.a_attr[h]));if(f.length&&(t.childNodes[1].className="jstree-anchor "+f),(a.icon&&!0!==a.icon||!1===a.icon)&&(!1===a.icon?t.childNodes[1].childNodes[0].className+=" jstree-themeicon-hidden":-1===a.icon.indexOf("/")&&-1===a.icon.indexOf(".")?t.childNodes[1].childNodes[0].className+=" "+a.icon+" jstree-themeicon-custom":(t.childNodes[1].childNodes[0].style.backgroundImage='url("'+a.icon+'")',t.childNodes[1].childNodes[0].style.backgroundPosition="center center",t.childNodes[1].childNodes[0].style.backgroundSize="auto",t.childNodes[1].childNodes[0].className+=" jstree-themeicon-custom")),this.settings.core.force_text?t.childNodes[1].appendChild(p.createTextNode(a.text)):t.childNodes[1].innerHTML+=a.text,r&&a.children.length&&(a.state.opened||n)&&a.state.loaded){for((u=p.createElement("UL")).setAttribute("role","group"),u.className="jstree-children",l=0,h=a.children.length;l<h;l++)u.appendChild(this.redraw_node(a.children[l],r,!0));t.appendChild(u)}if(d&&t.appendChild(d),!i){for(l=0,h=(o=o||this.element[0]).childNodes.length;l<h;l++)if(o.childNodes[l]&&o.childNodes[l].className&&-1!==o.childNodes[l].className.indexOf("jstree-children")){m=o.childNodes[l];break}m||((m=p.createElement("UL")).setAttribute("role","group"),m.className="jstree-children",o.appendChild(m)),s<(o=m).childNodes.length?o.insertBefore(t,o.childNodes[s]):o.appendChild(t),g&&(y=this.element[0].scrollTop,v=this.element[0].scrollLeft,t.childNodes[1].focus(),this.element[0].scrollTop=y,this.element[0].scrollLeft=v)}return a.state.opened&&!a.state.loaded&&(a.state.opened=!1,setTimeout(function(){this.open_node(a.id,!1,0)}.bind(this),0)),t},open_node:function(r,i,n){var a,o,s,c;if(e.vakata.is_array(r)){for(a=0,o=(r=r.slice()).length;a<o;a++)this.open_node(r[a],i,n);return!0}return!(!(r=this.get_node(r))||r.id===e.jstree.root)&&(n=n===t?this.settings.core.animation:n,this.is_closed(r)?this.is_loaded(r)?(s=this.get_node(r,!0),c=this,s.length&&(n&&s.children(".jstree-children").length&&s.children(".jstree-children").stop(!0,!0),r.children.length&&!this._firstChild(s.children(".jstree-children")[0])&&this.draw_children(r),n?(this.trigger("before_open",{node:r}),s.children(".jstree-children").css("display","none").end().removeClass("jstree-closed").addClass("jstree-open").children(".jstree-anchor").attr("aria-expanded",!0).end().children(".jstree-children").stop(!0,!0).slideDown(n,function(){this.style.display="",c.element&&c.trigger("after_open",{node:r})})):(this.trigger("before_open",{node:r}),s[0].className=s[0].className.replace("jstree-closed","jstree-open"),s[0].childNodes[1].setAttribute("aria-expanded",!0))),r.state.opened=!0,i&&i.call(this,r,!0),s.length||this.trigger("before_open",{node:r}),this.trigger("open_node",{node:r}),n&&s.length||this.trigger("after_open",{node:r}),!0):this.is_loading(r)?setTimeout(function(){this.open_node(r,i,n)}.bind(this),500):void this.load_node(r,function(e,t){return t?this.open_node(e,i,n):!!i&&i.call(this,e,!1)}):(i&&i.call(this,r,!1),!1))},_open_to:function(t){if(!(t=this.get_node(t))||t.id===e.jstree.root)return!1;for(var r,i,n=t.parents,r=0,i=n.length;r<i;r+=1)r!==e.jstree.root&&this.open_node(n[r],!1,0);return e("#"+t.id.replace(e.jstree.idregex,"\\$&"),this.element)},close_node:function(r,i){var n,a,o,s;if(e.vakata.is_array(r)){for(n=0,a=(r=r.slice()).length;n<a;n++)this.close_node(r[n],i);return!0}return!(!(r=this.get_node(r))||r.id===e.jstree.root)&&!this.is_closed(r)&&(i=i===t?this.settings.core.animation:i,s=(o=this).get_node(r,!0),r.state.opened=!1,this.trigger("close_node",{node:r}),void(s.length?i?s.children(".jstree-children").attr("style","display:block !important").end().removeClass("jstree-open").addClass("jstree-closed").children(".jstree-anchor").attr("aria-expanded",!1).end().children(".jstree-children").stop(!0,!0).slideUp(i,function(){this.style.display="",s.children(".jstree-children").remove(),o.element&&o.trigger("after_close",{node:r})}):(s[0].className=s[0].className.replace("jstree-open","jstree-closed"),s.children(".jstree-anchor").attr("aria-expanded",!1),s.children(".jstree-children").remove(),this.trigger("after_close",{node:r})):this.trigger("after_close",{node:r})))},toggle_node:function(t){var r,i;if(e.vakata.is_array(t)){for(r=0,i=(t=t.slice()).length;r<i;r++)this.toggle_node(t[r]);return!0}return this.is_closed(t)?this.open_node(t):this.is_open(t)?this.close_node(t):void 0},open_all:function(t,r,i){if(t=t||e.jstree.root,!(t=this.get_node(t)))return!1;var n,a,o,s=t.id===e.jstree.root?this.get_container_ul():this.get_node(t,!0);if(!s.length){for(n=0,a=t.children_d.length;n<a;n++)this.is_closed(this._model.data[t.children_d[n]])&&(this._model.data[t.children_d[n]].state.opened=!0);return this.trigger("open_all",{node:t})}i=i||s,(s=(o=this).is_closed(t)?s.find(".jstree-closed").addBack():s.find(".jstree-closed")).each(function(){o.open_node(this,function(e,t){t&&this.is_parent(e)&&this.open_all(e,r,i)},r||0)}),0===i.find(".jstree-closed").length&&this.trigger("open_all",{node:this.get_node(i)})},close_all:function(t,r){if(t=t||e.jstree.root,!(t=this.get_node(t)))return!1;var i,n,a=t.id===e.jstree.root?this.get_container_ul():this.get_node(t,!0),o=this;for(a.length&&(a=this.is_open(t)?a.find(".jstree-open").addBack():a.find(".jstree-open"),e(a.get().reverse()).each(function(){o.close_node(this,r||0)})),i=0,n=t.children_d.length;i<n;i++)this._model.data[t.children_d[i]].state.opened=!1;this.trigger("close_all",{node:t})},is_disabled:function(e){return(e=this.get_node(e))&&e.state&&e.state.disabled},enable_node:function(t){var r,i;if(e.vakata.is_array(t)){for(r=0,i=(t=t.slice()).length;r<i;r++)this.enable_node(t[r]);return!0}if(!(t=this.get_node(t))||t.id===e.jstree.root)return!1;t.state.disabled=!1,this.get_node(t,!0).children(".jstree-anchor").removeClass("jstree-disabled").attr("aria-disabled",!1),this.trigger("enable_node",{node:t})},disable_node:function(t){var r,i;if(e.vakata.is_array(t)){for(r=0,i=(t=t.slice()).length;r<i;r++)this.disable_node(t[r]);return!0}if(!(t=this.get_node(t))||t.id===e.jstree.root)return!1;t.state.disabled=!0,this.get_node(t,!0).children(".jstree-anchor").addClass("jstree-disabled").attr("aria-disabled",!0),this.trigger("disable_node",{node:t})},is_hidden:function(e){return!0===(e=this.get_node(e)).state.hidden},hide_node:function(t,r){var i,n;if(e.vakata.is_array(t)){for(i=0,n=(t=t.slice()).length;i<n;i++)this.hide_node(t[i],!0);return r||this.redraw(),!0}if(!(t=this.get_node(t))||t.id===e.jstree.root)return!1;t.state.hidden||(t.state.hidden=!0,this._node_changed(t.parent),r||this.redraw(),this.trigger("hide_node",{node:t}))},show_node:function(t,r){var i,n;if(e.vakata.is_array(t)){for(i=0,n=(t=t.slice()).length;i<n;i++)this.show_node(t[i],!0);return r||this.redraw(),!0}if(!(t=this.get_node(t))||t.id===e.jstree.root)return!1;t.state.hidden&&(t.state.hidden=!1,this._node_changed(t.parent),r||this.redraw(),this.trigger("show_node",{node:t}))},hide_all:function(t){var r,i=this._model.data,n=[];for(r in i)i.hasOwnProperty(r)&&r!==e.jstree.root&&!i[r].state.hidden&&(i[r].state.hidden=!0,n.push(r));return this._model.force_full_redraw=!0,t||this.redraw(),this.trigger("hide_all",{nodes:n}),n},show_all:function(t){var r,i=this._model.data,n=[];for(r in i)i.hasOwnProperty(r)&&r!==e.jstree.root&&i[r].state.hidden&&(i[r].state.hidden=!1,n.push(r));return this._model.force_full_redraw=!0,t||this.redraw(),this.trigger("show_all",{nodes:n}),n},activate_node:function(e,r){if(this.is_disabled(e))return!1;if(r&&"object"==typeof r||(r={}),this._data.core.last_clicked=this._data.core.last_clicked&&this._data.core.last_clicked.id!==t?this.get_node(this._data.core.last_clicked.id):null,this._data.core.last_clicked&&!this._data.core.last_clicked.state.selected&&(this._data.core.last_clicked=null),!this._data.core.last_clicked&&this._data.core.selected.length&&(this._data.core.last_clicked=this.get_node(this._data.core.selected[this._data.core.selected.length-1])),this.settings.core.multiple&&(r.metaKey||r.ctrlKey||r.shiftKey)&&(!r.shiftKey||this._data.core.last_clicked&&this.get_parent(e)&&this.get_parent(e)===this._data.core.last_clicked.parent))if(r.shiftKey){for(var i,n,a=this.get_node(e).id,o=this._data.core.last_clicked.id,s=this.get_node(this._data.core.last_clicked.parent).children,c=!1,i=0,n=s.length;i<n;i+=1)s[i]===a&&(c=!c),s[i]===o&&(c=!c),this.is_disabled(s[i])||!c&&s[i]!==a&&s[i]!==o?r.ctrlKey||this.deselect_node(s[i],!0,r):this.is_hidden(s[i])||this.select_node(s[i],!0,!1,r);this.trigger("changed",{action:"select_node",node:this.get_node(e),selected:this._data.core.selected,event:r})}else this.is_selected(e)?this.deselect_node(e,!1,r):(r.ctrlKey&&(this._data.core.last_clicked=this.get_node(e)),this.select_node(e,!1,!1,r));else!this.settings.core.multiple&&(r.metaKey||r.ctrlKey||r.shiftKey)&&this.is_selected(e)?this.deselect_node(e,!1,r):(!this.settings.core.allow_reselect&&this.is_selected(e)&&1===this._data.core.selected.length||(this.deselect_all(!0),this.select_node(e,!1,!1,r)),this._data.core.last_clicked=this.get_node(e));this.trigger("activate_node",{node:this.get_node(e),event:r})},hover_node:function(e){if(!(e=this.get_node(e,!0))||!e.length||e.children(".jstree-hovered").length)return!1;var t=this.element.find(".jstree-hovered"),r=this.element;t&&t.length&&this.dehover_node(t),e.children(".jstree-anchor").addClass("jstree-hovered"),this.trigger("hover_node",{node:this.get_node(e)}),setTimeout(function(){r.attr("aria-activedescendant",e[0].id)},0)},dehover_node:function(e){if(!(e=this.get_node(e,!0))||!e.length||!e.children(".jstree-hovered").length)return!1;e.children(".jstree-anchor").removeClass("jstree-hovered"),this.trigger("dehover_node",{node:this.get_node(e)})},select_node:function(t,r,i,n){var a,o,s;if(e.vakata.is_array(t)){for(o=0,s=(t=t.slice()).length;o<s;o++)this.select_node(t[o],r,i,n);return!0}if(!(t=this.get_node(t))||t.id===e.jstree.root)return!1;a=this.get_node(t,!0),t.state.selected||(t.state.selected=!0,this._data.core.selected.push(t.id),(a=i?a:this._open_to(t))&&a.length&&a.children(".jstree-anchor").addClass("jstree-clicked").attr("aria-selected",!0),this.trigger("select_node",{node:t,selected:this._data.core.selected,event:n}),r||this.trigger("changed",{action:"select_node",node:t,selected:this._data.core.selected,event:n}))},deselect_node:function(t,r,i){var n,a,o;if(e.vakata.is_array(t)){for(n=0,a=(t=t.slice()).length;n<a;n++)this.deselect_node(t[n],r,i);return!0}if(!(t=this.get_node(t))||t.id===e.jstree.root)return!1;o=this.get_node(t,!0),t.state.selected&&(t.state.selected=!1,this._data.core.selected=e.vakata.array_remove_item(this._data.core.selected,t.id),o.length&&o.children(".jstree-anchor").removeClass("jstree-clicked").attr("aria-selected",!1),this.trigger("deselect_node",{node:t,selected:this._data.core.selected,event:i}),r||this.trigger("changed",{action:"deselect_node",node:t,selected:this._data.core.selected,event:i}))},select_all:function(t){var r,i,n=this._data.core.selected.concat([]);for(this._data.core.selected=this._model.data[e.jstree.root].children_d.concat(),r=0,i=this._data.core.selected.length;r<i;r++)this._model.data[this._data.core.selected[r]]&&(this._model.data[this._data.core.selected[r]].state.selected=!0);this.redraw(!0),this.trigger("select_all",{selected:this._data.core.selected}),t||this.trigger("changed",{action:"select_all",selected:this._data.core.selected,old_selection:n})},deselect_all:function(e){for(var t,r,i=this._data.core.selected.concat([]),t=0,r=this._data.core.selected.length;t<r;t++)this._model.data[this._data.core.selected[t]]&&(this._model.data[this._data.core.selected[t]].state.selected=!1);this._data.core.selected=[],this.element.find(".jstree-clicked").removeClass("jstree-clicked").attr("aria-selected",!1),this.trigger("deselect_all",{selected:this._data.core.selected,node:i}),e||this.trigger("changed",{action:"deselect_all",selected:this._data.core.selected,old_selection:i})},is_selected:function(t){return!(!(t=this.get_node(t))||t.id===e.jstree.root)&&t.state.selected},get_selected:function(t){return t?e.map(this._data.core.selected,function(e){return this.get_node(e)}.bind(this)):this._data.core.selected.slice()},get_top_selected:function(t){for(var r,i,n,a,o=this.get_selected(!0),s={},r=0,i=o.length;r<i;r++)s[o[r].id]=o[r];for(r=0,i=o.length;r<i;r++)for(n=0,a=o[r].children_d.length;n<a;n++)s[o[r].children_d[n]]&&delete s[o[r].children_d[n]];for(r in o=[],s)s.hasOwnProperty(r)&&o.push(r);return t?e.map(o,function(e){return this.get_node(e)}.bind(this)):o},get_bottom_selected:function(t){for(var r,i,n=this.get_selected(!0),a=[],r=0,i=n.length;r<i;r++)n[r].children.length||a.push(n[r].id);return t?e.map(a,function(e){return this.get_node(e)}.bind(this)):a},get_state:function(){var t,r={core:{open:[],loaded:[],scroll:{left:this.element.scrollLeft(),top:this.element.scrollTop()},selected:[]}};for(t in this._model.data)this._model.data.hasOwnProperty(t)&&t!==e.jstree.root&&(this._model.data[t].state.loaded&&this.settings.core.loaded_state&&r.core.loaded.push(t),this._model.data[t].state.opened&&r.core.open.push(t),this._model.data[t].state.selected&&r.core.selected.push(t));return r},set_state:function(r,i){if(r){if(r.core&&r.core.selected&&r.core.initial_selection===t&&(r.core.initial_selection=this._data.core.selected.concat([]).sort().join(",")),r.core){var n,a;if(r.core.loaded)return this.settings.core.loaded_state&&e.vakata.is_array(r.core.loaded)&&r.core.loaded.length?this._load_nodes(r.core.loaded,function(e){delete r.core.loaded,this.set_state(r,i)}):(delete r.core.loaded,this.set_state(r,i)),!1;if(r.core.open)return e.vakata.is_array(r.core.open)&&r.core.open.length?this._load_nodes(r.core.open,function(e){this.open_node(e,!1,0),delete r.core.open,this.set_state(r,i)}):(delete r.core.open,this.set_state(r,i)),!1;if(r.core.scroll)return r.core.scroll&&r.core.scroll.left!==t&&this.element.scrollLeft(r.core.scroll.left),r.core.scroll&&r.core.scroll.top!==t&&this.element.scrollTop(r.core.scroll.top),delete r.core.scroll,this.set_state(r,i),!1;if(r.core.selected)return n=this,r.core.initial_selection!==t&&r.core.initial_selection!==this._data.core.selected.concat([]).sort().join(",")||(this.deselect_all(),e.each(r.core.selected,function(e,t){n.select_node(t,!1,!0)})),delete r.core.initial_selection,delete r.core.selected,this.set_state(r,i),!1;for(a in r)r.hasOwnProperty(a)&&"core"!==a&&-1===e.inArray(a,this.settings.plugins)&&delete r[a];if(e.isEmptyObject(r.core))return delete r.core,this.set_state(r,i),!1}return!e.isEmptyObject(r)||(r=null,i&&i.call(this),this.trigger("set_state"),!1)}return!1},refresh:function(t,r){this._data.core.state=!0===r?{}:this.get_state(),r&&e.vakata.is_function(r)&&(this._data.core.state=r.call(this,this._data.core.state)),this._cnt=0,this._model.data={},this._model.data[e.jstree.root]={id:e.jstree.root,parent:null,parents:[],children:[],children_d:[],state:{loaded:!1}},this._data.core.selected=[],this._data.core.last_clicked=null,this._data.core.focused=null;var i=this.get_container_ul()[0].className;t||(this.element.html("<ul class='"+i+"' role='group'><li class='jstree-initial-node jstree-loading jstree-leaf jstree-last' role='none' id='j"+this._id+"_loading'><i class='jstree-icon jstree-ocl'></i><a class='jstree-anchor' role='treeitem' href='#'><i class='jstree-icon jstree-themeicon-hidden'></i>"+this.get_string("Loading ...")+"</a></li></ul>"),this.element.attr("aria-activedescendant","j"+this._id+"_loading")),this.load_node(e.jstree.root,function(t,r){r&&(this.get_container_ul()[0].className=i,this._firstChild(this.get_container_ul()[0])&&this.element.attr("aria-activedescendant",this._firstChild(this.get_container_ul()[0]).id),this.set_state(e.extend(!0,{},this._data.core.state),function(){this.trigger("refresh")})),this._data.core.state=null})},refresh_node:function(t){if(!(t=this.get_node(t))||t.id===e.jstree.root)return!1;var r=[],i=[],n=this._data.core.selected.concat([]);i.push(t.id),!0===t.state.opened&&r.push(t.id),this.get_node(t,!0).find(".jstree-open").each(function(){i.push(this.id),r.push(this.id)}),this._load_nodes(i,function(e){this.open_node(r,!1,0),this.select_node(n),this.trigger("refresh_node",{node:t,nodes:e})}.bind(this),!1,!0)},set_id:function(t,r){if(!(t=this.get_node(t))||t.id===e.jstree.root)return!1;var i,n,a=this._model.data,o=t.id;for(r=r.toString(),a[t.parent].children[e.inArray(t.id,a[t.parent].children)]=r,i=0,n=t.parents.length;i<n;i++)a[t.parents[i]].children_d[e.inArray(t.id,a[t.parents[i]].children_d)]=r;for(i=0,n=t.children.length;i<n;i++)a[t.children[i]].parent=r;for(i=0,n=t.children_d.length;i<n;i++)a[t.children_d[i]].parents[e.inArray(t.id,a[t.children_d[i]].parents)]=r;return-1!==(i=e.inArray(t.id,this._data.core.selected))&&(this._data.core.selected[i]=r),(i=this.get_node(t.id,!0))&&(i.attr("id",r),this.element.attr("aria-activedescendant")===t.id&&this.element.attr("aria-activedescendant",r)),delete a[t.id],t.id=r,a[t.li_attr.id=r]=t,this.trigger("set_id",{node:t,new:t.id,old:o}),!0},get_text:function(t){return!(!(t=this.get_node(t))||t.id===e.jstree.root)&&t.text},set_text:function(t,r){var i,n;if(e.vakata.is_array(t)){for(i=0,n=(t=t.slice()).length;i<n;i++)this.set_text(t[i],r);return!0}return!(!(t=this.get_node(t))||t.id===e.jstree.root||(t.text=r,this.get_node(t,!0).length&&this.redraw_node(t.id),this.trigger("set_text",{obj:t,text:r}),0))},get_json:function(t,r,i){if(!(t=this.get_node(t||e.jstree.root)))return!1;r&&r.flat&&!i&&(i=[]);var n,a,o={id:t.id,text:t.text,icon:this.get_icon(t),li_attr:e.extend(!0,{},t.li_attr),a_attr:e.extend(!0,{},t.a_attr),state:{},data:(!r||!r.no_data)&&e.extend(!0,e.vakata.is_array(t.data)?[]:{},t.data)};if(r&&r.flat?o.parent=t.parent:o.children=[],r&&r.no_state)delete o.state;else for(n in t.state)t.state.hasOwnProperty(n)&&(o.state[n]=t.state[n]);if(r&&r.no_li_attr&&delete o.li_attr,r&&r.no_a_attr&&delete o.a_attr,r&&r.no_id&&(delete o.id,o.li_attr&&o.li_attr.id&&delete o.li_attr.id,o.a_attr&&o.a_attr.id&&delete o.a_attr.id),r&&r.flat&&t.id!==e.jstree.root&&i.push(o),!r||!r.no_children)for(n=0,a=t.children.length;n<a;n++)r&&r.flat?this.get_json(t.children[n],r,i):o.children.push(this.get_json(t.children[n],r));return r&&r.flat?i:t.id===e.jstree.root?o.children:o},create_node:function(r,i,n,a,o){if(null===r&&(r=e.jstree.root),!(r=this.get_node(r)))return!1;if(!(n=n===t?"last":n).toString().match(/^(before|after)$/)&&!o&&!this.is_loaded(r))return this.load_node(r,function(){this.create_node(r,i,n,a,!0)});var s,c,d,l;switch((i="string"==typeof(i=i||{text:this.get_string("New node")})?{text:i}:e.extend(!0,{},i)).text===t&&(i.text=this.get_string("New node")),n=r.id===e.jstree.root&&"after"===(n="before"===n?"first":n)?"last":n){case"before":s=this.get_node(r.parent),n=e.inArray(r.id,s.children),r=s;break;case"after":s=this.get_node(r.parent),n=e.inArray(r.id,s.children)+1,r=s;break;case"inside":case"first":n=0;break;case"last":n=r.children.length;break;default:n=n||0}if(n>r.children.length&&(n=r.children.length),i.id===t&&(i.id=!0),!this.check("create_node",i,r,n))return this.settings.core.error.call(this,this._data.core.last_error),!1;if(!0===i.id&&delete i.id,!(i=this._parse_model_from_json(i,r.id,r.parents.concat())))return!1;for(s=this.get_node(i),(c=[]).push(i),c=c.concat(s.children_d),this.trigger("model",{nodes:c,parent:r.id}),r.children_d=r.children_d.concat(c),d=0,l=r.parents.length;d<l;d++)this._model.data[r.parents[d]].children_d=this._model.data[r.parents[d]].children_d.concat(c);for(i=s,s=[],d=0,l=r.children.length;d<l;d++)s[n<=d?d+1:d]=r.children[d];return s[n]=i.id,r.children=s,this.redraw_node(r,!0),this.trigger("create_node",{node:this.get_node(i),parent:r.id,position:n}),a&&a.call(this,this.get_node(i)),i.id},rename_node:function(t,r){var i,n,a;if(e.vakata.is_array(t)){for(i=0,n=(t=t.slice()).length;i<n;i++)this.rename_node(t[i],r);return!0}return!(!(t=this.get_node(t))||t.id===e.jstree.root||(a=t.text,this.check("rename_node",t,this.get_parent(t),r)?(this.set_text(t,r),this.trigger("rename_node",{node:t,text:r,old:a}),0):(this.settings.core.error.call(this,this._data.core.last_error),1)))},delete_node:function(t){var r,i,n,a,o,s,c,d,l,h,u,a;if(e.vakata.is_array(t)){for(r=0,i=(t=t.slice()).length;r<i;r++)this.delete_node(t[r]);return!0}if(!(t=this.get_node(t))||t.id===e.jstree.root)return!1;if(n=this.get_node(t.parent),a=e.inArray(t.id,n.children),h=!1,!this.check("delete_node",t,n,a))return this.settings.core.error.call(this,this._data.core.last_error),!1;for(-1!==a&&(n.children=e.vakata.array_remove(n.children,a)),(o=t.children_d.concat([])).push(t.id),s=0,c=t.parents.length;s<c;s++)this._model.data[t.parents[s]].children_d=e.vakata.array_filter(this._model.data[t.parents[s]].children_d,function(t){return-1===e.inArray(t,o)});for(d=0,l=o.length;d<l;d++)if(this._model.data[o[d]].state.selected){h=!0;break}for(h&&(this._data.core.selected=e.vakata.array_filter(this._data.core.selected,function(t){return-1===e.inArray(t,o)})),this.trigger("delete_node",{node:t,parent:n.id}),h&&this.trigger("changed",{action:"delete_node",node:t,selected:this._data.core.selected,parent:n.id}),d=0,l=o.length;d<l;d++)delete this._model.data[o[d]];return-1!==e.inArray(this._data.core.focused,o)&&(this._data.core.focused=null,u=this.element[0].scrollTop,a=this.element[0].scrollLeft,n.id===e.jstree.root?this._model.data[e.jstree.root].children[0]&&this.get_node(this._model.data[e.jstree.root].children[0],!0).children(".jstree-anchor").trigger("focus"):this.get_node(n,!0).children(".jstree-anchor").trigger("focus"),this.element[0].scrollTop=u,this.element[0].scrollLeft=a),this.redraw_node(n,!0),!0},check:function(t,r,i,n,a){r=r&&r.id?r:this.get_node(r),i=i&&i.id?i:this.get_node(i);var o=t.match(/^(move_node|copy_node|create_node)$/i)?i:r,s=this.settings.core.check_callback;if("move_node"===t||"copy_node"===t){if(!(a&&a.is_multi||"move_node"!==t||e.inArray(r.id,i.children)!==n))return!(this._data.core.last_error={error:"check",plugin:"core",id:"core_08",reason:"Moving node to its current position",data:JSON.stringify({chk:t,pos:n,obj:!(!r||!r.id)&&r.id,par:!(!i||!i.id)&&i.id})});if(!(a&&a.is_multi||r.id!==i.id&&("move_node"!==t||e.inArray(r.id,i.children)!==n)&&-1===e.inArray(i.id,r.children_d)))return!(this._data.core.last_error={error:"check",plugin:"core",id:"core_01",reason:"Moving parent inside child",data:JSON.stringify({chk:t,pos:n,obj:!(!r||!r.id)&&r.id,par:!(!i||!i.id)&&i.id})})}return(o=o&&o.data?o.data:o)&&o.functions&&(!1===o.functions[t]||!0===o.functions[t])?(!1===o.functions[t]&&(this._data.core.last_error={error:"check",plugin:"core",id:"core_02",reason:"Node data prevents function: "+t,data:JSON.stringify({chk:t,pos:n,obj:!(!r||!r.id)&&r.id,par:!(!i||!i.id)&&i.id})}),o.functions[t]):!(!1===s||e.vakata.is_function(s)&&!1===s.call(this,t,r,i,n,a)||s&&!1===s[t])||!(this._data.core.last_error={error:"check",plugin:"core",id:"core_03",reason:"User config for core.check_callback prevents function: "+t,data:JSON.stringify({chk:t,pos:n,obj:!(!r||!r.id)&&r.id,par:!(!i||!i.id)&&i.id})})},last_error:function(){return this._data.core.last_error},move_node:function(r,i,n,a,o,s,c){var d,l,h,u,f,p,_,g,m,y,v,b,j,k;if(i=this.get_node(i),n=n===t?0:n,!i)return!1;if(!n.toString().match(/^(before|after)$/)&&!o&&!this.is_loaded(i))return this.load_node(i,function(){this.move_node(r,i,n,a,!0,!1,c)});if(e.vakata.is_array(r)){if(1!==r.length){for(d=0,l=r.length;d<l;d++)(m=this.move_node(r[d],i,n,a,o,!1,c))&&(i=m,n="after");return this.redraw(),!0}r=r[0]}if(!(r=r&&r.id!==t?r:this.get_node(r))||r.id===e.jstree.root)return!1;if(h=(r.parent||e.jstree.root).toString(),f=n.toString().match(/^(before|after)$/)&&i.id!==e.jstree.root?this.get_node(i.parent):i,_=!(p=c||(this._model.data[r.id]?this:e.jstree.reference(r.id)))||!p._id||this._id!==p._id,u=p&&p._id&&h&&p._model.data[h]&&p._model.data[h].children?e.inArray(r.id,p._model.data[h].children):-1,p&&p._id&&(r=p._model.data[r.id]),_)return!!(m=this.copy_node(r,i,n,a,o,!1,c))&&(p&&p.delete_node(r),m);switch(n=i.id===e.jstree.root&&"after"===(n="before"===n?"first":n)?"last":n){case"before":n=e.inArray(i.id,f.children);break;case"after":n=e.inArray(i.id,f.children)+1;break;case"inside":case"first":n=0;break;case"last":n=f.children.length;break;default:n=n||0}if(n>f.children.length&&(n=f.children.length),!this.check("move_node",r,f,n,{core:!0,origin:c,is_multi:p&&p._id&&p._id!==this._id,is_foreign:!p||!p._id}))return this.settings.core.error.call(this,this._data.core.last_error),!1;if(r.parent===f.id){for(g=f.children.concat(),-1!==(m=e.inArray(r.id,g))&&(g=e.vakata.array_remove(g,m),m<n&&n--),m=[],y=0,v=g.length;y<v;y++)m[n<=y?y+1:y]=g[y];m[n]=r.id,f.children=m,this._node_changed(f.id),this.redraw(f.id===e.jstree.root)}else{for((m=r.children_d.concat()).push(r.id),y=0,v=r.parents.length;y<v;y++){for(g=[],b=0,j=(k=p._model.data[r.parents[y]].children_d).length;b<j;b++)-1===e.inArray(k[b],m)&&g.push(k[b]);p._model.data[r.parents[y]].children_d=g}for(p._model.data[h].children=e.vakata.array_remove_item(p._model.data[h].children,r.id),y=0,v=f.parents.length;y<v;y++)this._model.data[f.parents[y]].children_d=this._model.data[f.parents[y]].children_d.concat(m);for(g=[],y=0,v=f.children.length;y<v;y++)g[n<=y?y+1:y]=f.children[y];for(g[n]=r.id,f.children=g,f.children_d.push(r.id),f.children_d=f.children_d.concat(r.children_d),r.parent=f.id,(m=f.parents.concat()).unshift(f.id),k=r.parents.length,m=(r.parents=m).concat(),y=0,v=r.children_d.length;y<v;y++)this._model.data[r.children_d[y]].parents=this._model.data[r.children_d[y]].parents.slice(0,-1*k),Array.prototype.push.apply(this._model.data[r.children_d[y]].parents,m);h!==e.jstree.root&&f.id!==e.jstree.root||(this._model.force_full_redraw=!0),this._model.force_full_redraw||(this._node_changed(h),this._node_changed(f.id)),s||this.redraw()}return a&&a.call(this,r,f,n),this.trigger("move_node",{node:r,parent:f.id,position:n,old_parent:h,old_position:u,is_multi:p&&p._id&&p._id!==this._id,is_foreign:!p||!p._id,old_instance:p,new_instance:this}),r.id},copy_node:function(r,i,n,a,o,s,c){var d,l,h,u,f,p,_,g,m,y;if(i=this.get_node(i),n=n===t?0:n,!i)return!1;if(!n.toString().match(/^(before|after)$/)&&!o&&!this.is_loaded(i))return this.load_node(i,function(){this.copy_node(r,i,n,a,!0,!1,c)});if(e.vakata.is_array(r)){if(1!==r.length){for(d=0,l=r.length;d<l;d++)(u=this.copy_node(r[d],i,n,a,o,!0,c))&&(i=u,n="after");return this.redraw(),!0}r=r[0]}if(!(r=r&&r.id!==t?r:this.get_node(r))||r.id===e.jstree.root)return!1;switch(g=(r.parent||e.jstree.root).toString(),m=n.toString().match(/^(before|after)$/)&&i.id!==e.jstree.root?this.get_node(i.parent):i,!(y=c||(this._model.data[r.id]?this:e.jstree.reference(r.id)))||!y._id||this._id!==y._id,y&&y._id&&(r=y._model.data[r.id]),n=i.id===e.jstree.root&&"after"===(n="before"===n?"first":n)?"last":n){case"before":n=e.inArray(i.id,m.children);break;case"after":n=e.inArray(i.id,m.children)+1;break;case"inside":case"first":n=0;break;case"last":n=m.children.length;break;default:n=n||0}if(n>m.children.length&&(n=m.children.length),!this.check("copy_node",r,m,n,{core:!0,origin:c,is_multi:y&&y._id&&y._id!==this._id,is_foreign:!y||!y._id}))return this.settings.core.error.call(this,this._data.core.last_error),!1;if(!(_=y?y.get_json(r,{no_id:!0,no_data:!0,no_state:!0}):r))return!1;if(!0===_.id&&delete _.id,!(_=this._parse_model_from_json(_,m.id,m.parents.concat())))return!1;for(u=this.get_node(_),r&&r.state&&!1===r.state.loaded&&(u.state.loaded=!1),(h=[]).push(_),h=h.concat(u.children_d),this.trigger("model",{nodes:h,parent:m.id}),f=0,p=m.parents.length;f<p;f++)this._model.data[m.parents[f]].children_d=this._model.data[m.parents[f]].children_d.concat(h);for(h=[],f=0,p=m.children.length;f<p;f++)h[n<=f?f+1:f]=m.children[f];return h[n]=u.id,m.children=h,m.children_d.push(u.id),m.children_d=m.children_d.concat(u.children_d),m.id===e.jstree.root&&(this._model.force_full_redraw=!0),this._model.force_full_redraw||this._node_changed(m.id),s||this.redraw(m.id===e.jstree.root),a&&a.call(this,u,m,n),this.trigger("copy_node",{node:u,original:r,parent:m.id,position:n,old_parent:g,old_position:y&&y._id&&g&&y._model.data[g]&&y._model.data[g].children?e.inArray(r.id,y._model.data[g].children):-1,is_multi:y&&y._id&&y._id!==this._id,is_foreign:!y||!y._id,old_instance:y,new_instance:this}),u.id},cut:function(t){if(t=t||this._data.core.selected.concat(),!(t=e.vakata.is_array(t)?t:[t]).length)return!1;for(var r,o,s,c=[],o=0,s=t.length;o<s;o++)(r=this.get_node(t[o]))&&(r.id||0===r.id)&&r.id!==e.jstree.root&&c.push(r);if(!c.length)return!1;i=c,n="move_node",(a=this).trigger("cut",{node:t})},copy:function(r){if(r=r||this._data.core.selected.concat(),!(r=e.vakata.is_array(r)?r:[r]).length)return!1;for(var o,s,c,d=[],s=0,c=r.length;s<c;s++)(o=this.get_node(r[s]))&&o.id!==t&&o.id!==e.jstree.root&&d.push(o);if(!d.length)return!1;i=d,n="copy_node",(a=this).trigger("copy",{node:r})},get_buffer:function(){return{mode:n,node:i,inst:a}},can_paste:function(){return!1!==n&&!1!==i},paste:function(e,t){if(!((e=this.get_node(e))&&n&&n.match(/^(copy_node|move_node)$/)&&i))return!1;this[n](i,e,t,!1,!1,!1,a)&&this.trigger("paste",{parent:e.id,node:i,mode:n}),a=n=i=!1},clear_buffer:function(){a=n=i=!1,this.trigger("clear_buffer")},edit:function(t,r,i){var n,a,o,s,d,l,h,n,u,f=!1;return!!(t=this.get_node(t))&&(this.check("edit",t,this.get_parent(t))?(u=t,r="string"==typeof r?r:t.text,this.set_text(t,""),t=this._open_to(t),u.text=r,n=this._data.core.rtl,a=this.element.width(),this._data.core.focused=u.id,o=t.children(".jstree-anchor").trigger("focus"),s=e("<span></span>"),d=r,l=e("<div></div>",{css:{position:"absolute",top:"-200px",left:n?"0px":"-1000px",visibility:"hidden"}}).appendTo(c.body),h=e("<input />",{value:d,class:"jstree-rename-input",css:{padding:"0",border:"1px solid silver","box-sizing":"border-box",display:"inline-block",height:this._data.core.li_height+"px",lineHeight:this._data.core.li_height+"px",width:"150px"},on:{blur:function(r){r.stopImmediatePropagation(),r.preventDefault();var r,n=s.children(".jstree-rename-input").val(),r=this.settings.core.force_text;""===n&&(n=d),l.remove(),s.replaceWith(o),s.remove(),d=r?d:e("<div></div>").append(e.parseHTML(d)).html(),t=this.get_node(t),this.set_text(t,d),(r=!!this.rename_node(t,r?e("<div></div>").text(n).text():e("<div></div>").append(e.parseHTML(n)).html()))||this.set_text(t,d),this._data.core.focused=u.id,setTimeout(function(){var e=this.get_node(u.id,!0);e.length&&(this._data.core.focused=u.id,e.children(".jstree-anchor").trigger("focus"))}.bind(this),0),i&&i.call(this,u,r,f,n),h=null}.bind(this),keydown:function(e){var t=e.which;27===t&&(f=!0,this.value=d),27!==t&&13!==t&&37!==t&&38!==t&&39!==t&&40!==t&&32!==t||e.stopImmediatePropagation(),27!==t&&13!==t||(e.preventDefault(),this.blur())},click:function(e){e.stopImmediatePropagation()},mousedown:function(e){e.stopImmediatePropagation()},keyup:function(e){h.width(Math.min(l.text("pW"+this.value).width(),a))},keypress:function(e){if(13===e.which)return!1}}}),n={fontFamily:o.css("fontFamily")||"",fontSize:o.css("fontSize")||"",fontWeight:o.css("fontWeight")||"",fontStyle:o.css("fontStyle")||"",fontStretch:o.css("fontStretch")||"",fontVariant:o.css("fontVariant")||"",letterSpacing:o.css("letterSpacing")||"",wordSpacing:o.css("wordSpacing")||""},s.attr("class",o.attr("class")).append(o.contents().clone()).append(h),o.replaceWith(s),l.css(n),h.css(n).width(Math.min(l.text("pW"+h[0].value).width(),a))[0].select(),void e(c).one("mousedown.jstree touchstart.jstree dnd_start.vakata",function(t){h&&t.target!==h&&e(h).trigger("blur")})):(this.settings.core.error.call(this,this._data.core.last_error),!1))},set_theme:function(t,r){if(!t)return!1;(r=!0===r?(this.settings.core.themes.dir||e.jstree.path+"/themes")+"/"+t+"/style.css":r)&&-1===e.inArray(r,o)&&(e("head").append('<link rel="stylesheet" href="'+r+'" type="text/css" />'),o.push(r)),this._data.core.themes.name&&this.element.removeClass("jstree-"+this._data.core.themes.name),this._data.core.themes.name=t,this.element.addClass("jstree-"+t),this.element[this.settings.core.themes.responsive?"addClass":"removeClass"]("jstree-"+t+"-responsive"),this.trigger("set_theme",{theme:t})},get_theme:function(){return this._data.core.themes.name},set_theme_variant:function(e){this._data.core.themes.variant&&this.element.removeClass("jstree-"+this._data.core.themes.name+"-"+this._data.core.themes.variant),(this._data.core.themes.variant=e)&&this.element.addClass("jstree-"+this._data.core.themes.name+"-"+this._data.core.themes.variant)},get_theme_variant:function(){return this._data.core.themes.variant},show_stripes:function(){this._data.core.themes.stripes=!0,this.get_container_ul().addClass("jstree-striped"),this.trigger("show_stripes")},hide_stripes:function(){this._data.core.themes.stripes=!1,this.get_container_ul().removeClass("jstree-striped"),this.trigger("hide_stripes")},toggle_stripes:function(){this._data.core.themes.stripes?this.hide_stripes():this.show_stripes()},show_dots:function(){this._data.core.themes.dots=!0,this.get_container_ul().removeClass("jstree-no-dots"),this.trigger("show_dots")},hide_dots:function(){this._data.core.themes.dots=!1,this.get_container_ul().addClass("jstree-no-dots"),this.trigger("hide_dots")},toggle_dots:function(){this._data.core.themes.dots?this.hide_dots():this.show_dots()},show_icons:function(){this._data.core.themes.icons=!0,this.get_container_ul().removeClass("jstree-no-icons"),this.trigger("show_icons")},hide_icons:function(){this._data.core.themes.icons=!1,this.get_container_ul().addClass("jstree-no-icons"),this.trigger("hide_icons")},toggle_icons:function(){this._data.core.themes.icons?this.hide_icons():this.show_icons()},show_ellipsis:function(){this._data.core.themes.ellipsis=!0,this.get_container_ul().addClass("jstree-ellipsis"),this.trigger("show_ellipsis")},hide_ellipsis:function(){this._data.core.themes.ellipsis=!1,this.get_container_ul().removeClass("jstree-ellipsis"),this.trigger("hide_ellipsis")},toggle_ellipsis:function(){this._data.core.themes.ellipsis?this.hide_ellipsis():this.show_ellipsis()},set_icon:function(r,i){var n,a,o,s;if(e.vakata.is_array(r)){for(n=0,a=(r=r.slice()).length;n<a;n++)this.set_icon(r[n],i);return!0}return!(!(r=this.get_node(r))||r.id===e.jstree.root||(s=r.icon,r.icon=!0===i||null===i||i===t||""===i||i,o=this.get_node(r,!0).children(".jstree-anchor").children(".jstree-themeicon"),!1===i?(o.removeClass("jstree-themeicon-custom "+s).css("background","").removeAttr("rel"),this.hide_icon(r)):(!0===i||null===i||i===t||""===i?o.removeClass("jstree-themeicon-custom "+s).css("background","").removeAttr("rel"):-1===i.indexOf("/")&&-1===i.indexOf(".")?(o.removeClass(s).css("background",""),o.addClass(i+" jstree-themeicon-custom").attr("rel",i)):(o.removeClass(s).css("background",""),o.addClass("jstree-themeicon-custom").css("background","url('"+i+"') center center no-repeat").attr("rel",i)),!1===s&&this.show_icon(r)),0))},get_icon:function(t){return!(!(t=this.get_node(t))||t.id===e.jstree.root)&&t.icon},hide_icon:function(t){var r,i;if(e.vakata.is_array(t)){for(r=0,i=(t=t.slice()).length;r<i;r++)this.hide_icon(t[r]);return!0}return!(!(t=this.get_node(t))||t===e.jstree.root||(t.icon=!1,this.get_node(t,!0).children(".jstree-anchor").children(".jstree-themeicon").addClass("jstree-themeicon-hidden"),0))},show_icon:function(t){var r,i,n;if(e.vakata.is_array(t)){for(r=0,i=(t=t.slice()).length;r<i;r++)this.show_icon(t[r]);return!0}return!(!(t=this.get_node(t))||t===e.jstree.root||(n=this.get_node(t,!0),t.icon=!n.length||n.children(".jstree-anchor").children(".jstree-themeicon").attr("rel"),t.icon||(t.icon=!0),n.children(".jstree-anchor").children(".jstree-themeicon").removeClass("jstree-themeicon-hidden"),0))}},e.vakata={},e.vakata.attributes=function(t,r){t=e(t)[0];var i=r?{}:[];return t&&t.attributes&&e.each(t.attributes,function(t,n){-1===e.inArray(n.name.toLowerCase(),["style","contenteditable","hasfocus","tabindex"])&&null!==n.value&&""!==e.vakata.trim(n.value)&&(r?i[n.name]=n.value:i.push(n.name))}),i},e.vakata.array_unique=function(e){for(var r,i,n=[],a={},r=0,i=e.length;r<i;r++)a[e[r]]===t&&(n.push(e[r]),a[e[r]]=!0);return n},e.vakata.array_remove=function(e,t){return e.splice(t,1),e},e.vakata.array_remove_item=function(t,r){var r=e.inArray(r,t);return-1!==r?e.vakata.array_remove(t,r):t},e.vakata.array_filter=function(e,t,r,i,n){if(e.filter)return e.filter(t,r);for(n in i=[],e)~~n+""==n+""&&0<=n&&t.call(r,e[n],+n,e)&&i.push(e[n]);return i},e.vakata.trim=function(e){return String.prototype.trim?String.prototype.trim.call(e.toString()):e.toString().replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")},e.vakata.is_function=function(e){return"function"==typeof e&&"number"!=typeof e.nodeType},e.vakata.is_array=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},Function.prototype.bind||(Function.prototype.bind=function(){var e=this,t=arguments[0],r=Array.prototype.slice.call(arguments,1);if("function"!=typeof e)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");return function(){var i=r.concat(Array.prototype.slice.call(arguments));return e.apply(t,i)}}),e.jstree.plugins.changed=function(e,t){var r=[];this.trigger=function(e,i){var n,a;if(i=i||{},"changed"===e.replace(".jstree","")){i.changed={selected:[],deselected:[]};for(var o={},n=0,a=r.length;n<a;n++)o[r[n]]=1;for(n=0,a=i.selected.length;n<a;n++)o[i.selected[n]]?o[i.selected[n]]=2:i.changed.selected.push(i.selected[n]);for(n=0,a=r.length;n<a;n++)1===o[r[n]]&&i.changed.deselected.push(r[n]);r=i.selected.slice()}t.trigger.call(this,e,i)},this.refresh=function(e,i){return r=[],t.refresh.apply(this,arguments)}};var h,u,f,p,_,g,m,y,v=c.createElement("I");v.className="jstree-icon jstree-checkbox",v.setAttribute("role","presentation"),e.jstree.defaults.checkbox={visible:!0,three_state:!0,whole_node:!0,keep_selected_style:!0,cascade:"",tie_selection:!0,cascade_to_disabled:!0,cascade_to_hidden:!0},e.jstree.plugins.checkbox=function(r,i){this.bind=function(){i.bind.call(this),this._data.checkbox.uto=!1,this._data.checkbox.selected=[],this.settings.checkbox.three_state&&(this.settings.checkbox.cascade="up+down+undetermined"),this.element.on("init.jstree",function(){this._data.checkbox.visible=this.settings.checkbox.visible,this.settings.checkbox.keep_selected_style||this.element.addClass("jstree-checkbox-no-clicked"),this.settings.checkbox.tie_selection&&this.element.addClass("jstree-checkbox-selection")}.bind(this)).on("loading.jstree",function(){this[this._data.checkbox.visible?"show_checkboxes":"hide_checkboxes"]()}.bind(this)),-1!==this.settings.checkbox.cascade.indexOf("undetermined")&&this.element.on("changed.jstree uncheck_node.jstree check_node.jstree uncheck_all.jstree check_all.jstree move_node.jstree copy_node.jstree redraw.jstree open_node.jstree",function(){this._data.checkbox.uto&&clearTimeout(this._data.checkbox.uto),this._data.checkbox.uto=setTimeout(this._undetermined.bind(this),50)}.bind(this)),this.settings.checkbox.tie_selection||this.element.on("model.jstree",function(e,t){for(var r,i,n=this._model.data,a=(n[t.parent],t.nodes),r=0,i=a.length;r<i;r++)n[a[r]].state.checked=n[a[r]].state.checked||n[a[r]].original&&n[a[r]].original.state&&n[a[r]].original.state.checked,n[a[r]].state.checked&&this._data.checkbox.selected.push(a[r])}.bind(this)),-1===this.settings.checkbox.cascade.indexOf("up")&&-1===this.settings.checkbox.cascade.indexOf("down")||this.element.on("model.jstree",function(t,r){var i,n,a,o,s,c,d=this._model.data,l=d[r.parent],h=r.nodes,u=[],r=this.settings.checkbox.cascade,f=this.settings.checkbox.tie_selection;if(-1!==r.indexOf("down"))if(l.state[f?"selected":"checked"]){for(n=0,a=h.length;n<a;n++)d[h[n]].state[f?"selected":"checked"]=!0;this._data[f?"core":"checkbox"].selected=this._data[f?"core":"checkbox"].selected.concat(h)}else for(n=0,a=h.length;n<a;n++)if(d[h[n]].state[f?"selected":"checked"]){for(o=0,s=d[h[n]].children_d.length;o<s;o++)d[d[h[n]].children_d[o]].state[f?"selected":"checked"]=!0;this._data[f?"core":"checkbox"].selected=this._data[f?"core":"checkbox"].selected.concat(d[h[n]].children_d)}if(-1!==r.indexOf("up")){for(n=0,a=l.children_d.length;n<a;n++)d[l.children_d[n]].children.length||u.push(d[l.children_d[n]].parent);for(o=0,s=(u=e.vakata.array_unique(u)).length;o<s;o++)for(l=d[u[o]];l&&l.id!==e.jstree.root;){for(n=i=0,a=l.children.length;n<a;n++)i+=d[l.children[n]].state[f?"selected":"checked"];if(i!==a)break;l.state[f?"selected":"checked"]=!0,this._data[f?"core":"checkbox"].selected.push(l.id),(c=this.get_node(l,!0))&&c.length&&c.children(".jstree-anchor").attr("aria-selected",!0).addClass(f?"jstree-clicked":"jstree-checked"),l=this.get_node(l.parent)}}this._data[f?"core":"checkbox"].selected=e.vakata.array_unique(this._data[f?"core":"checkbox"].selected)}.bind(this)).on(this.settings.checkbox.tie_selection?"select_node.jstree":"check_node.jstree",function(t,r){var i,n,a,o,s=r.node,c=this._model.data,d=this.get_node(s.parent),r=this.settings.checkbox.cascade,l=this.settings.checkbox.tie_selection,h={},u=this._data[l?"core":"checkbox"].selected;for(i=0,n=u.length;i<n;i++)h[u[i]]=!0;if(-1!==r.indexOf("down"))for(var f=this._cascade_new_checked_state(s.id,!0),p=s.children_d.concat(s.id),i=0,n=p.length;i<n;i++)-1<f.indexOf(p[i])?h[p[i]]=!0:delete h[p[i]];if(-1!==r.indexOf("up"))for(;d&&d.id!==e.jstree.root;){for(i=a=0,n=d.children.length;i<n;i++)a+=c[d.children[i]].state[l?"selected":"checked"];if(a!==n)break;d.state[l?"selected":"checked"]=!0,h[d.id]=!0,(o=this.get_node(d,!0))&&o.length&&o.children(".jstree-anchor").attr("aria-selected",!0).addClass(l?"jstree-clicked":"jstree-checked"),d=this.get_node(d.parent)}for(i in u=[],h)h.hasOwnProperty(i)&&u.push(i);this._data[l?"core":"checkbox"].selected=u}.bind(this)).on(this.settings.checkbox.tie_selection?"deselect_all.jstree":"uncheck_all.jstree",function(t,r){for(var i,n,a,o=this.get_node(e.jstree.root),s=this._model.data,i=0,n=o.children_d.length;i<n;i++)(a=s[o.children_d[i]])&&a.original&&a.original.state&&a.original.state.undetermined&&(a.original.state.undetermined=!1)}.bind(this)).on(this.settings.checkbox.tie_selection?"deselect_node.jstree":"uncheck_node.jstree",function(t,r){var i,n,a,o,r,s=r.node,c=(this.get_node(s,!0),this.settings.checkbox.cascade),d=this.settings.checkbox.tie_selection,r=this._data[d?"core":"checkbox"].selected,l=s.children_d.concat(s.id);if(-1!==c.indexOf("down")&&(o=this._cascade_new_checked_state(s.id,!1),r=e.vakata.array_filter(r,function(e){return-1===l.indexOf(e)||-1<o.indexOf(e)})),-1!==c.indexOf("up")&&-1===r.indexOf(s.id)){for(i=0,n=s.parents.length;i<n;i++)(a=this._model.data[s.parents[i]]).state[d?"selected":"checked"]=!1,a&&a.original&&a.original.state&&a.original.state.undetermined&&(a.original.state.undetermined=!1),(a=this.get_node(s.parents[i],!0))&&a.length&&a.children(".jstree-anchor").attr("aria-selected",!1).removeClass(d?"jstree-clicked":"jstree-checked");r=e.vakata.array_filter(r,function(e){return-1===s.parents.indexOf(e)})}this._data[d?"core":"checkbox"].selected=r}.bind(this)),-1!==this.settings.checkbox.cascade.indexOf("up")&&this.element.on("delete_node.jstree",function(t,r){for(var i,n,a,o,s=this.get_node(r.parent),c=this._model.data,d=this.settings.checkbox.tie_selection;s&&s.id!==e.jstree.root&&!s.state[d?"selected":"checked"];){for(i=a=0,n=s.children.length;i<n;i++)a+=c[s.children[i]].state[d?"selected":"checked"];if(!(0<n&&a===n))break;s.state[d?"selected":"checked"]=!0,this._data[d?"core":"checkbox"].selected.push(s.id),(o=this.get_node(s,!0))&&o.length&&o.children(".jstree-anchor").attr("aria-selected",!0).addClass(d?"jstree-clicked":"jstree-checked"),s=this.get_node(s.parent)}}.bind(this)).on("move_node.jstree",function(t,r){var i,n,a,o,s,c=r.is_multi,d=r.old_parent,r=this.get_node(r.parent),l=this._model.data,h=this.settings.checkbox.tie_selection;if(!c)for(i=this.get_node(d);i&&i.id!==e.jstree.root&&!i.state[h?"selected":"checked"];){for(a=n=0,o=i.children.length;a<o;a++)n+=l[i.children[a]].state[h?"selected":"checked"];if(!(0<o&&n===o))break;i.state[h?"selected":"checked"]=!0,this._data[h?"core":"checkbox"].selected.push(i.id),(s=this.get_node(i,!0))&&s.length&&s.children(".jstree-anchor").attr("aria-selected",!0).addClass(h?"jstree-clicked":"jstree-checked"),i=this.get_node(i.parent)}for(i=r;i&&i.id!==e.jstree.root;){for(a=n=0,o=i.children.length;a<o;a++)n+=l[i.children[a]].state[h?"selected":"checked"];if(n===o)i.state[h?"selected":"checked"]||(i.state[h?"selected":"checked"]=!0,this._data[h?"core":"checkbox"].selected.push(i.id),(s=this.get_node(i,!0))&&s.length&&s.children(".jstree-anchor").attr("aria-selected",!0).addClass(h?"jstree-clicked":"jstree-checked"));else{if(!i.state[h?"selected":"checked"])break;i.state[h?"selected":"checked"]=!1,this._data[h?"core":"checkbox"].selected=e.vakata.array_remove_item(this._data[h?"core":"checkbox"].selected,i.id),(s=this.get_node(i,!0))&&s.length&&s.children(".jstree-anchor").attr("aria-selected",!1).removeClass(h?"jstree-clicked":"jstree-checked")}i=this.get_node(i.parent)}}.bind(this))},this.get_undetermined=function(r){if(-1===this.settings.checkbox.cascade.indexOf("undetermined"))return[];for(var i,n,a,o,s={},c=this._model.data,d=this.settings.checkbox.tie_selection,l=this._data[d?"core":"checkbox"].selected,h=[],u=this,f=[],i=0,n=l.length;i<n;i++)if(c[l[i]]&&c[l[i]].parents)for(a=0,o=c[l[i]].parents.length;a<o&&s[c[l[i]].parents[a]]===t;a++)c[l[i]].parents[a]!==e.jstree.root&&(s[c[l[i]].parents[a]]=!0,h.push(c[l[i]].parents[a]));for(this.element.find(".jstree-closed").not(":has(.jstree-children)").each(function(){var r,d=u.get_node(this);if(d)if(d.state.loaded){for(i=0,n=d.children_d.length;i<n;i++)if(!(r=c[d.children_d[i]]).state.loaded&&r.original&&r.original.state&&r.original.state.undetermined&&!0===r.original.state.undetermined)for(s[r.id]===t&&r.id!==e.jstree.root&&(s[r.id]=!0,h.push(r.id)),a=0,o=r.parents.length;a<o;a++)s[r.parents[a]]===t&&r.parents[a]!==e.jstree.root&&(s[r.parents[a]]=!0,h.push(r.parents[a]))}else if(d.original&&d.original.state&&d.original.state.undetermined&&!0===d.original.state.undetermined)for(s[d.id]===t&&d.id!==e.jstree.root&&(s[d.id]=!0,h.push(d.id)),a=0,o=d.parents.length;a<o;a++)s[d.parents[a]]===t&&d.parents[a]!==e.jstree.root&&(s[d.parents[a]]=!0,h.push(d.parents[a]))}),i=0,n=h.length;i<n;i++)c[h[i]].state[d?"selected":"checked"]||f.push(r?c[h[i]]:h[i]);return f},this._undetermined=function(){if(null!==this.element){var e,t,r,i=this.get_undetermined(!1);for(this.element.find(".jstree-undetermined").removeClass("jstree-undetermined"),e=0,t=i.length;e<t;e++)(r=this.get_node(i[e],!0))&&r.length&&r.children(".jstree-anchor").children(".jstree-checkbox").addClass("jstree-undetermined")}},this.redraw_node=function(e,t,r,n){if(e=i.redraw_node.apply(this,arguments)){for(var a,o,s=null,c=null,a=0,o=e.childNodes.length;a<o;a++)if(e.childNodes[a]&&e.childNodes[a].className&&-1!==e.childNodes[a].className.indexOf("jstree-anchor")){s=e.childNodes[a];break}s&&(!this.settings.checkbox.tie_selection&&this._model.data[e.id].state.checked&&(s.className+=" jstree-checked"),c=v.cloneNode(!1),this._model.data[e.id].state.checkbox_disabled&&(c.className+=" jstree-checkbox-disabled"),s.insertBefore(c,s.childNodes[0]))}return r||-1===this.settings.checkbox.cascade.indexOf("undetermined")||(this._data.checkbox.uto&&clearTimeout(this._data.checkbox.uto),this._data.checkbox.uto=setTimeout(this._undetermined.bind(this),50)),e},this.show_checkboxes=function(){this._data.core.themes.checkboxes=!0,this.get_container_ul().removeClass("jstree-no-checkboxes")},this.hide_checkboxes=function(){this._data.core.themes.checkboxes=!1,this.get_container_ul().addClass("jstree-no-checkboxes")},this.toggle_checkboxes=function(){this._data.core.themes.checkboxes?this.hide_checkboxes():this.show_checkboxes()},this.is_undetermined=function(t){t=this.get_node(t);var r,i,n=this.settings.checkbox.cascade,a=this.settings.checkbox.tie_selection,o=this._data[a?"core":"checkbox"].selected,s=this._model.data;if(!t||!0===t.state[a?"selected":"checked"]||-1===n.indexOf("undetermined")||-1===n.indexOf("down")&&-1===n.indexOf("up"))return!1;if(!t.state.loaded&&!0===t.original.state.undetermined)return!0;for(r=0,i=t.children_d.length;r<i;r++)if(-1!==e.inArray(t.children_d[r],o)||!s[t.children_d[r]].state.loaded&&s[t.children_d[r]].original.state.undetermined)return!0;return!1},this.disable_checkbox=function(t){var r,i,n;if(e.vakata.is_array(t)){for(r=0,i=(t=t.slice()).length;r<i;r++)this.disable_checkbox(t[r]);return!0}if(!(t=this.get_node(t))||t.id===e.jstree.root)return!1;n=this.get_node(t,!0),t.state.checkbox_disabled||(t.state.checkbox_disabled=!0,n&&n.length&&n.children(".jstree-anchor").children(".jstree-checkbox").addClass("jstree-checkbox-disabled"),this.trigger("disable_checkbox",{node:t}))},this.enable_checkbox=function(t){var r,i,n;if(e.vakata.is_array(t)){for(r=0,i=(t=t.slice()).length;r<i;r++)this.enable_checkbox(t[r]);return!0}if(!(t=this.get_node(t))||t.id===e.jstree.root)return!1;n=this.get_node(t,!0),t.state.checkbox_disabled&&(t.state.checkbox_disabled=!1,n&&n.length&&n.children(".jstree-anchor").children(".jstree-checkbox").removeClass("jstree-checkbox-disabled"),this.trigger("enable_checkbox",{node:t}))},this.activate_node=function(t,r){return!e(r.target).hasClass("jstree-checkbox-disabled")&&(this.settings.checkbox.tie_selection&&(this.settings.checkbox.whole_node||e(r.target).hasClass("jstree-checkbox"))&&(r.ctrlKey=!0),this.settings.checkbox.tie_selection||!this.settings.checkbox.whole_node&&!e(r.target).hasClass("jstree-checkbox")?i.activate_node.call(this,t,r):!this.is_disabled(t)&&(this.is_checked(t)?this.uncheck_node(t,r):this.check_node(t,r),void this.trigger("activate_node",{node:this.get_node(t)})))},this.delete_node=function(t){if(this.settings.checkbox.tie_selection||e.vakata.is_array(t))return i.delete_node.call(this,t);var r,n,a,o=!1;if(!(t=this.get_node(t))||t.id===e.jstree.root)return!1;for((r=t.children_d.concat([])).push(t.id),n=0,a=r.length;n<a;n++)if(this._model.data[r[n]].state.checked){o=!0;break}return o&&(this._data.checkbox.selected=e.vakata.array_filter(this._data.checkbox.selected,function(t){return-1===e.inArray(t,r)})),i.delete_node.call(this,t)},this._cascade_new_checked_state=function(e,t){var r,i,n,a=this,o=this.settings.checkbox.tie_selection,s=this._model.data[e],c=[],d=[];if(!this.settings.checkbox.cascade_to_disabled&&s.state.disabled||!this.settings.checkbox.cascade_to_hidden&&s.state.hidden)n=this.get_checked_descendants(e),s.state[o?"selected":"checked"]&&n.push(s.id),c=c.concat(n);else{if(s.children)for(r=0,i=s.children.length;r<i;r++){var l=s.children[r],n=a._cascade_new_checked_state(l,t),c=c.concat(n);-1<n.indexOf(l)&&d.push(l)}var h=a.get_node(s,!0),e=0<d.length&&d.length<s.children.length;s.original&&s.original.state&&s.original.state.undetermined&&(s.original.state.undetermined=e),!e&&t&&d.length===s.children.length?(s.state[o?"selected":"checked"]=t,c.push(s.id),h.children(".jstree-anchor").attr("aria-selected",!0).addClass(o?"jstree-clicked":"jstree-checked")):(s.state[o?"selected":"checked"]=!1,h.children(".jstree-anchor").attr("aria-selected",!1).removeClass(o?"jstree-clicked":"jstree-checked"))}return c},this.get_checked_descendants=function(t){var r=this,i=r.settings.checkbox.tie_selection,t=r._model.data[t];return e.vakata.array_filter(t.children_d,function(e){return r._model.data[e].state[i?"selected":"checked"]})},this.check_node=function(t,r){if(this.settings.checkbox.tie_selection)return this.select_node(t,!1,!0,r);var i,n,a;if(e.vakata.is_array(t)){for(n=0,a=(t=t.slice()).length;n<a;n++)this.check_node(t[n],r);return!0}if(!(t=this.get_node(t))||t.id===e.jstree.root)return!1;i=this.get_node(t,!0),t.state.checked||(t.state.checked=!0,this._data.checkbox.selected.push(t.id),i&&i.length&&i.children(".jstree-anchor").addClass("jstree-checked"),this.trigger("check_node",{node:t,selected:this._data.checkbox.selected,event:r}))},this.uncheck_node=function(t,r){if(this.settings.checkbox.tie_selection)return this.deselect_node(t,!1,r);var i,n,a;if(e.vakata.is_array(t)){for(i=0,n=(t=t.slice()).length;i<n;i++)this.uncheck_node(t[i],r);return!0}if(!(t=this.get_node(t))||t.id===e.jstree.root)return!1;a=this.get_node(t,!0),t.state.checked&&(t.state.checked=!1,this._data.checkbox.selected=e.vakata.array_remove_item(this._data.checkbox.selected,t.id),a.length&&a.children(".jstree-anchor").removeClass("jstree-checked"),this.trigger("uncheck_node",{node:t,selected:this._data.checkbox.selected,event:r}))},this.check_all=function(){if(this.settings.checkbox.tie_selection)return this.select_all();var t,r;this._data.checkbox.selected.concat([]);for(this._data.checkbox.selected=this._model.data[e.jstree.root].children_d.concat(),t=0,r=this._data.checkbox.selected.length;t<r;t++)this._model.data[this._data.checkbox.selected[t]]&&(this._model.data[this._data.checkbox.selected[t]].state.checked=!0);this.redraw(!0),this.trigger("check_all",{selected:this._data.checkbox.selected})},this.uncheck_all=function(){if(this.settings.checkbox.tie_selection)return this.deselect_all();for(var e,t,r=this._data.checkbox.selected.concat([]),e=0,t=this._data.checkbox.selected.length;e<t;e++)this._model.data[this._data.checkbox.selected[e]]&&(this._model.data[this._data.checkbox.selected[e]].state.checked=!1);this._data.checkbox.selected=[],this.element.find(".jstree-checked").removeClass("jstree-checked"),this.trigger("uncheck_all",{selected:this._data.checkbox.selected,node:r})},this.is_checked=function(t){return this.settings.checkbox.tie_selection?this.is_selected(t):!(!(t=this.get_node(t))||t.id===e.jstree.root)&&t.state.checked},this.get_checked=function(t){return this.settings.checkbox.tie_selection?this.get_selected(t):t?e.map(this._data.checkbox.selected,function(e){return this.get_node(e)}.bind(this)):this._data.checkbox.selected.slice()},this.get_top_checked=function(t){if(this.settings.checkbox.tie_selection)return this.get_top_selected(t);for(var r,i,n,a,o=this.get_checked(!0),s={},r=0,i=o.length;r<i;r++)s[o[r].id]=o[r];for(r=0,i=o.length;r<i;r++)for(n=0,a=o[r].children_d.length;n<a;n++)s[o[r].children_d[n]]&&delete s[o[r].children_d[n]];for(r in o=[],s)s.hasOwnProperty(r)&&o.push(r);return t?e.map(o,function(e){return this.get_node(e)}.bind(this)):o},this.get_bottom_checked=function(t){if(this.settings.checkbox.tie_selection)return this.get_bottom_selected(t);for(var r,i,n=this.get_checked(!0),a=[],r=0,i=n.length;r<i;r++)n[r].children.length||a.push(n[r].id);return t?e.map(a,function(e){return this.get_node(e)}.bind(this)):a},this.load_node=function(t,r){var n,a,o;if(!e.vakata.is_array(t)&&!this.settings.checkbox.tie_selection&&(o=this.get_node(t))&&o.state.loaded)for(n=0,a=o.children_d.length;n<a;n++)this._model.data[o.children_d[n]].state.checked&&(this._data.checkbox.selected=e.vakata.array_remove_item(this._data.checkbox.selected,o.children_d[n]));return i.load_node.apply(this,arguments)},this.get_state=function(){var e=i.get_state.apply(this,arguments);return this.settings.checkbox.tie_selection||(e.checkbox=this._data.checkbox.selected.slice()),e},this.set_state=function(t,r){var n,a=i.set_state.apply(this,arguments);return a&&t.checkbox?(this.settings.checkbox.tie_selection||(this.uncheck_all(),n=this,e.each(t.checkbox,function(e,t){n.check_node(t)})),delete t.checkbox,this.set_state(t,r),!1):a},this.refresh=function(e,t){return this.settings.checkbox.tie_selection&&(this._data.checkbox.selected=[]),i.refresh.apply(this,arguments)}},e.jstree.defaults.conditionalselect=function(){return!0},e.jstree.plugins.conditionalselect=function(e,t){this.activate_node=function(e,r){if(this.settings.conditionalselect.call(this,this.get_node(e),r))return t.activate_node.call(this,e,r)}},e.jstree.defaults.contextmenu={select_node:!0,show_at_node:!0,items:function(t,r){return{create:{separator_before:!1,separator_after:!0,_disabled:!1,label:"Create",action:function(t){var r=e.jstree.reference(t.reference),t=r.get_node(t.reference);r.create_node(t,{},"last",function(e){try{r.edit(e)}catch(t){setTimeout(function(){r.edit(e)},0)}})}},rename:{separator_before:!1,separator_after:!1,_disabled:!1,label:"Rename",action:function(t){var r=e.jstree.reference(t.reference),t=r.get_node(t.reference);r.edit(t)}},remove:{separator_before:!1,icon:!1,separator_after:!1,_disabled:!1,label:"Delete",action:function(t){var r=e.jstree.reference(t.reference),t=r.get_node(t.reference);r.is_selected(t)?r.delete_node(r.get_selected()):r.delete_node(t)}},ccp:{separator_before:!0,icon:!1,separator_after:!1,label:"Edit",action:!1,submenu:{cut:{separator_before:!1,separator_after:!1,label:"Cut",action:function(t){var r=e.jstree.reference(t.reference),t=r.get_node(t.reference);r.is_selected(t)?r.cut(r.get_top_selected()):r.cut(t)}},copy:{separator_before:!1,icon:!1,separator_after:!1,label:"Copy",action:function(t){var r=e.jstree.reference(t.reference),t=r.get_node(t.reference);r.is_selected(t)?r.copy(r.get_top_selected()):r.copy(t)}},paste:{separator_before:!1,icon:!1,_disabled:function(t){return!e.jstree.reference(t.reference).can_paste()},separator_after:!1,label:"Paste",action:function(t){var r=e.jstree.reference(t.reference),t=r.get_node(t.reference);r.paste(t)}}}}}}},e.jstree.plugins.contextmenu=function(r,i){this.bind=function(){i.bind.call(this);var t,r,n=0,a=null;this.element.on("init.jstree loading.jstree ready.jstree",function(){this.get_container_ul().addClass("jstree-contextmenu")}.bind(this)).on("contextmenu.jstree",".jstree-anchor",function(e,t){"input"!==e.target.tagName.toLowerCase()&&(e.preventDefault(),n=e.ctrlKey?+new Date:0,(t||a)&&(n=+new Date+1e4),a&&clearTimeout(a),this.is_loading(e.currentTarget)||this.show_contextmenu(e.currentTarget,e.pageX,e.pageY,e))}.bind(this)).on("click.jstree",".jstree-anchor",function(t){this._data.contextmenu.visible&&(!n||250<+new Date-n)&&e.vakata.context.hide(),n=0}.bind(this)).on("touchstart.jstree",".jstree-anchor",function(i){i.originalEvent&&i.originalEvent.changedTouches&&i.originalEvent.changedTouches[0]&&(t=i.originalEvent.changedTouches[0].clientX,r=i.originalEvent.changedTouches[0].clientY,a=setTimeout(function(){e(i.currentTarget).trigger("contextmenu",!0)},750))}).on("touchmove.vakata.jstree",function(i){a&&i.originalEvent&&i.originalEvent.changedTouches&&i.originalEvent.changedTouches[0]&&(10<Math.abs(t-i.originalEvent.changedTouches[0].clientX)||10<Math.abs(r-i.originalEvent.changedTouches[0].clientY))&&(clearTimeout(a),e.vakata.context.hide())}).on("touchend.vakata.jstree",function(e){a&&clearTimeout(a)}),e(c).on("context_hide.vakata.jstree",function(t,r){this._data.contextmenu.visible=!1,e(r.reference).removeClass("jstree-context")}.bind(this))},this.teardown=function(){this._data.contextmenu.visible&&e.vakata.context.hide(),e(c).off("context_hide.vakata.jstree"),i.teardown.call(this)},this.show_contextmenu=function(r,i,n,a){if(!(r=this.get_node(r))||r.id===e.jstree.root)return!1;var o=this.settings.contextmenu,s=this.get_node(r,!0).children(".jstree-anchor"),c=!1,d=!1;!o.show_at_node&&i!==t&&n!==t||(c=s.offset(),i=c.left,n=c.top+this._data.core.li_height),this.settings.contextmenu.select_node&&!this.is_selected(r)&&this.activate_node(r,a),d=o.items,e.vakata.is_function(d)&&(d=d.call(this,r,function(e){this._show_contextmenu(r,i,n,e)}.bind(this))),e.isPlainObject(d)&&this._show_contextmenu(r,i,n,d)},this._show_contextmenu=function(t,r,i,n){var a=this.get_node(t,!0).children(".jstree-anchor");e(c).one("context_show.vakata.jstree",function(t,r){var i="jstree-contextmenu jstree-"+this.get_theme()+"-contextmenu";e(r.element).addClass(i),a.addClass("jstree-context")}.bind(this)),this._data.contextmenu.visible=!0,e.vakata.context.show(a,{x:r,y:i},n),this.trigger("show_contextmenu",{node:t,x:r,y:i})}},f={element:u=!1,reference:!1,position_x:0,position_y:0,items:[],html:"",is_visible:!1},(h=e).vakata.context={settings:{hide_onmouseleave:0,icons:!0},_trigger:function(e){h(c).triggerHandler("context_"+e+".vakata",{reference:f.reference,element:f.element,position:{x:f.position_x,y:f.position_y}})},_execute:function(e){return!(!(e=f.items[e])||e._disabled&&(!h.vakata.is_function(e._disabled)||e._disabled({item:e,reference:f.reference,element:f.element}))||!e.action)&&e.action.call(null,{item:e,reference:f.reference,element:f.element,position:{x:f.position_x,y:f.position_y}})},_parse:function(e,t){if(!e)return!1;t||(f.html="",f.items=[]);var r,i="",n=!1;return t&&(i+="<ul>"),h.each(e,function(e,t){return!t||(f.items.push(t),!n&&t.separator_before&&(i+="<li class='vakata-context-separator'><a href='#' "+(h.vakata.context.settings.icons?"":'class="vakata-context-no-icons"')+">&#160;</a></li>"),n=!1,i+="<li class='"+(t._class||"")+(!0===t._disabled||h.vakata.is_function(t._disabled)&&t._disabled({item:t,reference:f.reference,element:f.element})?" vakata-contextmenu-disabled ":"")+"' "+(t.shortcut?" data-shortcut='"+t.shortcut+"' ":"")+">",i+="<a href='#' rel='"+(f.items.length-1)+"' "+(t.title?"title='"+t.title+"'":"")+">",h.vakata.context.settings.icons&&(i+="<i ",t.icon&&(-1!==t.icon.indexOf("/")||-1!==t.icon.indexOf(".")?i+=" style='background:url(\""+t.icon+"\") center center no-repeat' ":i+=" class='"+t.icon+"' "),i+="></i><span class='vakata-contextmenu-sep'>&#160;</span>"),i+=(h.vakata.is_function(t.label)?t.label({item:e,reference:f.reference,element:f.element}):t.label)+(t.shortcut?' <span class="vakata-contextmenu-shortcut vakata-contextmenu-shortcut-'+t.shortcut+'">'+(t.shortcut_label||"")+"</span>":"")+"</a>",t.submenu&&(r=h.vakata.context._parse(t.submenu,!0))&&(i+=r),i+="</li>",void(t.separator_after&&(i+="<li class='vakata-context-separator'><a href='#' "+(h.vakata.context.settings.icons?"":'class="vakata-context-no-icons"')+">&#160;</a></li>",n=!0)))}),i=i.replace(/<li class\='vakata-context-separator'\><\/li\>$/,""),t&&(i+="</ul>"),t||(f.html=i,h.vakata.context._trigger("parse")),10<i.length&&i},_show_submenu:function(e){var t,r,i,n,a,o,s,c;(e=h(e)).length&&e.children("ul").length&&(t=e.children("ul"),i=(r=e.offset().left)+e.outerWidth(),n=e.offset().top,a=t.width(),o=t.height(),s=h(window).width()+h(window).scrollLeft(),c=h(window).height()+h(window).scrollTop(),u?e[i-(a+10+e.outerWidth())<0?"addClass":"removeClass"]("vakata-context-left"):e[s<i+a&&s-i<r?"addClass":"removeClass"]("vakata-context-right"),c<n+o+10&&t.css("bottom","-1px"),e.hasClass("vakata-context-right")?r<a&&t.css("margin-right",r-a):s-i<a&&t.css("margin-left",s-i-a),t.show())},show:function(e,t,r){var i,n,a,o,s,d,l,r;switch(f.element&&f.element.length&&f.element.width(""),!0){case!t&&!e:return!1;case!!t&&!!e:f.reference=e,f.position_x=t.x,f.position_y=t.y;break;case!t&&!!e:i=(f.reference=e).offset(),f.position_x=i.left+e.outerHeight(),f.position_y=i.top;break;case!!t&&!e:f.position_x=t.x,f.position_y=t.y}e&&!r&&h(e).data("vakata_contextmenu")&&(r=h(e).data("vakata_contextmenu")),h.vakata.context._parse(r)&&f.element.html(f.html),f.items.length&&(f.element.appendTo(c.body),n=f.element,a=f.position_x,o=f.position_y,s=n.width(),d=n.height(),l=h(window).width()+h(window).scrollLeft(),r=h(window).height()+h(window).scrollTop(),u&&(a-=n.outerWidth()-h(e).outerWidth())<h(window).scrollLeft()+20&&(a=h(window).scrollLeft()+20),f.element.css({left:a=l<a+s+20?l-(s+20):a,top:o=r<o+d+20?r-(d+20):o}).show().find("a").first().trigger("focus").parent().addClass("vakata-context-hover"),f.is_visible=!0,h.vakata.context._trigger("show"))},hide:function(){f.is_visible&&(f.element.hide().find("ul").hide().end().find(":focus").trigger("blur").end().detach(),f.is_visible=!1,h.vakata.context._trigger("hide"))}},h(function(){u="rtl"===h(c.body).css("direction");var e=!1;f.element=h("<ul class='vakata-context'></ul>"),f.element.on("mouseenter","li",function(t){t.stopImmediatePropagation(),h.contains(this,t.relatedTarget)||(e&&clearTimeout(e),f.element.find(".vakata-context-hover").removeClass("vakata-context-hover").end(),h(this).siblings().find("ul").hide().end().end().parentsUntil(".vakata-context","li").addBack().addClass("vakata-context-hover"),h.vakata.context._show_submenu(this))}).on("mouseleave","li",function(e){h.contains(this,e.relatedTarget)||h(this).find(".vakata-context-hover").addBack().removeClass("vakata-context-hover")}).on("mouseleave",function(t){h(this).find(".vakata-context-hover").removeClass("vakata-context-hover"),h.vakata.context.settings.hide_onmouseleave&&(e=setTimeout((this,function(){h.vakata.context.hide()}),h.vakata.context.settings.hide_onmouseleave))}).on("click","a",function(e){e.preventDefault(),h(this).trigger("blur").parent().hasClass("vakata-context-disabled")||!1===h.vakata.context._execute(h(this).attr("rel"))||h.vakata.context.hide()}).on("keydown","a",function(e){var t=null;switch(e.which){case 13:case 32:e.type="click",e.preventDefault(),h(e.currentTarget).trigger(e);break;case 37:f.is_visible&&(f.element.find(".vakata-context-hover").last().closest("li").first().find("ul").hide().find(".vakata-context-hover").removeClass("vakata-context-hover").end().end().children("a").trigger("focus"),e.stopImmediatePropagation(),e.preventDefault());break;case 38:f.is_visible&&((t=(t=f.element.find("ul:visible").addBack().last().children(".vakata-context-hover").removeClass("vakata-context-hover").prevAll("li:not(.vakata-context-separator)").first()).length?t:f.element.find("ul:visible").addBack().last().children("li:not(.vakata-context-separator)").last()).addClass("vakata-context-hover").children("a").trigger("focus"),e.stopImmediatePropagation(),e.preventDefault());break;case 39:f.is_visible&&(f.element.find(".vakata-context-hover").last().children("ul").show().children("li:not(.vakata-context-separator)").removeClass("vakata-context-hover").first().addClass("vakata-context-hover").children("a").trigger("focus"),e.stopImmediatePropagation(),e.preventDefault());break;case 40:f.is_visible&&((t=(t=f.element.find("ul:visible").addBack().last().children(".vakata-context-hover").removeClass("vakata-context-hover").nextAll("li:not(.vakata-context-separator)").first()).length?t:f.element.find("ul:visible").addBack().last().children("li:not(.vakata-context-separator)").first()).addClass("vakata-context-hover").children("a").trigger("focus"),e.stopImmediatePropagation(),e.preventDefault());break;case 27:h.vakata.context.hide(),e.preventDefault()}}).on("keydown",function(e){e.preventDefault();var e=f.element.find(".vakata-contextmenu-shortcut-"+e.which).parent();e.parent().not(".vakata-context-disabled")&&e.trigger("click")}),h(c).on("mousedown.vakata.jstree",function(e){f.is_visible&&f.element[0]!==e.target&&!h.contains(f.element[0],e.target)&&h.vakata.context.hide()}).on("context_show.vakata.jstree",function(e,t){f.element.find("li:has(ul)").children("a").addClass("vakata-context-parent"),u&&f.element.addClass("vakata-context-rtl").css("direction","rtl"),f.element.find("ul").hide().end()})}),e.jstree.defaults.dnd={copy:!0,open_timeout:500,is_draggable:!0,check_while_dragging:!0,always_copy:!1,inside_pos:0,drag_selection:!0,touch:!0,large_drop_target:!1,large_drag_target:!1,use_html5:!1,blank_space_drop:!1},e.jstree.plugins.dnd=function(t,r){this.init=function(e,t){r.init.call(this,e,t),this.settings.dnd.use_html5=this.settings.dnd.use_html5&&"draggable"in c.createElement("span")},this.bind=function(){r.bind.call(this),this.element.on(this.settings.dnd.use_html5?"dragstart.jstree":"mousedown.jstree touchstart.jstree",this.settings.dnd.large_drag_target?".jstree-node":".jstree-anchor",function(t){if(this.settings.dnd.large_drag_target&&e(t.target).closest(".jstree-node")[0]!==t.currentTarget)return!0;if("touchstart"===t.type&&(!this.settings.dnd.touch||"selected"===this.settings.dnd.touch&&!e(t.currentTarget).closest(".jstree-node").children(".jstree-anchor").hasClass("jstree-clicked")))return!0;var r=this.get_node(t.target),i=this.is_selected(r)&&this.settings.dnd.drag_selection?this.get_top_selected().length:1,n=1<i?i+" "+this.get_string("nodes"):this.get_text(t.currentTarget);if(this.settings.core.force_text&&(n=e.vakata.html.escape(n)),r&&(r.id||0===r.id)&&r.id!==e.jstree.root&&(1===t.which||"touchstart"===t.type||"dragstart"===t.type)&&(!0===this.settings.dnd.is_draggable||e.vakata.is_function(this.settings.dnd.is_draggable)&&this.settings.dnd.is_draggable.call(this,1<i?this.get_top_selected(!0):[r],t))){if(p={jstree:!0,origin:this,obj:this.get_node(r,!0),nodes:1<i?this.get_top_selected():[r.id]},_=t.currentTarget,!this.settings.dnd.use_html5)return this.element.trigger("mousedown.jstree"),e.vakata.dnd.start(t,p,'<div id="jstree-dnd" class="jstree-'+this.get_theme()+" jstree-"+this.get_theme()+"-"+this.get_theme_variant()+" "+(this.settings.core.themes.responsive?" jstree-dnd-responsive":"")+'"><i class="jstree-icon jstree-er"></i>'+n+'<ins class="jstree-copy">+</ins></div>');e.vakata.dnd._trigger("start",t,{helper:e(),element:_,data:p})}}.bind(this)),this.settings.dnd.use_html5&&this.element.on("dragover.jstree",function(t){return t.preventDefault(),e.vakata.dnd._trigger("move",t,{helper:e(),element:_,data:p}),!1}).on("drop.jstree",function(t){return t.preventDefault(),e.vakata.dnd._trigger("stop",t,{helper:e(),element:_,data:p}),!1}.bind(this))},this.redraw_node=function(e,t,i,n){if((e=r.redraw_node.apply(this,arguments))&&this.settings.dnd.use_html5)if(this.settings.dnd.large_drag_target)e.setAttribute("draggable",!0);else{for(var a,o,s=null,a=0,o=e.childNodes.length;a<o;a++)if(e.childNodes[a]&&e.childNodes[a].className&&-1!==e.childNodes[a].className.indexOf("jstree-anchor")){s=e.childNodes[a];break}s&&s.setAttribute("draggable",!0)}return e}},e(function(){var r=!1,i=!1,n=!1,a=!1,o=e('<div id="jstree-marker">&#160;</div>').hide();e(c).on("dragover.vakata.jstree",function(t){_&&e.vakata.dnd._trigger("move",t,{helper:e(),element:_,data:p})}).on("drop.vakata.jstree",function(t){_&&(e.vakata.dnd._trigger("stop",t,{helper:e(),element:_,data:p}),p=_=null)}).on("dnd_start.vakata.jstree",function(e,t){n=r=!1,t&&t.data&&t.data.jstree&&o.appendTo(c.body)}).on("dnd_move.vakata.jstree",function(s,c){var d=c.event.target!==n.target;if(a&&(c.event&&"dragover"===c.event.type&&!d||clearTimeout(a)),c&&c.data&&c.data.jstree&&(!c.event.target.id||"jstree-marker"!==c.event.target.id)){n=c.event;var l,h,u,f,p,_,g,m,y,v,b,j,k,w,x,S,C,O=e.jstree.reference(c.event.target),A=!1,T=!1,E=!1;if(O&&O._data&&O._data.dnd)if(o.attr("class","jstree-"+O.get_theme()+(O.settings.core.themes.responsive?" jstree-dnd-responsive":"")),x=c.data.origin&&(c.data.origin.settings.dnd.always_copy||c.data.origin.settings.dnd.copy&&(c.event.metaKey||c.event.ctrlKey)),c.helper.children().attr("class","jstree-"+O.get_theme()+" jstree-"+O.get_theme()+"-"+O.get_theme_variant()+" "+(O.settings.core.themes.responsive?" jstree-dnd-responsive":"")).find(".jstree-copy").first()[x?"show":"hide"](),c.event.target!==O.element[0]&&c.event.target!==O.get_container_ul()[0]||0!==O.get_container_ul().children().length&&!O.settings.dnd.blank_space_drop){if((A=O.settings.dnd.large_drop_target?e(c.event.target).closest(".jstree-node").children(".jstree-anchor"):e(c.event.target).closest(".jstree-anchor"))&&A.length&&A.parent().is(".jstree-closed, .jstree-open, .jstree-leaf")&&(T=A.offset(),E=(c.event.pageY!==t?c.event:c.event.originalEvent).pageY-T.top,u=A.outerHeight(),_=E<u/3?["b","i","a"]:u-u/3<E?["a","i","b"]:u/2<E?["i","a","b"]:["i","b","a"],e.each(_,function(t,n){switch(n){case"b":l=T.left-6,h=T.top,f=O.get_parent(A),p=A.parent().index(),C="jstree-below";break;case"i":k=O.settings.dnd.inside_pos,w=O.get_node(A.parent()),l=T.left-2,h=T.top+u/2+1,f=w.id,p="first"===k?0:"last"===k?w.children.length:Math.min(k,w.children.length),C="jstree-inside";break;case"a":l=T.left-6,h=T.top+u,f=O.get_parent(A),p=A.parent().index()+1,C="jstree-above"}for(g=!0,m=0,y=c.data.nodes.length;m<y;m++)if(v=c.data.origin&&(c.data.origin.settings.dnd.always_copy||c.data.origin.settings.dnd.copy&&(c.event.metaKey||c.event.ctrlKey))?"copy_node":"move_node",b=p,"move_node"==v&&"a"===n&&c.data.origin&&c.data.origin===O&&f===O.get_parent(c.data.nodes[m])&&(j=O.get_node(f),b>e.inArray(c.data.nodes[m],j.children)&&--b),!(g=g&&(O&&O.settings&&O.settings.dnd&&!1===O.settings.dnd.check_while_dragging||O.check(v,c.data.origin&&c.data.origin!==O?c.data.origin.get_node(c.data.nodes[m]):c.data.nodes[m],f,b,{dnd:!0,ref:O.get_node(A.parent()),pos:n,origin:c.data.origin,is_multi:c.data.origin&&c.data.origin!==O,is_foreign:!c.data.origin})))){O&&O.last_error&&(i=O.last_error());break}var s,E;if("i"===n&&A.parent().is(".jstree-closed")&&O.settings.dnd.open_timeout&&(c.event&&"dragover"===c.event.type&&!d||(a&&clearTimeout(a),a=setTimeout((E=A,function(){s.open_node(E)}),(s=O).settings.dnd.open_timeout))),g)return(S=O.get_node(f,!0)).hasClass(".jstree-dnd-parent")||(e(".jstree-dnd-parent").removeClass("jstree-dnd-parent"),S.addClass("jstree-dnd-parent")),r={ins:O,par:f,pos:"i"!==n||"last"!==k||0!==p||O.is_loaded(w)?p:"last"},o.css({left:l+"px",top:h+"px"}).show(),o.removeClass("jstree-above jstree-inside jstree-below").addClass(C),c.helper.find(".jstree-icon").first().removeClass("jstree-er").addClass("jstree-ok"),c.event.originalEvent&&c.event.originalEvent.dataTransfer&&(c.event.originalEvent.dataTransfer.dropEffect=x?"copy":"move"),i={},!(_=!0)}),!0===_))return}else{for(g=!0,m=0,y=c.data.nodes.length;m<y&&(g=g&&O.check(c.data.origin&&(c.data.origin.settings.dnd.always_copy||c.data.origin.settings.dnd.copy&&(c.event.metaKey||c.event.ctrlKey))?"copy_node":"move_node",c.data.origin&&c.data.origin!==O?c.data.origin.get_node(c.data.nodes[m]):c.data.nodes[m],e.jstree.root,"last",{dnd:!0,ref:O.get_node(e.jstree.root),pos:"i",origin:c.data.origin,is_multi:c.data.origin&&c.data.origin!==O,is_foreign:!c.data.origin}));m++);if(g)return r={ins:O,par:e.jstree.root,pos:"last"},o.hide(),c.helper.find(".jstree-icon").first().removeClass("jstree-er").addClass("jstree-ok"),void(c.event.originalEvent&&c.event.originalEvent.dataTransfer&&(c.event.originalEvent.dataTransfer.dropEffect=x?"copy":"move"))}e(".jstree-dnd-parent").removeClass("jstree-dnd-parent"),r=!1,c.helper.find(".jstree-icon").removeClass("jstree-ok").addClass("jstree-er"),c.event.originalEvent&&c.event.originalEvent.dataTransfer,o.hide()}}).on("dnd_scroll.vakata.jstree",function(e,t){t&&t.data&&t.data.jstree&&(o.hide(),n=r=!1,t.helper.find(".jstree-icon").first().removeClass("jstree-ok").addClass("jstree-er"))}).on("dnd_stop.vakata.jstree",function(t,s){if(e(".jstree-dnd-parent").removeClass("jstree-dnd-parent"),a&&clearTimeout(a),s&&s.data&&s.data.jstree){o.hide().detach();var c,d,l=[];if(r){for(c=0,d=s.data.nodes.length;c<d;c++)l[c]=s.data.origin?s.data.origin.get_node(s.data.nodes[c]):s.data.nodes[c];r.ins[s.data.origin&&(s.data.origin.settings.dnd.always_copy||s.data.origin.settings.dnd.copy&&(s.event.metaKey||s.event.ctrlKey))?"copy_node":"move_node"](l,r.par,r.pos,!1,!1,!1,s.data.origin)}else(c=e(s.event.target).closest(".jstree")).length&&i&&i.error&&"check"===i.error&&(c=c.jstree(!0))&&c.settings.core.error.call(this,i);r=n=!1}}).on("keyup.jstree keydown.jstree",function(t,s){(s=e.vakata.dnd._get())&&s.data&&s.data.jstree&&("keyup"===t.type&&27===t.which?(a&&clearTimeout(a),a=n=i=r=!1,o.hide().detach(),e.vakata.dnd._clean()):(s.helper.find(".jstree-copy").first()[s.data.origin&&(s.data.origin.settings.dnd.always_copy||s.data.origin.settings.dnd.copy&&(t.metaKey||t.ctrlKey))?"show":"hide"](),n&&(n.metaKey=t.metaKey,n.ctrlKey=t.ctrlKey,e.vakata.dnd._trigger("move",n))))})}),m={element:!((g=e).vakata.html={div:g("<div></div>"),escape:function(e){return g.vakata.html.div.text(e).html()},strip:function(e){return g.vakata.html.div.empty().append(g.parseHTML(e)).text()}}),target:!1,is_down:!1,is_drag:!1,helper:!1,helper_w:0,data:!1,init_x:0,init_y:0,scroll_l:0,scroll_t:0,scroll_e:!1,scroll_i:!1,is_touch:!1},g.vakata.dnd={settings:{scroll_speed:10,scroll_proximity:20,helper_left:5,helper_top:10,threshold:5,threshold_touch:10},_trigger:function(e,r,i){(i=i===t?g.vakata.dnd._get():i).event=r,g(c).triggerHandler("dnd_"+e+".vakata",i)},_get:function(){return{data:m.data,element:m.element,helper:m.helper}},_clean:function(){m.helper&&m.helper.remove(),m.scroll_i&&(clearInterval(m.scroll_i),m.scroll_i=!1),m={element:!1,target:!1,is_down:!1,is_drag:!1,helper:!1,helper_w:0,data:!1,init_x:0,init_y:0,scroll_l:0,scroll_t:0,scroll_e:!1,scroll_i:!1,is_touch:!1},_=null,g(c).off("mousemove.vakata.jstree touchmove.vakata.jstree",g.vakata.dnd.drag),g(c).off("mouseup.vakata.jstree touchend.vakata.jstree",g.vakata.dnd.stop)},_scroll:function(e){if(!m.scroll_e||!m.scroll_l&&!m.scroll_t)return m.scroll_i&&(clearInterval(m.scroll_i),m.scroll_i=!1),!1;if(!m.scroll_i)return m.scroll_i=setInterval(g.vakata.dnd._scroll,100),!1;if(!0===e)return!1;var t=m.scroll_e.scrollTop(),e=m.scroll_e.scrollLeft();m.scroll_e.scrollTop(t+m.scroll_t*g.vakata.dnd.settings.scroll_speed),m.scroll_e.scrollLeft(e+m.scroll_l*g.vakata.dnd.settings.scroll_speed),t===m.scroll_e.scrollTop()&&e===m.scroll_e.scrollLeft()||g.vakata.dnd._trigger("scroll",m.scroll_e)},start:function(e,t,r){"touchstart"===e.type&&e.originalEvent&&e.originalEvent.changedTouches&&e.originalEvent.changedTouches[0]&&(e.pageX=e.originalEvent.changedTouches[0].pageX,e.pageY=e.originalEvent.changedTouches[0].pageY,e.target=c.elementFromPoint(e.originalEvent.changedTouches[0].pageX-window.pageXOffset,e.originalEvent.changedTouches[0].pageY-window.pageYOffset)),m.is_drag&&g.vakata.dnd.stop({});try{e.currentTarget.unselectable="on",e.currentTarget.onselectstart=function(){return!1},e.currentTarget.style&&(e.currentTarget.style.touchAction="none",e.currentTarget.style.msTouchAction="none",e.currentTarget.style.MozUserSelect="none")}catch(e){}return m.init_x=e.pageX,m.init_y=e.pageY,m.data=t,m.is_down=!0,m.element=e.currentTarget,m.target=e.target,m.is_touch="touchstart"===e.type,!1!==r&&(m.helper=g("<div id='vakata-dnd'></div>").html(r).css({display:"block",margin:"0",padding:"0",position:"absolute",top:"-2000px",lineHeight:"16px",zIndex:"10000"})),g(c).on("mousemove.vakata.jstree touchmove.vakata.jstree",g.vakata.dnd.drag),g(c).on("mouseup.vakata.jstree touchend.vakata.jstree",g.vakata.dnd.stop),!1},drag:function(e){if("touchmove"===e.type&&e.originalEvent&&e.originalEvent.changedTouches&&e.originalEvent.changedTouches[0]&&(e.pageX=e.originalEvent.changedTouches[0].pageX,e.pageY=e.originalEvent.changedTouches[0].pageY,e.target=c.elementFromPoint(e.originalEvent.changedTouches[0].pageX-window.pageXOffset,e.originalEvent.changedTouches[0].pageY-window.pageYOffset)),m.is_down){if(!m.is_drag){if(!(Math.abs(e.pageX-m.init_x)>(m.is_touch?g.vakata.dnd.settings.threshold_touch:g.vakata.dnd.settings.threshold)||Math.abs(e.pageY-m.init_y)>(m.is_touch?g.vakata.dnd.settings.threshold_touch:g.vakata.dnd.settings.threshold)))return;m.helper&&(m.helper.appendTo(c.body),m.helper_w=m.helper.outerWidth()),m.is_drag=!0,g(m.target).one("click.vakata",!1),g.vakata.dnd._trigger("start",e)}var t=!1,r=!1,i=!1,n=!1,a=!1,o=!1,s=!1,d=!1,l=!1,h=!1;return m.scroll_t=0,m.scroll_l=0,m.scroll_e=!1,g(g(e.target).parentsUntil("body").addBack().get().reverse()).filter(function(){return this.ownerDocument&&/^auto|scroll$/.test(g(this).css("overflow"))&&(this.scrollHeight>this.offsetHeight||this.scrollWidth>this.offsetWidth)}).each(function(){var t=g(this),r=t.offset();if(this.scrollHeight>this.offsetHeight&&(r.top+t.height()-e.pageY<g.vakata.dnd.settings.scroll_proximity&&(m.scroll_t=1),e.pageY-r.top<g.vakata.dnd.settings.scroll_proximity&&(m.scroll_t=-1)),this.scrollWidth>this.offsetWidth&&(r.left+t.width()-e.pageX<g.vakata.dnd.settings.scroll_proximity&&(m.scroll_l=1),e.pageX-r.left<g.vakata.dnd.settings.scroll_proximity&&(m.scroll_l=-1)),m.scroll_t||m.scroll_l)return m.scroll_e=g(this),!1}),m.scroll_e||(t=g(c),r=g(window),i=t.height(),n=r.height(),a=t.width(),o=r.width(),s=t.scrollTop(),d=t.scrollLeft(),n<i&&e.pageY-s<g.vakata.dnd.settings.scroll_proximity&&(m.scroll_t=-1),n<i&&n-(e.pageY-s)<g.vakata.dnd.settings.scroll_proximity&&(m.scroll_t=1),o<a&&e.pageX-d<g.vakata.dnd.settings.scroll_proximity&&(m.scroll_l=-1),o<a&&o-(e.pageX-d)<g.vakata.dnd.settings.scroll_proximity&&(m.scroll_l=1),(m.scroll_t||m.scroll_l)&&(m.scroll_e=t)),m.scroll_e&&g.vakata.dnd._scroll(!0),m.helper&&(l=parseInt(e.pageY+g.vakata.dnd.settings.helper_top,10),h=parseInt(e.pageX+g.vakata.dnd.settings.helper_left,10),a&&h+m.helper_w>a&&(h=a-(m.helper_w+2)),m.helper.css({left:h+"px",top:(l=i&&i<l+25?i-50:l)+"px"})),g.vakata.dnd._trigger("move",e),!1}},stop:function(e){var t;return"touchend"===e.type&&e.originalEvent&&e.originalEvent.changedTouches&&e.originalEvent.changedTouches[0]&&(e.pageX=e.originalEvent.changedTouches[0].pageX,e.pageY=e.originalEvent.changedTouches[0].pageY,e.target=c.elementFromPoint(e.originalEvent.changedTouches[0].pageX-window.pageXOffset,e.originalEvent.changedTouches[0].pageY-window.pageYOffset)),m.is_drag?(e.target!==m.target&&g(m.target).off("click.vakata"),g.vakata.dnd._trigger("stop",e)):"touchend"===e.type&&e.target===m.target&&(t=setTimeout(function(){g(e.target).trigger("click")},100),g(e.target).one("click",function(){t&&clearTimeout(t)})),g.vakata.dnd._clean(),!1}},e.jstree.defaults.massload=null,e.jstree.plugins.massload=function(t,r){this.init=function(e,t){this._data.massload={},r.init.call(this,e,t)},this._load_nodes=function(t,i,n,a){var o,s,c,d=this.settings.massload,l=[],h=this._model.data;if(!n){for(o=0,s=t.length;o<s;o++)h[t[o]]&&(h[t[o]].state.loaded||h[t[o]].state.failed)&&!a||(l.push(t[o]),(c=this.get_node(t[o],!0))&&c.length&&c.addClass("jstree-loading").attr("aria-busy",!0));if(this._data.massload={},l.length){if(e.vakata.is_function(d))return d.call(this,l,function(e){var o,s;if(e)for(o in e)e.hasOwnProperty(o)&&(this._data.massload[o]=e[o]);for(o=0,s=t.length;o<s;o++)(c=this.get_node(t[o],!0))&&c.length&&c.removeClass("jstree-loading").attr("aria-busy",!1);r._load_nodes.call(this,t,i,n,a)}.bind(this));if("object"==typeof d&&d&&d.url)return d=e.extend(!0,{},d),e.vakata.is_function(d.url)&&(d.url=d.url.call(this,l)),e.vakata.is_function(d.data)&&(d.data=d.data.call(this,l)),e.ajax(d).done(function(e,o,s){var d,l;if(e)for(d in e)e.hasOwnProperty(d)&&(this._data.massload[d]=e[d]);for(d=0,l=t.length;d<l;d++)(c=this.get_node(t[d],!0))&&c.length&&c.removeClass("jstree-loading").attr("aria-busy",!1);r._load_nodes.call(this,t,i,n,a)}.bind(this)).fail(function(e){r._load_nodes.call(this,t,i,n,a)}.bind(this))}}return r._load_nodes.call(this,t,i,n,a)},this._load_node=function(t,i){var n,n=this._data.massload[t.id],a=null;return n?(a=this["string"==typeof n?"_append_html_data":"_append_json_data"](t,"string"==typeof n?e(e.parseHTML(n)).filter(function(){return 3!==this.nodeType}):n,function(e){i.call(this,e)}),(n=this.get_node(t.id,!0))&&n.length&&n.removeClass("jstree-loading").attr("aria-busy",!1),delete this._data.massload[t.id],a):r._load_node.call(this,t,i)}},e.jstree.defaults.search={ajax:!1,fuzzy:!1,case_sensitive:!1,show_only_matches:!1,show_only_matches_children:!1,close_opened_onclear:!0,search_leaves_only:!1,search_callback:!1},e.jstree.plugins.search=function(r,i){this.bind=function(){i.bind.call(this),this._data.search.str="",this._data.search.dom=e(),this._data.search.res=[],this._data.search.opn=[],this._data.search.som=!1,this._data.search.smc=!1,this._data.search.hdn=[],this.element.on("search.jstree",function(t,r){if(this._data.search.som&&r.res.length){for(var i,n,a,o,s=this._model.data,c=[],i=0,n=r.res.length;i<n;i++)if(s[r.res[i]]&&!s[r.res[i]].state.hidden&&(c.push(r.res[i]),c=c.concat(s[r.res[i]].parents),this._data.search.smc))for(a=0,o=s[r.res[i]].children_d.length;a<o;a++)s[s[r.res[i]].children_d[a]]&&!s[s[r.res[i]].children_d[a]].state.hidden&&c.push(s[r.res[i]].children_d[a]);c=e.vakata.array_remove_item(e.vakata.array_unique(c),e.jstree.root),this._data.search.hdn=this.hide_all(!0),this.show_node(c,!0),this.redraw(!0)}}.bind(this)).on("clear_search.jstree",function(e,t){this._data.search.som&&t.res.length&&(this.show_node(this._data.search.hdn,!0),this.redraw(!0))}.bind(this))},this.search=function(r,i,n,a,o,s){if(!1===r||""===e.vakata.trim(r.toString()))return this.clear_search();a=(a=this.get_node(a))&&(a.id||0===a.id)?a.id:null,r=r.toString();var c,d,l=this.settings.search,h=l.ajax||!1,u=this._model.data,f=null,p=[],_=[];if(this._data.search.res.length&&!o&&this.clear_search(),n===t&&(n=l.show_only_matches),s===t&&(s=l.show_only_matches_children),!i&&!1!==h)return e.vakata.is_function(h)?h.call(this,r,function(t){t&&t.d&&(t=t.d),this._load_nodes(e.vakata.is_array(t)?e.vakata.array_unique(t):[],function(){this.search(r,!0,n,a,o,s)})}.bind(this),a):((h=e.extend({},h)).data||(h.data={}),h.data.str=r,a&&(h.data.inside=a),this._data.search.lastRequest&&this._data.search.lastRequest.abort(),this._data.search.lastRequest=e.ajax(h).fail(function(){this._data.core.last_error={error:"ajax",plugin:"search",id:"search_01",reason:"Could not load search parents",data:JSON.stringify(h)},this.settings.core.error.call(this,this._data.core.last_error)}.bind(this)).done(function(t){t&&t.d&&(t=t.d),this._load_nodes(e.vakata.is_array(t)?e.vakata.array_unique(t):[],function(){this.search(r,!0,n,a,o,s)})}.bind(this)),this._data.search.lastRequest);if(o||(this._data.search.str=r,this._data.search.dom=e(),this._data.search.res=[],this._data.search.opn=[],this._data.search.som=n,this._data.search.smc=s),f=new e.vakata.search(r,!0,{caseSensitive:l.case_sensitive,fuzzy:l.fuzzy}),e.each(u[a||e.jstree.root].children_d,function(e,t){var i=u[t];i.text&&!i.state.hidden&&(!l.search_leaves_only||i.state.loaded&&0===i.children.length)&&(l.search_callback&&l.search_callback.call(this,r,i)||!l.search_callback&&f.search(i.text).isMatch)&&(p.push(t),_=_.concat(i.parents))}),p.length){for(c=0,d=(_=e.vakata.array_unique(_)).length;c<d;c++)_[c]!==e.jstree.root&&u[_[c]]&&!0===this.open_node(_[c],null,0)&&this._data.search.opn.push(_[c]);o?(this._data.search.dom=this._data.search.dom.add(e(this.element[0].querySelectorAll("#"+e.map(p,function(t){return-1!=="0123456789".indexOf(t[0])?"\\3"+t[0]+" "+t.substr(1).replace(e.jstree.idregex,"\\$&"):t.replace(e.jstree.idregex,"\\$&")}).join(", #")))),this._data.search.res=e.vakata.array_unique(this._data.search.res.concat(p))):(this._data.search.dom=e(this.element[0].querySelectorAll("#"+e.map(p,function(t){return-1!=="0123456789".indexOf(t[0])?"\\3"+t[0]+" "+t.substr(1).replace(e.jstree.idregex,"\\$&"):t.replace(e.jstree.idregex,"\\$&")}).join(", #"))),this._data.search.res=p),this._data.search.dom.children(".jstree-anchor").addClass("jstree-search")}this.trigger("search",{nodes:this._data.search.dom,str:r,res:this._data.search.res,show_only_matches:n})},this.clear_search=function(){this.settings.search.close_opened_onclear&&this.close_node(this._data.search.opn,0),this.trigger("clear_search",{nodes:this._data.search.dom,str:this._data.search.str,res:this._data.search.res}),this._data.search.res.length&&(this._data.search.dom=e(this.element[0].querySelectorAll("#"+e.map(this._data.search.res,function(t){return-1!=="0123456789".indexOf(t[0])?"\\3"+t[0]+" "+t.substr(1).replace(e.jstree.idregex,"\\$&"):t.replace(e.jstree.idregex,"\\$&")}).join(", #"))),this._data.search.dom.children(".jstree-anchor").removeClass("jstree-search")),this._data.search.str="",this._data.search.res=[],this._data.search.opn=[],this._data.search.dom=e()},this.redraw_node=function(t,r,n,a){if((t=i.redraw_node.apply(this,arguments))&&-1!==e.inArray(t.id,this._data.search.res)){for(var o,s,c=null,o=0,s=t.childNodes.length;o<s;o++)if(t.childNodes[o]&&t.childNodes[o].className&&-1!==t.childNodes[o].className.indexOf("jstree-anchor")){c=t.childNodes[o];break}c&&(c.className+=" jstree-search")}return t}},(y=e).vakata.search=function(e,t,r){r=r||{},!1!==(r=y.extend({},y.vakata.search.defaults,r)).fuzzy&&(r.fuzzy=!0),e=r.caseSensitive?e:e.toLowerCase();var i,n,a,o,s=r.location,c=r.distance,d=r.threshold,l=e.length;return 32<l&&(r.fuzzy=!1),r.fuzzy&&(i=1<<l-1,n=function(){for(var t={},r=0,r=0;r<l;r++)t[e.charAt(r)]=0;for(r=0;r<l;r++)t[e.charAt(r)]|=1<<l-r-1;return t}(),a=function(e,t){var e=e/l,t=Math.abs(s-t);return c?e+t/c:t?1:e}),o=function(t){if(t=r.caseSensitive?t.toString():t.toString().toLowerCase(),e===t||-1!==t.indexOf(e))return{isMatch:!0,score:0};if(!r.fuzzy)return{isMatch:!1,score:1};var o,c,h,u,f,p,_,g,m,y=t.length,v=d,b=t.indexOf(e,s),j=l+y,k=1,w=[];for(-1!==b&&(v=Math.min(a(0,b),v),-1!==(b=t.lastIndexOf(e,s+l))&&(v=Math.min(a(0,b),v))),b=-1,o=0;o<l;o++){for(h=0,u=j;h<u;)a(o,s+u)<=v?h=u:j=u,u=Math.floor((j-h)/2+h);for(j=u,p=Math.max(1,s-u+1),_=Math.min(s+u,y)+l,(g=new Array(_+2))[_+1]=(1<<o)-1,c=_;p<=c;c--)if(m=n[t.charAt(c-1)],g[c]=0===o?(g[c+1]<<1|1)&m:(g[c+1]<<1|1)&m|(f[c+1]|f[c])<<1|1|f[c+1],g[c]&i&&(k=a(o,c-1))<=v){if(v=k,w.push(b=c-1),!(s<b))break;p=Math.max(1,2*s-b)}if(a(o+1,s)>v)break;f=g}return{isMatch:0<=b,score:k}},!0===t?{search:o}:o(t)},y.vakata.search.defaults={location:0,distance:100,threshold:.6,fuzzy:!1,caseSensitive:!1},e.jstree.defaults.sort=function(e,t){return this.get_text(e)>this.get_text(t)?1:-1};var b=!(e.jstree.plugins.sort=function(e,t){this.bind=function(){t.bind.call(this),this.element.on("model.jstree",function(e,t){this.sort(t.parent,!0)}.bind(this)).on("rename_node.jstree create_node.jstree",function(e,t){this.sort(t.parent||t.node.parent,!1),this.redraw_node(t.parent||t.node.parent,!0)}.bind(this)).on("move_node.jstree copy_node.jstree",function(e,t){this.sort(t.parent,!1),this.redraw_node(t.parent,!0)}.bind(this))},this.sort=function(e,t){var r,i;if((e=this.get_node(e))&&e.children&&e.children.length&&(e.children.sort(this.settings.sort.bind(this)),t))for(r=0,i=e.children_d.length;r<i;r++)this.sort(e.children_d[r],!1)}});e.jstree.defaults.state={key:"jstree",events:"changed.jstree open_node.jstree close_node.jstree check_node.jstree uncheck_node.jstree",ttl:!1,filter:!1,preserve_loaded:!1},e.jstree.plugins.state=function(t,r){this.bind=function(){r.bind.call(this);var e=function(){this.element.on(this.settings.state.events,function(){b&&clearTimeout(b),b=setTimeout(function(){this.save_state()}.bind(this),100)}.bind(this)),this.trigger("state_ready")}.bind(this);this.element.on("ready.jstree",function(t,r){this.element.one("restore_state.jstree",e),this.restore_state()||e()}.bind(this))},this.save_state=function(){var t=this.get_state();this.settings.state.preserve_loaded||delete t.core.loaded;var t={state:t,ttl:this.settings.state.ttl,sec:+new Date};e.vakata.storage.set(this.settings.state.key,JSON.stringify(t))},this.restore_state=function(){var t=e.vakata.storage.get(this.settings.state.key);if(t)try{t=JSON.parse(t)}catch(e){return!1}return!(t&&t.ttl&&t.sec&&+new Date-t.sec>t.ttl||!(t=(t=t&&t.state?t.state:t)&&e.vakata.is_function(this.settings.state.filter)?this.settings.state.filter.call(this,t):t)||(this.settings.state.preserve_loaded||delete t.core.loaded,this.element.one("set_state.jstree",function(r,i){i.instance.trigger("restore_state",{state:e.extend(!0,{},t)})}),this.set_state(t),0))},this.clear_state=function(){return e.vakata.storage.del(this.settings.state.key)}},e.vakata.storage={set:function(e,t){return window.localStorage.setItem(e,t)},get:function(e){return window.localStorage.getItem(e)},del:function(e){return window.localStorage.removeItem(e)}},e.jstree.defaults.types={default:{}},e.jstree.defaults.types[e.jstree.root]={},e.jstree.plugins.types=function(r,i){this.init=function(r,n){var a,o;if(n&&n.types&&n.types.default)for(a in n.types)if("default"!==a&&a!==e.jstree.root&&n.types.hasOwnProperty(a))for(o in n.types.default)n.types.default.hasOwnProperty(o)&&n.types[a][o]===t&&(n.types[a][o]=n.types.default[o]);i.init.call(this,r,n),this._model.data[e.jstree.root].type=e.jstree.root},this.refresh=function(t,r){i.refresh.call(this,t,r),this._model.data[e.jstree.root].type=e.jstree.root},this.bind=function(){this.element.on("model.jstree",function(r,i){for(var n,a,o,s=this._model.data,c=i.nodes,d=this.settings.types,l="default",n=0,a=c.length;n<a;n++){if(l="default",s[c[n]].original&&s[c[n]].original.type&&d[s[c[n]].original.type]&&(l=s[c[n]].original.type),s[c[n]].data&&s[c[n]].data.jstree&&s[c[n]].data.jstree.type&&d[s[c[n]].data.jstree.type]&&(l=s[c[n]].data.jstree.type),s[c[n]].type=l,!0===s[c[n]].icon&&d[l].icon!==t&&(s[c[n]].icon=d[l].icon),d[l].li_attr!==t&&"object"==typeof d[l].li_attr)for(o in d[l].li_attr)d[l].li_attr.hasOwnProperty(o)&&"id"!==o&&(s[c[n]].li_attr[o]===t?s[c[n]].li_attr[o]=d[l].li_attr[o]:"class"===o&&(s[c[n]].li_attr.class=d[l].li_attr.class+" "+s[c[n]].li_attr.class));if(d[l].a_attr!==t&&"object"==typeof d[l].a_attr)for(o in d[l].a_attr)d[l].a_attr.hasOwnProperty(o)&&"id"!==o&&(s[c[n]].a_attr[o]===t?s[c[n]].a_attr[o]=d[l].a_attr[o]:"href"===o&&"#"===s[c[n]].a_attr[o]?s[c[n]].a_attr.href=d[l].a_attr.href:"class"===o&&(s[c[n]].a_attr.class=d[l].a_attr.class+" "+s[c[n]].a_attr.class))}s[e.jstree.root].type=e.jstree.root}.bind(this)),i.bind.call(this)},this.get_json=function(t,r,n){var a,o,s=this._model.data,c=r?e.extend(!0,{},r,{no_id:!1}):{},d=i.get_json.call(this,t,c,n);if(!1===d)return!1;if(e.vakata.is_array(d))for(a=0,o=d.length;a<o;a++)d[a].type=(d[a].id||0===d[a].id)&&s[d[a].id]&&s[d[a].id].type?s[d[a].id].type:"default",r&&r.no_id&&(delete d[a].id,d[a].li_attr&&d[a].li_attr.id&&delete d[a].li_attr.id,d[a].a_attr&&d[a].a_attr.id&&delete d[a].a_attr.id);else d.type=(d.id||0===d.id)&&s[d.id]&&s[d.id].type?s[d.id].type:"default",r&&r.no_id&&(d=this._delete_ids(d));return d},this._delete_ids=function(t){if(e.vakata.is_array(t)){for(var r=0,i=t.length;r<i;r++)t[r]=this._delete_ids(t[r]);return t}return delete t.id,t.li_attr&&t.li_attr.id&&delete t.li_attr.id,t.a_attr&&t.a_attr.id&&delete t.a_attr.id,t.children&&e.vakata.is_array(t.children)&&(t.children=this._delete_ids(t.children)),t},this.check=function(r,n,a,o,s){if(!1===i.check.call(this,r,n,a,o,s))return!1;n=n&&(n.id||0===n.id)?n:this.get_node(n),a=a&&(a.id||0===a.id)?a:this.get_node(a);var c,d,l,h,u,c=(c=n&&(n.id||0===n.id)?s&&s.origin?s.origin:e.jstree.reference(n.id):null)&&c._model&&c._model.data?c._model.data:null;switch(r){case"create_node":case"move_node":case"copy_node":if("move_node"!==r||-1===e.inArray(n.id,a.children)){if((d=this.get_rules(a)).max_children!==t&&-1!==d.max_children&&d.max_children===a.children.length)return!(this._data.core.last_error={error:"check",plugin:"types",id:"types_01",reason:"max_children prevents function: "+r,data:JSON.stringify({chk:r,pos:o,obj:!(!n||!n.id&&0!==n.id)&&n.id,par:!(!a||!a.id&&0!==a.id)&&a.id})});if(d.valid_children!==t&&-1!==d.valid_children&&-1===e.inArray(n.type||"default",d.valid_children))return!(this._data.core.last_error={error:"check",plugin:"types",id:"types_02",reason:"valid_children prevents function: "+r,data:JSON.stringify({chk:r,pos:o,obj:!(!n||!n.id&&0!==n.id)&&n.id,par:!(!a||!a.id&&0!==a.id)&&a.id})});if(c&&n.children_d&&n.parents){for(h=l=0,u=n.children_d.length;h<u;h++)l=Math.max(l,c[n.children_d[h]].parents.length);l=l-n.parents.length+1}(l<=0||l===t)&&(l=1);do{if(d.max_depth!==t&&-1!==d.max_depth&&d.max_depth<l)return!(this._data.core.last_error={error:"check",plugin:"types",id:"types_03",reason:"max_depth prevents function: "+r,data:JSON.stringify({chk:r,pos:o,obj:!(!n||!n.id&&0!==n.id)&&n.id,par:!(!a||!a.id&&0!==a.id)&&a.id})});a=this.get_node(a.parent),d=this.get_rules(a),l++}while(a)}}return!0},this.get_rules=function(e){if(!(e=this.get_node(e)))return!1;var e=this.get_type(e,!0);return e.max_depth===t&&(e.max_depth=-1),e.max_children===t&&(e.max_children=-1),e.valid_children===t&&(e.valid_children=-1),e},this.get_type=function(t,r){return!!(t=this.get_node(t))&&(r?e.extend({type:t.type},this.settings.types[t.type]):t.type)},this.set_type=function(r,i){var n,a,o,s,c,d,l,h,u=this._model.data;if(e.vakata.is_array(r)){for(a=0,o=(r=r.slice()).length;a<o;a++)this.set_type(r[a],i);return!0}if(n=this.settings.types,r=this.get_node(r),!n[i]||!r)return!1;if((l=this.get_node(r,!0))&&l.length&&(h=l.children(".jstree-anchor")),s=r.type,c=this.get_icon(r),r.type=i,!0!==c&&n[s]&&(n[s].icon===t||c!==n[s].icon)||this.set_icon(r,n[i].icon===t||n[i].icon),n[s]&&n[s].li_attr!==t&&"object"==typeof n[s].li_attr)for(d in n[s].li_attr)n[s].li_attr.hasOwnProperty(d)&&"id"!==d&&("class"===d?(u[r.id].li_attr.class=(u[r.id].li_attr.class||"").replace(n[s].li_attr[d],""),l&&l.removeClass(n[s].li_attr[d])):u[r.id].li_attr[d]===n[s].li_attr[d]&&(u[r.id].li_attr[d]=null,l&&l.removeAttr(d)));if(n[s]&&n[s].a_attr!==t&&"object"==typeof n[s].a_attr)for(d in n[s].a_attr)n[s].a_attr.hasOwnProperty(d)&&"id"!==d&&("class"===d?(u[r.id].a_attr.class=(u[r.id].a_attr.class||"").replace(n[s].a_attr[d],""),h&&h.removeClass(n[s].a_attr[d])):u[r.id].a_attr[d]===n[s].a_attr[d]&&("href"===d?(u[r.id].a_attr[d]="#",h&&h.attr("href","#")):(delete u[r.id].a_attr[d],h&&h.removeAttr(d))));if(n[i].li_attr!==t&&"object"==typeof n[i].li_attr)for(d in n[i].li_attr)n[i].li_attr.hasOwnProperty(d)&&"id"!==d&&(u[r.id].li_attr[d]===t?(u[r.id].li_attr[d]=n[i].li_attr[d],l&&("class"===d?l.addClass(n[i].li_attr[d]):l.attr(d,n[i].li_attr[d]))):"class"===d&&(u[r.id].li_attr.class=n[i].li_attr[d]+" "+u[r.id].li_attr.class,l&&l.addClass(n[i].li_attr[d])));if(n[i].a_attr!==t&&"object"==typeof n[i].a_attr)for(d in n[i].a_attr)n[i].a_attr.hasOwnProperty(d)&&"id"!==d&&(u[r.id].a_attr[d]===t?(u[r.id].a_attr[d]=n[i].a_attr[d],h&&("class"===d?h.addClass(n[i].a_attr[d]):h.attr(d,n[i].a_attr[d]))):"href"===d&&"#"===u[r.id].a_attr[d]?(u[r.id].a_attr.href=n[i].a_attr.href,h&&h.attr("href",n[i].a_attr.href)):"class"===d&&(u[r.id].a_attr.class=n[i].a_attr.class+" "+u[r.id].a_attr.class,h&&h.addClass(n[i].a_attr[d])));return!0}},e.jstree.defaults.unique={case_sensitive:!1,trim_whitespace:!1,duplicate:function(e,t){return e+" ("+t+")"}},e.jstree.plugins.unique=function(r,i){this.check=function(t,r,n,a,o){if(!1===i.check.call(this,t,r,n,a,o))return!1;if(r=r&&(r.id||0===r.id)?r:this.get_node(r),!(n=n&&(n.id||0===n.id)?n:this.get_node(n))||!n.children)return!0;for(var s,c,d,l="rename_node"===t?a:r.text,h=[],u=this.settings.unique.case_sensitive,f=this.settings.unique.trim_whitespace,p=this._model.data,s=0,c=n.children.length;s<c;s++)d=p[n.children[s]].text,u||(d=d.toLowerCase()),f&&(d=d.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")),h.push(d);switch(u||(l=l.toLowerCase()),f&&(l=l.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")),t){case"delete_node":return!0;case"rename_node":return d=r.text||"",u||(d=d.toLowerCase()),f&&(d=d.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")),(s=-1===e.inArray(l,h)||r.text&&d===l)||(this._data.core.last_error={error:"check",plugin:"unique",id:"unique_01",reason:"Child with name "+l+" already exists. Preventing: "+t,data:JSON.stringify({chk:t,pos:a,obj:!(!r||!r.id&&0!==r.id)&&r.id,par:!(!n||!n.id&&0!==n.id)&&n.id})}),s;case"create_node":return(s=-1===e.inArray(l,h))||(this._data.core.last_error={error:"check",plugin:"unique",id:"unique_04",reason:"Child with name "+l+" already exists. Preventing: "+t,data:JSON.stringify({chk:t,pos:a,obj:!(!r||!r.id&&0!==r.id)&&r.id,par:!(!n||!n.id&&0!==n.id)&&n.id})}),s;case"copy_node":return(s=-1===e.inArray(l,h))||(this._data.core.last_error={error:"check",plugin:"unique",id:"unique_02",reason:"Child with name "+l+" already exists. Preventing: "+t,data:JSON.stringify({chk:t,pos:a,obj:!(!r||!r.id&&0!==r.id)&&r.id,par:!(!n||!n.id&&0!==n.id)&&n.id})}),s;case"move_node":return(s=r.parent===n.id&&(!o||!o.is_multi)||-1===e.inArray(l,h))||(this._data.core.last_error={error:"check",plugin:"unique",id:"unique_03",reason:"Child with name "+l+" already exists. Preventing: "+t,data:JSON.stringify({chk:t,pos:a,obj:!(!r||!r.id&&0!==r.id)&&r.id,par:!(!n||!n.id&&0!==n.id)&&n.id})}),s}return!0},this.create_node=function(r,n,a,o,s){if(!n||"object"==typeof n&&n.text===t){if(null===r&&(r=e.jstree.root),!(r=this.get_node(r)))return i.create_node.call(this,r,n,a,o,s);if(!(a=a===t?"last":a).toString().match(/^(before|after)$/)&&!s&&!this.is_loaded(r))return i.create_node.call(this,r,n,a,o,s);n=n||{};for(var c,d,l,h,u,f,p=this._model.data,_=this.settings.unique.case_sensitive,g=this.settings.unique.trim_whitespace,m=this.settings.unique.duplicate,d=c=this.get_string("New node"),l=[],h=0,u=r.children.length;h<u;h++)f=p[r.children[h]].text,_||(f=f.toLowerCase()),g&&(f=f.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")),l.push(f);for(h=1,f=d,_||(f=f.toLowerCase()),g&&(f=f.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""));-1!==e.inArray(f,l);)f=d=m.call(this,c,++h).toString(),_||(f=f.toLowerCase()),g&&(f=f.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""));n.text=d}return i.create_node.call(this,r,n,a,o,s)}};var j=c.createElement("DIV");if(j.setAttribute("unselectable","on"),j.setAttribute("role","presentation"),j.className="jstree-wholerow",j.innerHTML="&#160;",e.jstree.plugins.wholerow=function(t,r){this.bind=function(){r.bind.call(this),this.element.on("ready.jstree set_state.jstree",function(){this.hide_dots()}.bind(this)).on("init.jstree loading.jstree ready.jstree",function(){this.get_container_ul().addClass("jstree-wholerow-ul")}.bind(this)).on("deselect_all.jstree",function(e,t){this.element.find(".jstree-wholerow-clicked").removeClass("jstree-wholerow-clicked")}.bind(this)).on("changed.jstree",function(e,t){this.element.find(".jstree-wholerow-clicked").removeClass("jstree-wholerow-clicked");for(var r,i,n=!1,r=0,i=t.selected.length;r<i;r++)(n=this.get_node(t.selected[r],!0))&&n.length&&n.children(".jstree-wholerow").addClass("jstree-wholerow-clicked")}.bind(this)).on("open_node.jstree",function(e,t){this.get_node(t.node,!0).find(".jstree-clicked").parent().children(".jstree-wholerow").addClass("jstree-wholerow-clicked")}.bind(this)).on("hover_node.jstree dehover_node.jstree",function(e,t){"hover_node"===e.type&&this.is_disabled(t.node)||this.get_node(t.node,!0).children(".jstree-wholerow")["hover_node"===e.type?"addClass":"removeClass"]("jstree-wholerow-hovered")}.bind(this)).on("contextmenu.jstree",".jstree-wholerow",function(t){var r;this._data.contextmenu&&(t.preventDefault(),r=e.Event("contextmenu",{metaKey:t.metaKey,ctrlKey:t.ctrlKey,altKey:t.altKey,shiftKey:t.shiftKey,pageX:t.pageX,pageY:t.pageY}),e(t.currentTarget).closest(".jstree-node").children(".jstree-anchor").first().trigger(r))}.bind(this)).on("click.jstree",".jstree-wholerow",function(t){t.stopImmediatePropagation();var r=e.Event("click",{metaKey:t.metaKey,ctrlKey:t.ctrlKey,altKey:t.altKey,shiftKey:t.shiftKey});e(t.currentTarget).closest(".jstree-node").children(".jstree-anchor").first().trigger(r).trigger("focus")}).on("dblclick.jstree",".jstree-wholerow",function(t){t.stopImmediatePropagation();var r=e.Event("dblclick",{metaKey:t.metaKey,ctrlKey:t.ctrlKey,altKey:t.altKey,shiftKey:t.shiftKey});e(t.currentTarget).closest(".jstree-node").children(".jstree-anchor").first().trigger(r).trigger("focus")}).on("click.jstree",".jstree-leaf > .jstree-ocl",function(t){t.stopImmediatePropagation();var r=e.Event("click",{metaKey:t.metaKey,ctrlKey:t.ctrlKey,altKey:t.altKey,shiftKey:t.shiftKey});e(t.currentTarget).closest(".jstree-node").children(".jstree-anchor").first().trigger(r).trigger("focus")}.bind(this)).on("mouseover.jstree",".jstree-wholerow, .jstree-icon",function(e){return e.stopImmediatePropagation(),this.is_disabled(e.currentTarget)||this.hover_node(e.currentTarget),!1}.bind(this)).on("mouseleave.jstree",".jstree-node",function(e){this.dehover_node(e.currentTarget)}.bind(this))},this.teardown=function(){this.settings.wholerow&&this.element.find(".jstree-wholerow").remove(),r.teardown.call(this)},this.redraw_node=function(t,i,n,a){var o;return(t=r.redraw_node.apply(this,arguments))&&(o=j.cloneNode(!0),-1!==e.inArray(t.id,this._data.core.selected)&&(o.className+=" jstree-wholerow-clicked"),this._data.core.focused&&this._data.core.focused===t.id&&(o.className+=" jstree-wholerow-hovered"),t.insertBefore(o,t.childNodes[0])),t}},window.customElements&&Object&&Object.create){var s=Object.create(HTMLElement.prototype);s.createdCallback=function(){var t,r={core:{},plugins:[]};for(t in e.jstree.plugins)e.jstree.plugins.hasOwnProperty(t)&&this.attributes[t]&&(r.plugins.push(t),this.getAttribute(t)&&JSON.parse(this.getAttribute(t))&&(r[t]=JSON.parse(this.getAttribute(t))));for(t in e.jstree.defaults.core)e.jstree.defaults.core.hasOwnProperty(t)&&this.attributes[t]&&(r.core[t]=JSON.parse(this.getAttribute(t))||this.getAttribute(t));e(this).jstree(r)};try{window.customElements.define("vakata-jstree",function(){},{prototype:s})}catch(s){}}}})}});